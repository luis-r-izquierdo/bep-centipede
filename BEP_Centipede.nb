(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    645914,      14750]
NotebookOptionsPosition[    630272,      14253]
NotebookOutlinePosition[    630906,      14276]
CellTagsIndexPosition[    630863,      14273]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Best-experienced-payoff Dynamics in the Centipede Game", "Title",
 CellChangeTimes->{{3.692963139229731*^9, 3.6929631740013227`*^9}, {
  3.692963833305882*^9, 3.692963836048258*^9}, {3.6979868877815323`*^9, 
  3.6979869267590513`*^9}, {3.698580036078623*^9, 3.698580036494309*^9}, {
  3.698580547734456*^9, 3.6985805481629333`*^9}, {3.698766549404735*^9, 
  3.698766551866534*^9}, {3.7011634672367773`*^9, 
  3.701163468010643*^9}},ExpressionUUID->"91a618f7-3b5e-4fb9-bf02-\
ee524a0acef3"],

Cell[TextData[{
 ButtonBox["William H. Sandholm",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.ssc.wisc.edu/~whs/"], None},
  ButtonNote->"http://www.ssc.wisc.edu/~whs/"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 ", and ",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"]
}], "Subtitle",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.69925272778644*^9, 
  3.699252734009767*^9}, {3.701093095869926*^9, 
  3.7010931406475477`*^9}},ExpressionUUID->"30a09403-1cf9-4753-9de6-\
82c3a66e18b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["License", "Section",
 CellChangeTimes->{{3.692974713726569*^9, 3.692974745779025*^9}, {
  3.692975725474792*^9, 3.6929757289605*^9}, {3.693048053256386*^9, 
  3.6930480564046507`*^9}, {3.6931347632003527`*^9, 3.693134766629697*^9}, {
  3.699250799957007*^9, 3.6992508018682957`*^9}, {3.700304390290905*^9, 
  3.700304394564872*^9}, {3.701092450226886*^9, 
  3.701092465366456*^9}},ExpressionUUID->"4009a82b-8634-48ab-b894-\
d305596c1f3a"],

Cell[TextData[{
 "BEP_Centipede is a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " notebook created to compute several solutions and theorems explained in \
the paper \n\[OpenCurlyDoubleQuote]Best Experienced Payoff Dynamics and \
Cooperation in the Centipede Game\[CloseCurlyDoubleQuote].\nCopyright (C) \
2017. ",
 ButtonBox["William H. Sandholm",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.ssc.wisc.edu/~whs/"], None},
  ButtonNote->"http://www.ssc.wisc.edu/~whs/"],
 ", ",
 ButtonBox["Segismundo S. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://www.segis.izqui.org"], None},
  ButtonNote->"http://www.segis.izqui.org"],
 ", and ",
 ButtonBox["Luis R. Izquierdo",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 "\n\nThis program is free software: you can redistribute it and/or modify\n\
it under the terms of the GNU General Public License as published by\nthe \
Free Software Foundation, either version 3 of the License, or\n(at your \
option) any later version.\n\nThis program is distributed in the hope that it \
will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty \
of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \[LineSeparator]See \
the GNU General Public License for more details.\n\nYou can find a copy of \
the GNU General Public License at ",
 ButtonBox["https://www.gnu.org/licenses/gpl.html",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://www.gnu.org/licenses/gpl.html"], None},
  ButtonNote->"https://www.gnu.org/licenses/gpl.html"],
 ".\n\nFinancial support from NSF Grant SES-1458992 is gratefully \
acknowledged.\n\nContact information: \nLuis R. Izquierdo \nUniversity of \
Burgos, Spain. \nwebsite: ",
 ButtonBox["http://luis.izqui.org",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://luis.izqui.org"], None},
  ButtonNote->"http://luis.izqui.org"],
 "\n"
}], "Text",
 CellChangeTimes->{
  3.7010924882946177`*^9, 3.701092648904615*^9, {3.701092683502741*^9, 
   3.701092911985737*^9}, {3.7010929559854403`*^9, 3.701092956943893*^9}, {
   3.701092992976839*^9, 3.7010930168517303`*^9}, {3.7010930523874273`*^9, 
   3.701093062710374*^9}, {3.7010931502363234`*^9, 3.701093216924671*^9}, {
   3.7015003221964827`*^9, 3.7015003316681223`*^9}, 3.701500576415395*^9, {
   3.7016867230238113`*^9, 3.701686723494185*^9}},
 ExpressionUUID -> "8359490b-f256-47f9-935c-eabc8ae0a58a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Source code", "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963104322612*^9, 3.6929631227469807`*^9}, 
   3.6929631827426558`*^9, 3.69296347114834*^9, {3.693031989625875*^9, 
   3.693031991231361*^9}},ExpressionUUID->"3a0f0b5f-5d2b-48b3-a735-\
41fc074714f2"],

Cell[CellGroupData[{

Cell["General options", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929637613180933`*^9, 
  3.692963781949512*^9}},ExpressionUUID->"2dcb9602-f293-4fbd-8927-\
29165a5c5729"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Symbols", " ", "x"}], ",", " ", "y", ",", " ", 
     RowBox[{
     "z", " ", "and", " ", "t", " ", "must", " ", "not", " ", "be", " ", 
      "used", " ", "in", " ", "this", " ", "notebook"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"Root", ",", 
      RowBox[{"ExactRootIsolation", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"precision", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "is", " ", "only", " ", "for", " ", "displaying", " ", 
     "purposes"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "The", " ", "following", " ", "line", " ", "makes", " ", "sure", " ", 
      "that", " ", "usage", " ", "messages", " ", "are", " ", "correctly", 
      " ", "displayed", " ", 
      RowBox[{"always", ".", " ", "For"}], " ", "details"}], ",", " ", 
     RowBox[{
      RowBox[{"see", ":", "\[IndentingNewLine]", "http", ":"}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
          "questions"}], "/", "3943"}], "/", "usage"}], "-", "displays", "-", 
       "properly", "-", "only", "-", "after", "-", "second", "-", 
       RowBox[{
        RowBox[{"call", "/", "27671"}], "#27671"}]}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"System`Dump`fixmessagestring", "[", "System`Dump`s_", "]"}], ":=", 
    RowBox[{"ToString", "@", 
     RowBox[{"InputForm", "@", "System`Dump`s"}]}]}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.692963095601802*^9}, 3.692963471148655*^9, {3.692965028060574*^9, 
   3.692965029507132*^9}, {3.692966522983467*^9, 3.6929666165570383`*^9}, {
   3.692966724564423*^9, 3.692966765740283*^9}, {3.693030030531804*^9, 
   3.6930300315556517`*^9}, {3.693030092575877*^9, 3.69303010318467*^9}, {
   3.693030148307716*^9, 3.69303019914688*^9}, {3.693030620688936*^9, 
   3.693030622881857*^9}, {3.693031015984412*^9, 3.6930310349845963`*^9}, {
   3.693031133311364*^9, 3.693031272406781*^9}, 3.6930319805566177`*^9, {
   3.69303305306196*^9, 3.693033057673807*^9}, {3.693035868154105*^9, 
   3.693035871572858*^9}, {3.693078145413859*^9, 3.6930781675558777`*^9}, {
   3.69354989608856*^9, 3.693549898484931*^9}, {3.696828549403839*^9, 
   3.696828556367633*^9}, {3.697984741789968*^9, 3.697984745592551*^9}, 
   3.697985793453219*^9, {3.6979858533964376`*^9, 3.6979858601539717`*^9}, {
   3.698577762263653*^9, 3.698577762685961*^9}, {3.6992531164166594`*^9, 
   3.6992531435500193`*^9}, 3.699253362677492*^9, {3.699253424213265*^9, 
   3.69925345918749*^9}, {3.6992535012179537`*^9, 3.6992535156055803`*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "7298d53a-acd3-4dfa-9dfd-b145f7b3c07b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Supporting functions", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.701162173421438*^9, 
  3.701162176527233*^9}},ExpressionUUID->"2dcb9602-f293-4fbd-8927-\
29165a5c5729"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "following", " ", "function"}], ",", " ", 
    RowBox[{"i", ".", "e", ".", " ", "ClipTo01"}], ",", " ", 
    RowBox[{
    "is", " ", "implemented", " ", "for", " ", "efficiency", " ", "reasons"}],
     ",", " ", 
    RowBox[{
    "so", " ", "it", " ", "can", " ", "be", " ", "used", " ", "in", " ", 
     "functions", " ", "that", " ", "will", " ", "be", " ", 
     RowBox[{"compiled", ".", " ", "Otherwise"}]}], ",", " ", 
    RowBox[{"we", " ", "could", " ", "have", " ", "used", " ", 
     RowBox[{"Clip", "[", 
      RowBox[{",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ClipTo01", "[", "v_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", "<", "0"}], ",", "0", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"v", ">", "1"}], ",", "1", ",", "v"}], "]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"ClipTo01", ",", "Listable"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ProjectOnSimplex", "[", "v_", "]"}], ":=", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"ClipTo01", "[", "v", "]"}], ",", "Total"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Outcomes", "[", "fPointRules_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "fPointRules", "]"}], "+", "1"}], ")"}], 
            "/", "2"}], "]"}]}], ",", 
         RowBox[{"s2", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"Length", "[", "fPointRules", "]"}], "/", "2"}], "]"}]}], 
         ",", "fPoint", ",", "interweavedFPoint", ",", "vars"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vars", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fPoint", "=", 
         RowBox[{"vars", "/.", "fPointRules"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"interweavedFPoint", "=", 
         RowBox[{"Riffle", "[", 
          RowBox[{
           RowBox[{"fPoint", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "s1"}], "]"}], "]"}], ",", 
           RowBox[{"fPoint", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Most", "@", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#1", "*", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"interweavedFPoint", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{
                   RowBox[{"First", "[", "#2", "]"}], "+", "1"}], ",", 
                  RowBox[{"Length", "[", "interweavedFPoint", "]"}], ",", 
                  "2"}], "}"}]}], "]"}]}], ")"}], "&"}], ",", 
           "interweavedFPoint"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PlotOutcomes", "[", 
      RowBox[{"fPointRules_", ",", 
       RowBox[{"sizeOfBubbles_:", "0.1"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"outcomes", "=", 
          RowBox[{"Outcomes", "[", "fPointRules", "]"}]}], ",", "d"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "outcomes", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BubbleChart", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"10", "^", 
            RowBox[{"-", "16"}]}], "+", 
           RowBox[{"Chop", "@", 
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"First", "[", "#2", "]"}], ",", "1", ",", "#1"}], 
                "}"}], "&"}], ",", "outcomes"}], "]"}]}]}], ",", 
          RowBox[{"ChartLabels", "\[Rule]", 
           RowBox[{"Range", "[", "d", "]"}]}], ",", 
          RowBox[{"BubbleSizes", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0.001", ",", "sizeOfBubbles"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"d", "+", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "-", 
                RowBox[{"d", "*", "0.01"}]}], ",", 
               RowBox[{"1", "+", 
                RowBox[{"d", "*", "0.01"}]}]}], "}"}]}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "1000"}], ",", 
          RowBox[{"Frame", "\[Rule]", "False"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", 
           RowBox[{"1", "/", "d"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.692963095601802*^9}, 3.692963471148655*^9, {3.692965028060574*^9, 
   3.692965029507132*^9}, {3.692966522983467*^9, 3.6929666165570383`*^9}, {
   3.692966724564423*^9, 3.692966765740283*^9}, {3.693030030531804*^9, 
   3.6930300315556517`*^9}, {3.693030092575877*^9, 3.69303010318467*^9}, {
   3.693030148307716*^9, 3.69303019914688*^9}, {3.693030620688936*^9, 
   3.693030622881857*^9}, {3.693031015984412*^9, 3.6930310349845963`*^9}, {
   3.693031133311364*^9, 3.693031272406781*^9}, 3.6930319805566177`*^9, {
   3.69303305306196*^9, 3.693033057673807*^9}, {3.693035868154105*^9, 
   3.693035871572858*^9}, {3.693078145413859*^9, 3.6930781675558777`*^9}, {
   3.69354989608856*^9, 3.693549898484931*^9}, {3.696828549403839*^9, 
   3.696828556367633*^9}, {3.697984741789968*^9, 3.697984745592551*^9}, 
   3.697985793453219*^9, {3.6979858533964376`*^9, 3.6979858601539717`*^9}, {
   3.698577762263653*^9, 3.698577762685961*^9}, {3.6992531164166594`*^9, 
   3.6992531435500193`*^9}, 3.699253362677492*^9, {3.699253424213265*^9, 
   3.69925345918749*^9}, {3.6992535012179537`*^9, 3.6992535156055803`*^9}, {
   3.7011621796329412`*^9, 3.701162268811829*^9}, {3.701162399489732*^9, 
   3.7011624027401657`*^9}, {3.7028984907791157`*^9, 
   3.7028984950521107`*^9}, {3.7028985461983*^9, 3.702898578270133*^9}, {
   3.7029014377895327`*^9, 3.702901438172534*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "7298d53a-acd3-4dfa-9dfd-b145f7b3c07b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mean dynamics", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963227845255*^9, 3.69296325552354*^9}, 
   3.692963296342883*^9, 3.6929634614063253`*^9, 3.692963707587676*^9, 
   3.6968286681280327`*^9, {3.696943804057803*^9, 3.696943805652946*^9}, 
   3.701500653368442*^9},ExpressionUUID->"8580c788-4465-4f77-ae5e-\
d51feadf8abb"],

Cell[CellGroupData[{

Cell["General functions", "Subsubsection",
 CellChangeTimes->{{3.692965354024008*^9, 3.692965381764658*^9}, {
   3.6930320109304237`*^9, 3.693032015002742*^9}, 
   3.6967507905891447`*^9},ExpressionUUID->"1b196b6f-fbd4-4e81-82cd-\
63c76644ee97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamics", "::", "invalidValueOf_testSetRule"}], "=", 
    "\"\<the variable testSetRule in MeanDynamics[\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\), tieBreakingRule, d] cannot take the \
value `1`. It can only be \\\"all\\\", \\\"two\\\" or \\\"adj\\\"\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamics", "::", "invalidValueOf_tieBreakingRule"}], "=", 
    "\"\<the variable tieBreakingRule in MeanDynamics[testSetRule, \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\), d] cannot take the value `1`. It \
can only be \\\"min\\\", \\\"stick\\\" or \\\"unif\\\"\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamics", "::", "invalidValueOf_d"}], "=", 
    "\"\<the variable d (number of nodes in the game) in \
MeanDynamics[testSetRule, tieBreakingRule, \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)] cannot take the value `1`. It must \
be an integer strictly greater than 1\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamics", "::", "usage"}], "=", "\"\<MeanDynamics[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\):False, \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\):False, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):5 ] returns the mean dynamics of the BEP dynamics \
for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1).\n\n\
\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is an optional (boolean) parameter. If \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is set to True, then the equations are simplified.\n\
- \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\) is an optional (boolean) parameter. If \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\) is set to True, then the following two identities \n\
\\t x[s1] == 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 1\), \(s1 - \
1\)]\)x[i] \n\\t y[s2] == 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 1\), \
\(s2 - 1\)]\)y[i]\n     are used to eliminate the last variables (i.e. x[s1] \
and y[s2]) in the mean dynamics equations. (s1 and s2 are the number of \
strategies for the first movers and the second movers respectively.)\n- \
\!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamics", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"useFullSimplify_:", "False"}], ",", 
      RowBox[{"omitLastVariable_:", "False"}], ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"MD", ",", "s1", ",", "s2", ",", "Dvars"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
          RowBox[{"n", "<", "2"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"MeanDynamics", "::", "invalidValueOf_d"}], ",", "n"}], 
            "]"}], ";", 
           "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 2)\>\"", ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MD", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "testSetRule", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<all\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"MeanDynamicsAllMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"MeanDynamicsAllStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"MeanDynamicsAllUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "MeanDynamics", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<two\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"MeanDynamicsTwoMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"MeanDynamicsTwoStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"MeanDynamicsTwoUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "MeanDynamics", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<adj\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"MeanDynamicsAdjacentMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"MeanDynamicsAdjacentStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"MeanDynamicsAdjacentUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "MeanDynamics", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"MeanDynamics", "::", "invalidValueOf_testSetRule"}], 
              ",", "testSetRule"}], "]"}], ";", 
            "\"\<Error parameterizing the test-set rule\>\"", ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Dvars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"omitLastVariable", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MD", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Drop", "[", 
             RowBox[{"MD", ",", 
              RowBox[{"{", "s1", "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Dvars", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Drop", "[", 
             RowBox[{"Dvars", ",", 
              RowBox[{"{", "s1", "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"MD", "=", 
           RowBox[{"MD", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "s1", "]"}], "\[Rule]", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"x", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"y", "[", "s2", "]"}], "\[Rule]", 
               RowBox[{"1", " ", "-", " ", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{"y", "[", "i", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"s2", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
             "}"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"useFullSimplify", ",", 
         RowBox[{"MD", " ", "=", " ", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"MD", ",", 
            RowBox[{"If", "[", 
             RowBox[{"omitLastVariable", ",", 
              RowBox[{
               RowBox[{"##", "&"}], "[", "]"}], ",", 
              RowBox[{"Assumptions", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"y", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}]}], "}"}]}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"verbosity", "\[GreaterEqual]", "1"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"StringQ", "[", "MD", "]"}], "]"}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Mean dynamics:\\n\>\"", ",", 
           RowBox[{"MatrixForm", "[", "Dvars", "]"}], ",", "\"\<==\>\"", ",", 
           
           RowBox[{"MatrixForm", "[", "MD", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "MD"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsWithoutFirstVariables", "::", "usage"}], "=", 
    "\"\<MeanDynamicsWithoutFirstVariables[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\):False, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the mean dynamics of the BEP dynamics \
for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1), and \
eliminating the first variables using the following two identities:\n\\t x[1] \
== 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 2\), \(s1\)]\)x[i] \n\\t \
y[1] == 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 2\), \(s2\)]\)y[i]\n\
where s1 and s2 are the number of strategies for the first movers and the \
second movers respectively.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is an optional (boolean) parameter. If \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is set to True, then the equations are simplified.\n\
- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsWithoutFirstVariables", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"useFullSimplify_:", "False"}], ",", 
     RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "reducedEM"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reducedEM", "=", 
       RowBox[{"MeanDynamics", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "False", ",", 
         "False", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reducedEM", "=", 
       RowBox[{"Rest", "[", 
        RowBox[{"Drop", "[", 
         RowBox[{"reducedEM", ",", 
          RowBox[{"{", 
           RowBox[{"s1", "+", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"reducedEM", "=", 
       RowBox[{"reducedEM", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "\[Rule]", 
           RowBox[{"1", " ", "-", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"x", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "\[Rule]", 
           RowBox[{"1", " ", "-", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"y", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}]}]}], 
         "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"useFullSimplify", ",", 
        RowBox[{"reducedEM", "=", 
         RowBox[{"FullSimplify", "[", "reducedEM", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "1"}], "&&", 
         RowBox[{"Not", "[", 
          RowBox[{"StringQ", "[", "reducedEM", "]"}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Mean dynamics:\\n\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "'"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "'"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], "]"}], 
           "]"}], ",", "\"\<==\>\"", ",", 
          RowBox[{"MatrixForm", "[", "reducedEM", "]"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "reducedEM"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692965446235427*^9, 3.6929654697463293`*^9}, {
   3.6929657073233213`*^9, 3.692965744640543*^9}, {3.692965816730579*^9, 
   3.692965819847828*^9}, {3.692965859703281*^9, 3.6929659019656057`*^9}, {
   3.692966131948928*^9, 3.692966227208665*^9}, {3.692966260010957*^9, 
   3.6929662891655703`*^9}, {3.692966648235888*^9, 3.692966710166909*^9}, {
   3.692966784231855*^9, 3.692966823821845*^9}, {3.692966858602195*^9, 
   3.692966917506918*^9}, {3.692966953934803*^9, 3.692966975881844*^9}, 
   3.692967072814118*^9, 3.692967123450399*^9, {3.692967739845028*^9, 
   3.6929677537398653`*^9}, {3.692971310715054*^9, 3.692971318625497*^9}, {
   3.692971786307362*^9, 3.692971812328455*^9}, {3.692972457878489*^9, 
   3.692972466361067*^9}, {3.692972499167418*^9, 3.6929725194390182`*^9}, {
   3.692973314001739*^9, 3.692973335251636*^9}, {3.692973419426969*^9, 
   3.692973467238038*^9}, {3.692973930518475*^9, 3.692973962411765*^9}, 
   3.692974006322344*^9, {3.692974134721342*^9, 3.692974160336493*^9}, {
   3.6929743392580013`*^9, 3.692974339876562*^9}, {3.692974429104535*^9, 
   3.692974526740728*^9}, {3.692974578154134*^9, 3.692974582046*^9}, {
   3.692975543684683*^9, 3.692975591374995*^9}, {3.693029679654345*^9, 
   3.693029704649976*^9}, {3.693030041865196*^9, 3.693030045811145*^9}, {
   3.693030211694378*^9, 3.6930302207164392`*^9}, {3.6930303435772667`*^9, 
   3.693030374559471*^9}, {3.693031287888219*^9, 3.693031453287703*^9}, {
   3.693031497073848*^9, 3.6930315500730886`*^9}, {3.693032077736012*^9, 
   3.693032106873304*^9}, {3.693032138453549*^9, 3.6930321749361277`*^9}, {
   3.693032306349473*^9, 3.69303233673464*^9}, {3.693032388836957*^9, 
   3.693032521866275*^9}, {3.6967348264651318`*^9, 3.6967348391953516`*^9}, {
   3.696735057378541*^9, 3.6967350924218655`*^9}, {3.696747113886941*^9, 
   3.6967471418470206`*^9}, {3.696747422603009*^9, 3.696747442203549*^9}, {
   3.696750771100972*^9, 3.696750782600333*^9}, {3.696828557718481*^9, 
   3.696828577270421*^9}, 3.696828756959105*^9, {3.697565404629841*^9, 
   3.697565528164906*^9}, {3.6975667516988583`*^9, 3.6975667649226313`*^9}, {
   3.697566855301676*^9, 3.697566870364553*^9}, {3.697986552382472*^9, 
   3.697986558165848*^9}, {3.6979866003513412`*^9, 3.6979867306443653`*^9}, {
   3.697986765143309*^9, 3.6979867847220163`*^9}, {3.697986995986554*^9, 
   3.697987009317445*^9}, {3.698570631850876*^9, 3.698570637669168*^9}, {
   3.698570679949141*^9, 3.6985707581429996`*^9}, {3.698571456458272*^9, 
   3.6985714733083477`*^9}, {3.6985773059762983`*^9, 3.69857732785351*^9}, {
   3.698577392365171*^9, 3.69857746214499*^9}, {3.6985779773709183`*^9, 
   3.698578123077447*^9}, {3.698578162582478*^9, 3.698578214824421*^9}, {
   3.698578256156414*^9, 3.698578313794141*^9}, {3.6985783602131157`*^9, 
   3.6985783762159986`*^9}, {3.698578409759272*^9, 3.698578429549423*^9}, {
   3.6985784819299*^9, 3.698578483718857*^9}, {3.698578531869583*^9, 
   3.698578534802432*^9}, {3.6985785690579243`*^9, 3.6985787274171762`*^9}, {
   3.698578778004307*^9, 3.6985789231230087`*^9}, {3.698578953179202*^9, 
   3.698578998970166*^9}, {3.6985790769035807`*^9, 3.6985791551801653`*^9}, {
   3.698579386089128*^9, 3.698579417239129*^9}, {3.698579451551708*^9, 
   3.6985794532754183`*^9}, {3.698579594617857*^9, 3.6985796386226263`*^9}, {
   3.698579675950666*^9, 3.698579676798517*^9}, {3.698579714188115*^9, 
   3.69857978716721*^9}, {3.6985798469041243`*^9, 3.698579895720704*^9}, {
   3.6987336629821777`*^9, 3.698733705043954*^9}, {3.698733943695116*^9, 
   3.6987340109713306`*^9}, {3.698734097632111*^9, 3.698734098126048*^9}, {
   3.6987341539621353`*^9, 3.698734286217864*^9}, {3.698734777799054*^9, 
   3.69873479316713*^9}, {3.69873689798582*^9, 3.698736916116544*^9}, {
   3.698738427840219*^9, 3.69873845689289*^9}, {3.698739077618505*^9, 
   3.698739109534992*^9}, {3.6987397780134497`*^9, 3.698739801107712*^9}, {
   3.698740023778726*^9, 3.698740040590448*^9}, {3.698740845484922*^9, 
   3.698740846220524*^9}, 3.699250824460868*^9, {3.6992533684275913`*^9, 
   3.6992534104097347`*^9}, 3.7002926503978233`*^9, {3.701500410996274*^9, 
   3.701500425564539*^9}, {3.7015008819266243`*^9, 3.7015009040076103`*^9}, {
   3.7015009516317663`*^9, 3.70150095658083*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "4d4eb097-fedb-479c-8152-96e322899a23"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test all ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}},ExpressionUUID->"d6f123b3-168d-4f2c-a6b6-\
5970bccd0a6a"],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692972843352756*^9, 
   3.692972845004739*^9}},ExpressionUUID->"0eedcf7c-8915-4ad9-858c-\
22c175cf5299"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllMin", "[", 
     RowBox[{"n_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "k", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"m", "=", "1"}], "i"], 
             RowBox[{"y", "[", "m", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "2"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"y", "[", "k", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"l", "=", "1"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{"y", "[", "l", "]"}]}], ")"}], 
            RowBox[{"i", "-", "k"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"m", "=", "1"}], "k"], 
              RowBox[{"y", "[", "m", "]"}]}], ")"}], 
            RowBox[{"s1", "-", "i"}]]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllMin", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"k", "=", "2"}], "s1"], 
             RowBox[{"x", "[", "k", "]"}]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "+", 
              RowBox[{"x", "[", "2", "]"}]}], ")"}], 
            RowBox[{"s2", "-", "1"}]]}], "+", 
          SuperscriptBox[
           RowBox[{"x", "[", "1", "]"}], "s2"]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", 
                RowBox[{"j", "+", "1"}]}], "s1"], 
              RowBox[{"x", "[", "k", "]"}]}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"m", "=", "1"}], 
                RowBox[{"j", "+", "1"}]], 
               RowBox[{"x", "[", "m", "]"}]}], ")"}], 
             RowBox[{"s2", "-", "j"}]]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], "j"], 
            RowBox[{
             RowBox[{"x", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"x", "[", "l", "]"}]}], ")"}], 
              RowBox[{"j", "-", "k", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"x", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s2", "-", "j"}]]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAllMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllMin", "[", 
         RowBox[{"n", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllMin", "[", 
         RowBox[{"n", ",", "x"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, {
   3.692964629408436*^9, 3.69296463194263*^9}, 3.692964675053371*^9, {
   3.692964845947241*^9, 3.6929648533747807`*^9}, {3.692964940240322*^9, 
   3.692964940646299*^9}, {3.692964984011602*^9, 3.692964991546287*^9}, {
   3.692965561836548*^9, 3.692965562275013*^9}, {3.692965665231518*^9, 
   3.692965669581805*^9}, 3.692965701466701*^9, {3.692971184864274*^9, 
   3.692971262576693*^9}, {3.692971335290848*^9, 3.69297134302752*^9}, {
   3.692971558602255*^9, 3.692971567803259*^9}, {3.692971837110524*^9, 
   3.6929718392129307`*^9}, 3.69297254650884*^9, {3.694021794782971*^9, 
   3.694021824245927*^9}, 3.694021878595821*^9, {3.6967346089235735`*^9, 
   3.6967346155224314`*^9}, {3.6967370382288437`*^9, 
   3.6967370492592506`*^9}, {3.6967387544704456`*^9, 3.6967387593027916`*^9}, 
   3.696828580465274*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "69ee0df9-4669-4fb5-a75a-bb8452871696"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963935759516*^9}, 
   3.696726640514408*^9, 
   3.6967346610715017`*^9},ExpressionUUID->"e7bc30fd-a215-4ff2-a009-\
13c7bda62096"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllStick", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "k", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"m", "=", "1"}], "i"], 
             RowBox[{"y", "[", "m", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"x", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"i", "-", "k"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "i"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"x", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"i", "-", "k", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "i", "-", "1"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             RowBox[{"(", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"l", "=", "1"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"y", "[", "l", "]"}]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "k", "-", "1"}]]}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllStick", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", 
              RowBox[{"j", "+", "1"}]}], "s1"], 
            RowBox[{"x", "[", "k", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"m", "=", "1"}], 
              RowBox[{"j", "+", "1"}]], 
             RowBox[{"x", "[", "m", "]"}]}], ")"}], 
           RowBox[{"s2", "-", "j"}]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", "1"}], 
             RowBox[{"j", "-", "1"}]], 
            RowBox[{"y", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], "j"], 
            RowBox[{
             RowBox[{"x", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"x", "[", "l", "]"}]}], ")"}], 
              RowBox[{"j", "-", "k", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"x", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s2", "-", "j"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", 
              RowBox[{"j", "+", "1"}]}], "s2"], 
            RowBox[{"y", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], "j"], 
            RowBox[{
             RowBox[{"x", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"x", "[", "l", "]"}]}], ")"}], 
              RowBox[{"j", "-", "k", "+", "2"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"x", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s2", "-", "j", "-", "1"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"x", "[", "1", "]"}], "s2"], "+", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"k", "=", "2"}], "j"], 
             RowBox[{
              RowBox[{"x", "[", "k", "]"}], 
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"x", "[", "l", "]"}]}], ")"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"m", "=", "1"}], "k"], 
                 RowBox[{"x", "[", "m", "]"}]}], ")"}], 
               RowBox[{"s2", "-", "k"}]]}]}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "s2"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAllStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllStick", "[", 
         RowBox[{"n", ",", "x", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllStick", "[", 
         RowBox[{"n", ",", "x", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.6929713841475563`*^9, 3.692971421406011*^9}, {
   3.692971514378076*^9, 3.692971526280409*^9}, {3.69297164035741*^9, 
   3.692971730470628*^9}, {3.69297176429277*^9, 3.692971775574144*^9}, {
   3.692971815298686*^9, 3.692971842475584*^9}, {3.692973975693057*^9, 
   3.6929740028806667`*^9}, 3.6929741364527693`*^9, {3.6967268045415587`*^9, 
   3.696726814829624*^9}, {3.6967268810218554`*^9, 3.696726881599987*^9}, {
   3.6967269227491875`*^9, 3.696726927733597*^9}, {3.6967269667516394`*^9, 
   3.696726991564391*^9}, {3.6967270349283447`*^9, 3.696727199656329*^9}, {
   3.6967273411615257`*^9, 3.696727342552168*^9}, {3.696727378249139*^9, 
   3.6967273803741555`*^9}, {3.696727451485079*^9, 3.69672745518824*^9}, {
   3.6967274993924794`*^9, 3.6967275046269083`*^9}, {3.6967275507870007`*^9, 
   3.69672758005373*^9}, {3.696727643727441*^9, 3.696727720627182*^9}, {
   3.696727807177915*^9, 3.6967279100158405`*^9}, {3.6967279725149117`*^9, 
   3.6967279848275332`*^9}, 3.6967346472900934`*^9, {3.69673469761836*^9, 
   3.696734712493534*^9}, 3.69673706532421*^9, 3.6967371283080955`*^9, {
   3.696738745072296*^9, 3.696738750503661*^9}, 3.696828582479192*^9, {
   3.6968405099943542`*^9, 3.696840529825324*^9}, {3.6987669172625437`*^9, 
   3.698766922379345*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "b668e1cc-7797-4ca1-803b-92b1a398c69b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 
   3.692963953308807*^9}},ExpressionUUID->"f12cde70-d1a1-4f2e-a1c9-\
53508bdcbec4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllUnif", "[", 
     RowBox[{"n_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "j", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", "1"}], "i"], 
             RowBox[{"y", "[", "j", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "2"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"y", "[", "k", "]"}], 
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", "1"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"y", "[", "j", "]"}]}], ")"}], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "0"}], 
             RowBox[{"s1", "-", "k", "-", "1"}]], 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"s1", "-", "k", "-", "1"}], ",", "j"}], "]"}], "*", 
               SuperscriptBox[
                RowBox[{"y", "[", "k", "]"}], "j"]}], 
              RowBox[{"j", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "k", "-", "1", "-", "j"}]]}]}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllUnif", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "X"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "s2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"x", "[", "1", "]"}], "s2"], "s2"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", "2"}], "i"], 
              RowBox[{
               RowBox[{"x", "[", "k", "]"}], 
               RowBox[{"(", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"j", "=", "1"}], 
                  RowBox[{"k", "-", "1"}]], 
                 RowBox[{"x", "[", "j", "]"}]}], ")"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "0"}], 
                 RowBox[{"s2", "-", "k"}]], 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"Binomial", "[", 
                    RowBox[{
                    RowBox[{"s2", "-", "k"}], ",", "j"}], "]"}], "*", 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "j"]}], 
                  RowBox[{"j", "+", "1"}]], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                  RowBox[{"s2", "-", "k", "-", "j"}]]}]}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", 
               RowBox[{"i", "+", "1"}]}], "s1"], 
             RowBox[{"x", "[", "j", "]"}]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"j", "=", "1"}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"x", "[", "j", "]"}]}], ")"}], 
            RowBox[{"s2", "-", "i"}]]}], "+", 
          RowBox[{"X", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAllUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllUnif", "[", 
         RowBox[{"n", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllUnif", "[", 
         RowBox[{"n", ",", "x"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692971948476985*^9, 3.692971994858296*^9}, {
   3.692972049751625*^9, 3.692972084501997*^9}, {3.692975341789895*^9, 
   3.692975351060164*^9}, {3.696738734788206*^9, 3.6967387406044707`*^9}, 
   3.696828583874092*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "bdebfd05-7766-4534-a566-db047d910d52"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test two ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}, {3.6929640285511713`*^9, 
  3.692964028829377*^9}},ExpressionUUID->"3d0c2034-5ff4-4bc2-a677-\
3c4fa3038d0c"],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, 3.696728854542264*^9, 
   3.6967348736800723`*^9},ExpressionUUID->"a11fa556-628a-4cbd-95b6-\
6b6012e58e2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsTwoMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "1"}]}], "s2"], 
                 RowBox[{"y", "[", "k", "]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "h"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "i"}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "i"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"i", "-", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "1"}], 
                  RowBox[{"i", "-", "1"}]], 
                 SuperscriptBox[
                  RowBox[{"y", "[", "k", "]"}], "2"]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "2"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s1"], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"h", "+", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"i", "+", "1"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"i", "+", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "i"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "1"}], "i"], 
                 SuperscriptBox[
                  RowBox[{"x", "[", "k", "]"}], "2"]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.69296405838935*^9, {3.692972891863494*^9, 3.692972904003366*^9}, 
   3.692973221638762*^9, {3.692973271587261*^9, 3.692973283784287*^9}, {
   3.692973385832027*^9, 3.692973386799302*^9}, 3.692973950598632*^9, {
   3.692974202411601*^9, 3.692974227891403*^9}, {3.696728867339264*^9, 
   3.6967289098350396`*^9}, {3.696729426803939*^9, 3.6967294506947994`*^9}, {
   3.696729511307807*^9, 3.696729533651781*^9}, 3.696734881336393*^9, 
   3.6967372027632675`*^9, 3.6967387124882517`*^9, {3.6967399376292796`*^9, 
   3.6967399414314756`*^9}, {3.6967552737651577`*^9, 3.696755274813747*^9}, 
   3.696828585652193*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "3867e3e1-9488-4dc6-89db-4b86edb7d67b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 
   3.692963935759516*^9}},ExpressionUUID->"afc827b2-8d8e-4050-81b0-\
09ad9ac2bee7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsTwoStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                  RowBox[{"y", "[", "k", "]"}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "h"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], "+", 
                 RowBox[{"x", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], 
                 RowBox[{"h", "-", "1"}]], 
                SuperscriptBox[
                 RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "i"}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"i", "-", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], "+", 
                 RowBox[{"x", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], 
                 RowBox[{"i", "-", "1"}]], 
                SuperscriptBox[
                 RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                  RowBox[{"x", "[", "k", "]"}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"h", "+", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], "+", 
                 RowBox[{"y", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], "h"], 
                SuperscriptBox[
                 RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "i"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], "+", 
                 RowBox[{"y", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], "i"], 
                SuperscriptBox[
                 RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.692972946664332*^9, {3.6929730338289413`*^9, 
   3.692973068073237*^9}, {3.692973392368725*^9, 3.692973394416008*^9}, {
   3.692973516356391*^9, 3.692973539972237*^9}, {3.6929742458149443`*^9, 
   3.692974273882441*^9}, {3.692975384994193*^9, 3.692975393947578*^9}, {
   3.6929754284748173`*^9, 3.692975436866858*^9}, 3.6967349166032114`*^9, 
   3.6967372087991643`*^9, 3.69673871894256*^9, {3.696739954059035*^9, 
   3.6967399769744077`*^9}, {3.696755249013632*^9, 3.696755250411758*^9}, 
   3.696828587081085*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "1f8017ea-6769-45e0-9d38-ef20759317a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 
   3.692963953308807*^9}},ExpressionUUID->"ad366fe5-8626-421e-8214-\
196ae5600540"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsTwoUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "1"}]}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s2"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "h"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"h", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], " ", ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "i"}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "i"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"i", "-", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"i", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "2"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s1"], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"h", "+", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "h"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"i", "+", "1"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"i", "+", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "i"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "i"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.6929731384319267`*^9, 3.692974154620908*^9, 
   3.692974234012753*^9, {3.6967469924465456`*^9, 3.696746995824072*^9}, 
   3.696828588318671*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "2ffaec68-da07-4843-bfad-5e6d96df6f88"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test adjacent ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}, {3.69296404607685*^9, 
  3.692964047731427*^9}},ExpressionUUID->"2eddc65b-50b7-460f-8d26-\
0c479f701de0"],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, 3.6967330540306826`*^9, 
   3.6967349662811375`*^9},ExpressionUUID->"b49e8314-86b8-47ae-ad78-\
bcd70081eb2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAdjacentMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                   RowBox[{"y", "[", "k", "]"}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "h"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                   RowBox[{"x", "[", "k", "]"}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"h", "+", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "i"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "i"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692964068038495*^9, 3.6929736410221148`*^9, {3.692973745228753*^9, 
   3.6929737474675217`*^9}, {3.6929738312379436`*^9, 
   3.6929738401589622`*^9}, {3.692974298532917*^9, 3.692974319863122*^9}, {
   3.6967330850853195`*^9, 3.696733091201589*^9}, {3.6967331619780006`*^9, 
   3.696733203944004*^9}, {3.6967332392418995`*^9, 3.6967332710532064`*^9}, 
   3.6967349691092567`*^9, 3.6967372274244604`*^9, 3.696738843638236*^9, {
   3.6967400968501387`*^9, 3.6967401164541073`*^9}, 3.6968285897814827`*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "ce572374-25eb-47a6-af4d-329b8c34bab3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963935759516*^9}, 
   3.6967302532243776`*^9, 
   3.6967349830309315`*^9},ExpressionUUID->"daf349c7-1cb9-49bf-a4d8-\
5a7a4c7cc29c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAdjacentStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                    RowBox[{"y", "[", "k", "]"}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "h"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"x", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"h", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"x", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"i", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                    RowBox[{"x", "[", "k", "]"}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"h", "+", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"y", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "h"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "i"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"y", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "i"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692973711838814*^9, 3.69297372635133*^9}, 
   3.692974332136294*^9, {3.692974411967889*^9, 3.692974412967828*^9}, {
   3.6967303459208484`*^9, 3.6967304083518314`*^9}, 3.6967307293512664`*^9, {
   3.696730908487402*^9, 3.696730929860999*^9}, {3.696731141362879*^9, 
   3.696731188773086*^9}, {3.69673122698164*^9, 3.696731227903525*^9}, {
   3.6967312779412575`*^9, 3.696731282331931*^9}, {3.6967314284480247`*^9, 
   3.696731480089882*^9}, {3.6967315163837056`*^9, 3.696731546883236*^9}, {
   3.696731583559874*^9, 3.696731637316484*^9}, 3.6967316726053376`*^9, 
   3.696731757516554*^9, {3.6967318254882236`*^9, 3.6967318621523094`*^9}, {
   3.6967318974016914`*^9, 3.696731912604965*^9}, {3.6967321569031725`*^9, 
   3.696732173011325*^9}, {3.6967322082796135`*^9, 3.696732212293905*^9}, {
   3.696732242855357*^9, 3.696732244949133*^9}, {3.69673242056215*^9, 
   3.6967324624871855`*^9}, {3.6967324935031195`*^9, 
   3.6967325253984137`*^9}, {3.696732606668733*^9, 3.6967326900922427`*^9}, 
   3.6967349872965755`*^9, 3.6967372336539416`*^9, 3.6967388513001175`*^9, {
   3.696740125506257*^9, 3.696740142376296*^9}, 3.6968285905688953`*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "5cfe8e23-be22-4856-9871-0b5719b5fd6d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 
   3.692963953308807*^9}},ExpressionUUID->"11dea85e-ed93-447c-9fc5-\
8c950b85bec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MeanDynamicsAdjacentUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "s2"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "h"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"h", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "i"}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"i", "-", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "s1"], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"h", "+", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "h"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "i"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "i"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.6929743258585653`*^9, {3.696747051467498*^9, 
   3.6967470536969023`*^9}, {3.6967473237742357`*^9, 
   3.6967473245897617`*^9}, {3.696747366748872*^9, 3.696747368779768*^9}, 
   3.696828591390027*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "bea904e1-5481-4e5d-a7de-2c9327246ef1"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Jacobians", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 
   3.69297462997047*^9}},ExpressionUUID->"bbb933f8-30c3-4f47-83c7-\
5a4aa2304c17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobianOfMeanDynamics", "::", "usage"}], "=", 
    "\"\<JacobianOfMeanDynamics[ \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) , \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the Jacobian of the mean dynamics \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\), which must be given as a parameter. The format of \
the parameter \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) that the user must provide is the same format of the \
output given by the function MeanDynamics. Thus, a common use of this \
function is:\n\n\\tJacobianOfMeanDynamics[ MeanDynamics[\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)] ]\n\nwhere:\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) is the function of which you wish to compute the \
Jacobian, expressed in the same format of the output given by the function \
MeanDynamics.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobianOfMeanDynamics", "[", 
     RowBox[{"EM_", ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{"Length", "[", "EM", "]"}], "-", "2"}]}], ",", "s1", ",", 
        "s2", ",", "J"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"J", "=", 
        RowBox[{"D", "[", 
         RowBox[{"EM", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"y", "[", "j", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}], "]"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Jacobian of mean dynamics:\\n\>\"", ",", "\"\<J = \>\"", ",", 
           RowBox[{"MatrixForm", "[", "J", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "J"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjectedJacobian", "::", "usage"}], "=", 
    "\"\<ProjectedJacobian[ \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) , \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the projected Jacobian of the mean \
dynamics \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\), which must be given as a parameter. The projected \
Jacobian is the projection of the regular Jacobian over the two simplices. \
Specifically, the projection is obtained by pre- and post-multiplying the \
Jacobian matrix by the orthogonal projection of \!\(\*SuperscriptBox[\"\
\[DoubleStruckCapitalR]\", 
StyleBox[\"s\",
FontSlant->\"Italic\"]]\) onto \!\(\*
StyleBox[\"T\",
FontSlant->\"Italic\"]\)\[CapitalXi] (see Appendix A of the paper for \
details). The format of the parameter \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) that the user must provide is the same format of the \
output given by the function MeanDynamics. Thus, a common use of this \
function is:\n\n\\tProjectedJacobian[ MeanDynamics[\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)] ]\n\nwhere:\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) is the function of which you wish to compute the \
Jacobian, expressed in the same format of the output given by the function \
MeanDynamics.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjectedJacobian", "[", 
     RowBox[{"EM_", ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{"Length", "[", "EM", "]"}], "-", "2"}]}], ",", "s1", ",", 
        "s2", ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "PJ"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]1", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s1"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]2", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s2"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PJ", "=", 
        RowBox[{
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}], ".", 
         RowBox[{"JacobianOfMeanDynamics", "[", 
          RowBox[{"EM", ",", " ", "verbosity"}], "]"}], ".", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Projected Jacobian of mean dynamics:\\nPJ = \>\"", ",", 
           RowBox[{"MatrixForm", "[", "PJ", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "PJ"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PostProjectedJacobian", "::", "usage"}], "=", 
    "\"\<PostProjectedJacobian[ \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) , \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the post-projected Jacobian of the mean \
dynamics \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\), which must be given as a parameter. The \
post-projected Jacobian is obtained by post-multiplying the Jacobian matrix \
by the orthogonal projection of \
\!\(\*SuperscriptBox[\"\[DoubleStruckCapitalR]\", 
StyleBox[\"s\",
FontSlant->\"Italic\"]]\) onto \!\(\*
StyleBox[\"T\",
FontSlant->\"Italic\"]\)\[CapitalXi] (see Appendix A of the paper for \
details). The format of the parameter \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) that the user must provide is the same format of the \
output given by the function MeanDynamics. Thus, a common use of this \
function is:\n\n\\tPostProjectedJacobian[ MeanDynamics[\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)] ]\n\nwhere:\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"MD\",
FontSlant->\"Italic\"]\) is the function of which you wish to compute the \
Jacobian, expressed in the same format of the output given by the function \
MeanDynamics.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PostProjectedJacobian", "[", 
    RowBox[{"EM_", ",", 
     RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "EM", "]"}], "-", "2"}]}], ",", "s1", ",", 
       "s2", ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "PPJ"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
      RowBox[{"s2", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]1", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s1"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]2", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s2"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"PPJ", "=", 
       RowBox[{
        RowBox[{"JacobianOfMeanDynamics", "[", 
         RowBox[{"EM", ",", "verbosity"}], "]"}], ".", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Post-projected Jacobian of mean dynamics:\\nPPJ = \>\"", ",", 
          RowBox[{"MatrixForm", "[", "PPJ", "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "PPJ"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.696828593571574*^9, 3.6968285954167852`*^9}, {
   3.698738475506781*^9, 3.698738715781979*^9}, {3.698738752559497*^9, 
   3.69873879443849*^9}, {3.698739063540551*^9, 3.69873906925779*^9}, {
   3.698739216696097*^9, 3.698739338915546*^9}, {3.698739408243292*^9, 
   3.698739411351974*^9}, {3.698739508414206*^9, 3.698739515136609*^9}, {
   3.698739826521441*^9, 3.69873984680641*^9}, {3.698740847344013*^9, 
   3.698740848007873*^9}, {3.6992513653981667`*^9, 3.699251372485078*^9}, {
   3.699251410128141*^9, 3.699251433448003*^9}, {3.6992515094194317`*^9, 
   3.699251530320022*^9}, {3.699251584477839*^9, 3.699251623784843*^9}, {
   3.6992519054070673`*^9, 3.69925190802477*^9}, {3.699586157796015*^9, 
   3.6995861949361057`*^9}, {3.699586250771706*^9, 3.699586469856123*^9}, {
   3.699586513704155*^9, 3.6995865199351797`*^9}, {3.7002869632958612`*^9, 
   3.700286982048175*^9}, {3.700299744133972*^9, 3.700299821995768*^9}, {
   3.701500427902754*^9, 3.7015004290613127`*^9}, {3.7015014903650923`*^9, 
   3.701501529940853*^9}, {3.701501816347459*^9, 3.7015018403316307`*^9}, {
   3.701501911029311*^9, 3.701501935171547*^9}, {3.7015019792022543`*^9, 
   3.701501989600915*^9}, {3.701502033386196*^9, 3.701502125772025*^9}, {
   3.701502337929448*^9, 3.701502351774457*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "8d5b138f-de6f-4a09-9825-27418d4ee3d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Exact rest points (Gr\[ODoubleDot]bner bases)", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 
   3.693034985806531*^9}},ExpressionUUID->"ea2e59c7-aa89-4370-b457-\
cd778de4d818"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExactRestPoints", "::", "usage"}], "=", 
    "\"\<ExactRestPoints[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\):False, \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\):False, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):5, \!\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\):precision ] returns the exact rest points of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). The \
computation of the rest points is performed by obtaining a \
Gr\[ODoubleDot]bner basis.\[IndentingNewLine]\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is an optional (boolean) parameter. If \!\(\*
StyleBox[\"useFullSimplify\",
FontSlant->\"Italic\"]\) is set to True, then the mean dynamics equations are \
simplified before computing the exact rest points.\n- \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\) is an optional (boolean) parameter. If \!\(\*
StyleBox[\"omitLastVariable\",
FontSlant->\"Italic\"]\) is set to True, then the following two identities \n\
\\t x[s1] == 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 1\), \(s1 - \
1\)]\)x[i] \n\\t y[s2] == 1 - \!\(\*UnderoverscriptBox[\(\[Sum]\), \(i = 1\), \
\(s2 - 1\)]\)y[i]\n     are used to eliminate the last variables (i.e. x[s1] \
and y[s2]) in the mean dynamics equations before computing the exact rest \
points. (s1 and s2 are the number of strategies for the first movers and the \
second movers respectively.)\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\) is an optional parameter, which determines the way \
some numbers are displayed (i.e. it has no effect on any important \
computation). It is an integer that controls the number of digits displayed \
in the message that shows the numerical approximation to the exact solution. \
The default value is \!\(\*
StyleBox[\"precision\",
FontSlant->\"Italic\"]\), which is a global parameter set at the top of this \
notebook, in the cell \\\"General options\\\".\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExactRestPoints", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"useFullSimplify_:", "False"}], ",", 
     RowBox[{"omitLastVariable_:", "False"}], ",", 
     RowBox[{"verbosity_:", "5"}], ",", 
     RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "vars", ",", "basis", ",", "sol"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EM", "=", 
       RowBox[{"MeanDynamics", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
         "useFullSimplify", ",", "omitLastVariable", ",", "verbosity"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"tieBreakingRule", "==", "\"\<stick\>\""}], " ", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "We", " ", "have", " ", "to", " ", "remove", " ", "the", " ", 
          "vertex"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<\!\(\*
StyleBox[\"IMPORTANT\",
FontVariations->{\"Underline\"->True}]\): To get a polynomial system with a \
finite solution set we have to impose the additional constraint x[1]\
\[NotEqual]1.\\nThis is done by adding the polynomial \
(x[1]-1)*z\[Equal]1.\\nThus, even though x[1]=y[1]=1 is indeed a rest point, \
it will not appear below.\>\"", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"omitLastVariable", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"s2", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", "z", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"basis", "=", 
             RowBox[{"GroebnerBasis", "[", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"EM", "\[Equal]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "-", "1"}], ")"}], "*", 
                    "z"}], "\[Equal]", "1"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", "vars"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", "z", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"basis", "=", 
             RowBox[{"GroebnerBasis", "[", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"EM", "\[Equal]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "-", "1"}], ")"}], "*", 
                    "z"}], "\[Equal]", "1"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", 
                    "1"}], ",", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"y", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", 
                    "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               "vars"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"omitLastVariable", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"s2", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"basis", "=", 
             RowBox[{"GroebnerBasis", "[", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"EM", "\[Equal]", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], 
                "]"}], ",", "\[IndentingNewLine]", "vars"}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vars", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"basis", "=", 
             RowBox[{"GroebnerBasis", "[", 
              RowBox[{
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"EM", "\[Equal]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", 
                    "1"}], ",", 
                   RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"y", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", 
                    "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               "vars"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gr\[ODoubleDot]bner basis: \\n\>\"", ",", " ", 
          RowBox[{"MatrixForm", "@", "basis"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Variables in Gr\[ODoubleDot]bner basis: \\n\>\"", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"Variables", ",", "basis"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "Print", "[", "\"\<Max degrees in Gr\[ODoubleDot]bner basis:\>\"", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"MatrixForm", "@", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Exponent", "[", 
                 RowBox[{"#", ",", "vars"}], "]"}], "&"}], ",", "basis"}], 
              "]"}], ",", "vars"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"{", 
        RowBox[{"ToRules", "[", "\[IndentingNewLine]", 
         RowBox[{"Reduce", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"basis", "\[Equal]", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"Length", "[", "basis", "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", 
                RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"omitLastVariable", ",", 
                   RowBox[{"s1", "-", "1"}], ",", "s1"}], "]"}]}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", 
                RowBox[{"y", "[", "j", "]"}], "\[LessEqual]", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{"omitLastVariable", ",", 
                   RowBox[{"s2", "-", "1"}], ",", "s2"}], "]"}]}], "}"}]}], 
              "]"}]}], "]"}], ",", "Reals", ",", 
           RowBox[{"Backsubstitution", "\[Rule]", "True"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$MaxExtraPrecision", "=", "100"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Numerical approximation to exact solution computed using \
the Gr\[ODoubleDot]bner basis: \\n\>\"", ",", " ", 
              RowBox[{"(", 
               RowBox[{"sol", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                  ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                  ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                    RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                 "}"}]}], ")"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "sol"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, 
   3.693134475591817*^9, 3.693134523348681*^9, 3.693134598623486*^9, {
   3.69315957327136*^9, 3.693159598401268*^9}, {3.693933994694413*^9, 
   3.6939339979696627`*^9}, {3.693934112492138*^9, 3.693934114915821*^9}, {
   3.696826351841462*^9, 3.6968264073627243`*^9}, {3.696826474124496*^9, 
   3.6968265635288067`*^9}, {3.696826676446637*^9, 3.69682672808354*^9}, {
   3.6968267640169983`*^9, 3.696826916712748*^9}, {3.696827045696845*^9, 
   3.696827057855486*^9}, {3.696827263814695*^9, 3.696827270527565*^9}, {
   3.696827497306391*^9, 3.696827572016817*^9}, {3.696827826200609*^9, 
   3.6968278266054688`*^9}, {3.696827867906528*^9, 3.696827868848894*^9}, {
   3.6968279556322107`*^9, 3.6968279866714897`*^9}, 3.696828072767599*^9, {
   3.6968281935369596`*^9, 3.69682821657541*^9}, {3.69682860148281*^9, 
   3.696828603316477*^9}, 3.6968286719868393`*^9, 3.696828797166843*^9, {
   3.6975661984355917`*^9, 3.697566201190921*^9}, {3.697566241000029*^9, 
   3.697566273608944*^9}, {3.697566937374559*^9, 3.697566940253327*^9}, {
   3.697567070100572*^9, 3.697567078202367*^9}, {3.698570834151511*^9, 
   3.6985708906327457`*^9}, {3.6985709240421553`*^9, 
   3.6985709319278097`*^9}, {3.698732890379766*^9, 3.698732891792461*^9}, {
   3.698739570585836*^9, 3.698739572031186*^9}, {3.698739718612611*^9, 
   3.6987397594525967`*^9}, {3.698739865531703*^9, 3.698739906210641*^9}, {
   3.698739959131729*^9, 3.6987399898644247`*^9}, {3.698740067623678*^9, 
   3.698740073539576*^9}, {3.698740142078405*^9, 3.698740142941124*^9}, {
   3.698740553399078*^9, 3.698740764964443*^9}, 3.698740848634824*^9, {
   3.6987665648955917`*^9, 3.698766565740204*^9}, {3.698767069874551*^9, 
   3.698767076815548*^9}, {3.699698702803583*^9, 3.699698713286786*^9}, {
   3.699712265558214*^9, 3.6997123594618893`*^9}, {3.699712418942334*^9, 
   3.6997124197746696`*^9}, {3.6997124933406467`*^9, 
   3.6997125356503067`*^9}, {3.6997132757889957`*^9, 3.699713333443652*^9}, {
   3.699713370019705*^9, 3.699713372830482*^9}, {3.699713423830524*^9, 
   3.699713424771783*^9}, {3.699720648393248*^9, 3.6997206595511417`*^9}, {
   3.699720691288006*^9, 3.6997206928966503`*^9}, {3.7015004348465433`*^9, 
   3.701500437546277*^9}, 3.701500968609207*^9, {3.701501139792103*^9, 
   3.701501158352508*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "f09878dc-df6e-450e-a7ae-27b2f26e9eeb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Approximate rest points (floating-point and rational approximations)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693122858808473*^9, 
   3.693122871430587*^9}},ExpressionUUID->"9741be4a-3c29-47c9-896e-\
9e3a7dbb031f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FloatingPointApproximateRestPoint", "::", "usage"}], "=", 
    "\"\<FloatingPointApproximateRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\):2.^-4 ] returns an approximate rest point of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). \n\n\
This function employs the Euler method to find a fixed point of the equation \
\n\\t \!\(\*SubscriptBox[\(x\), \(t + 1\)]\) = \!\(\*SubscriptBox[\(x\), \
\(t\)]\) + step * MeanDynamics(\!\(\*SubscriptBox[\(x\), \(t\)]\)) \n      \
using floating-point arithmetic and starting from the center of the \
simplices.\[IndentingNewLine]\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game\n- \!\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\) is an optional parameter. It determines the \
magnitude of the step used in the Euler method.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FloatingPointApproximateRestPoint", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"step_:", 
       RowBox[{"2.", "^", 
        RowBox[{"-", "4"}]}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
        ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "P", ",", "vars", 
        ",", "CompiledNextIteration", ",", "Compiledfpoint"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EM", "=", 
        RowBox[{"MeanDynamics", "[", 
         RowBox[{
         "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False", 
          ",", "False", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]1", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s1"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]2", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s2"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CompiledNextIteration", "=", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", "vars", "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], "]"}]}], "]"}], 
            "+", 
            RowBox[{"step", "*", 
             RowBox[{"P", ".", "EM"}]}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Compiledfpoint", "=", 
        RowBox[{"Clip", "[", 
         RowBox[{
          RowBox[{"FixedPoint", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"CompiledNextIteration", "@@", "#"}], ")"}], "&"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s1"}], ",", "s1"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s2"}], ",", "s2"}], "]"}]}], "]"}], ",", 
            RowBox[{"10", "^", "5"}], ",", 
            RowBox[{"SameTest", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"#1", "-", "#2"}], "]"}], "<", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "16"}]}]}], "&"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Thread", "[", 
        RowBox[{"vars", "\[Rule]", "Compiledfpoint"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RationalApproximateRestPoint", "::", "usage"}], "=", 
    "\"\<RationalApproximateRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"minIterations\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"maxIterations\",
FontSlant->\"Italic\"]\):200 ] returns the approximate rest points of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1).\n\n\
This function employs the Euler method to find a fixed point of the equation \
\n\\t \!\(\*SubscriptBox[\(x\), \(t + 1\)]\) = \!\(\*SubscriptBox[\(x\), \
\(t\)]\) + step * MeanDynamics(\!\(\*SubscriptBox[\(x\), \(t\)]\)) \n      \
using exact rational arithmetic and starting from a rational point close to \
the output of FloatingPointApproximateRestPoint.\n\nThe point returned by \
this function is a fixed point in the sense that \!\(\*SubscriptBox[\(x\), \
\(t\)]\) and \!\(\*SubscriptBox[\(x\), \(t + 1\)]\) (= \!\(\*SubscriptBox[\(x\
\), \(t\)]\) + step * MeanDynamics(\!\(\*SubscriptBox[\(x\), \(t\)]\))) are \
equal when expressed with 6 digits of precision for numbers greater or equal \
to \!\(\*SuperscriptBox[\(10\), \(-4\)]\), and 3 digits of precision for \
smaller numbers).\[IndentingNewLine]\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\) is an optional parameter. It determines the \
magnitude of the step used in the Euler method.\n- \!\(\*
StyleBox[\"minIterations\",
FontSlant->\"Italic\"]\) is an optional parameter that determines the minimum \
number of iterations that the Euler method is conducted. \n- \!\(\*
StyleBox[\"maxIterations\",
FontSlant->\"Italic\"]\) is an optional parameter that determines the maximum \
number of iterations that the Euler method is conducted.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RationalApproximateRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"step_:", "1"}], ",", 
     RowBox[{"minIterations_:", "1"}], ",", 
     RowBox[{"maxIterations_:", "200"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "fixedPoint", ",", "iterations", ",", 
       RowBox[{"oldFixedPointStr", "=", "\"\<old\>\""}], ",", 
       RowBox[{"newFixedPointStr", "=", "\"\<new\>\""}], ",", "vars", ",", 
       RowBox[{"scientificDigits", "=", "3"}], ",", 
       RowBox[{"decimalPlaces", "=", "6"}], ",", "headings", ",", "Nice"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EM", "=", 
       RowBox[{"MeanDynamics", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False", 
         ",", "False", ",", "verbosity"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fixedPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Nice", "[", "a_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "4"}]}]}], ",", 
         RowBox[{"ScientificForm", "[", 
          RowBox[{
           RowBox[{"N", "[", "a", "]"}], ",", "scientificDigits"}], "]"}], 
         ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"N", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"decimalPlaces", "+", "4"}], ",", "decimalPlaces"}], 
            "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"Nice", ",", "Listable"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"headings", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x[\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "Italic", ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"i", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<]\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<y[\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "Italic", ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"i", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<]\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}], ",", 
            "None"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Floating-point approximation to rest point:\\n\\t\>\"", ",", 
           RowBox[{"TableForm", "[", 
            RowBox[{
             RowBox[{"Nice", "[", "fixedPoint", "]"}], ",", 
             RowBox[{"TableHeadings", "\[Rule]", "headings"}], ",", 
             RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
             RowBox[{"TableSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"3", ",", "Automatic"}], "}"}]}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iterations", "=", "1"}], ",", 
        RowBox[{
         RowBox[{"iterations", "\[LessEqual]", "minIterations"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iterations", "\[LessEqual]", "maxIterations"}], "&&", 
           RowBox[{"(", 
            RowBox[{"oldFixedPointStr", "\[NotEqual]", "newFixedPointStr"}], 
            ")"}]}], ")"}]}], ",", 
        RowBox[{"iterations", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "The", " ", "following", " ", "three", " ", "lines", " ", "of", " ",
            "code", " ", "should", " ", "not", " ", "be", " ", "necessary", 
           " ", "in", " ", "principle"}], ",", " ", 
          RowBox[{
          "but", " ", "they", " ", "are", " ", "vital", " ", "to", " ", 
           "speed", " ", "up", " ", "the", " ", "execution"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fixedPoint", "=", 
          RowBox[{"N", "[", 
           RowBox[{"fixedPoint", ",", "16"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Here", " ", "we", " ", "are", " ", "taking", " ", "the", " ", 
            "16", " ", "most", " ", "significant", " ", "digits", " ", "of", 
            " ", "fixedPoint"}], ",", " ", 
           RowBox[{"which", " ", "is", " ", "a", " ", "rational", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "except", " ", "at", " ", "the", " ", "very", " ", "first", 
                " ", "iteration"}], ",", " ", 
               RowBox[{
               "where", " ", "it", " ", "is", " ", "a", " ", "machine", " ", 
                "number"}]}], ")"}], "."}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "fixedPoint", " ", "now", " ", "is", " ", "NOT", " ", "an", " ", 
              "IEEE", " ", "754", " ", "floating"}], "-", 
             RowBox[{"point", " ", "number", " ", 
              RowBox[{"(", 
               RowBox[{
               "except", " ", "at", " ", "the", " ", "very", " ", "first", 
                " ", "iteration"}], ")"}]}]}], ";", " ", 
            RowBox[{
            "it", " ", "is", " ", "a", " ", "number", " ", "with", " ", "16", 
             " ", "digits", " ", "of", " ", "precision"}]}], ",", " ", 
           RowBox[{
           "and", " ", "will", " ", "be", " ", "rationalized", " ", "at", " ",
             "the", " ", "next", " ", "line", " ", "of", " ", "code"}]}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"fixedPoint", ",", "0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{
              RowBox[{"fixedPoint", "[", 
               RowBox[{"[", 
                RowBox[{";;", "s1"}], "]"}], "]"}], ",", "Total"}], "]"}], 
            ",", 
            RowBox[{"Normalize", "[", 
             RowBox[{
              RowBox[{"fixedPoint", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}], ",", 
              "Total"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"oldFixedPointStr", "=", 
          RowBox[{"ToString", "[", 
           RowBox[{"Nice", "[", "fixedPoint", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"fixedPoint", " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{"EM", "/.", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{"vars", "\[Rule]", "fixedPoint"}], "]"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newFixedPointStr", "=", 
          RowBox[{"ToString", "[", 
           RowBox[{"Nice", "[", "fixedPoint", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<\\n\>\"", ",", "iterations", " ", ",", 
              "\"\< iterations with rational arithmetic conducted:\\n\\t\>\"",
               ",", 
              RowBox[{"TableForm", "[", 
               RowBox[{
                RowBox[{"Nice", "[", "fixedPoint", "]"}], ",", 
                RowBox[{"TableHeadings", "\[Rule]", "headings"}], ",", 
                RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
                RowBox[{"TableSpacing", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "Automatic"}], "}"}]}]}], "]"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "When", " ", "we", " ", "go", " ", "out", " ", "of", " ", "the", " ", 
         "loop", " ", "For", " ", "above", " ", "because", " ", 
         RowBox[{"(", 
          RowBox[{
          "oldFixedPointStr", " ", "\[Equal]", " ", "newFixedPointStr"}], 
          ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "know", " ", "that", " ", "we", " ", "have", " ", "found",
           " ", "a", " ", "rational", " ", "point", " ", "x", " ", "such", 
          " ", "that", " ", 
          RowBox[{"Nice", "[", "x", "]"}]}], " ", "==", " ", 
         RowBox[{"Nice", "[", 
          RowBox[{"x", " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{"EM", "/.", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{"vars", "\[Rule]", "x"}], "]"}], ")"}]}], ")"}]}], 
          "]"}]}], ",", " ", 
        RowBox[{
        "with", " ", "all", " ", "the", " ", "operations", " ", "conducted", 
         " ", "using", " ", 
         RowBox[{"(", "exact", ")"}], " ", "rational", " ", "arithmetic"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", "fixedPoint"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.6930782387289886`*^9, 3.693078300364564*^9}, 
   3.693078716564457*^9, {3.693079235598392*^9, 3.693079247072733*^9}, {
   3.6930794380101223`*^9, 3.693079467990863*^9}, {3.693136319502043*^9, 
   3.6931363234150133`*^9}, {3.6931364139910517`*^9, 3.693136422482757*^9}, {
   3.6931364760342283`*^9, 3.6931364895659723`*^9}, {3.693137612361279*^9, 
   3.693137639350355*^9}, {3.693138063131918*^9, 3.693138078261816*^9}, {
   3.693138236617819*^9, 3.69313826843231*^9}, {3.693138335247323*^9, 
   3.6931383461365747`*^9}, {3.693138381338953*^9, 3.693138419050747*^9}, {
   3.693138541970661*^9, 3.6931385423167763`*^9}, {3.693138669589295*^9, 
   3.693138677665885*^9}, {3.693138875093635*^9, 3.693138985750143*^9}, {
   3.69314775298455*^9, 3.693147767314724*^9}, {3.6931478261887407`*^9, 
   3.693147826626112*^9}, {3.693147865128304*^9, 3.6931478769311333`*^9}, {
   3.6931492699806356`*^9, 3.693149292849177*^9}, {3.693149492415955*^9, 
   3.6931495075803022`*^9}, {3.693149547700653*^9, 3.69314956667762*^9}, 
   3.693149870172721*^9, {3.693150036166513*^9, 3.693150263738756*^9}, {
   3.6932069453918133`*^9, 3.6932069566155987`*^9}, {3.693206998202588*^9, 
   3.6932070158794947`*^9}, 3.693207198035336*^9, {3.6932072330008574`*^9, 
   3.6932072601728973`*^9}, {3.693207392339109*^9, 3.693207392541028*^9}, {
   3.693207575457324*^9, 3.693207619068685*^9}, {3.693207666072659*^9, 
   3.693207666274315*^9}, {3.693207727272704*^9, 3.693207731209276*^9}, {
   3.693207773554965*^9, 3.693207779589684*^9}, {3.6932078371624813`*^9, 
   3.6932078503901377`*^9}, {3.693207910610713*^9, 3.693207911060623*^9}, {
   3.693207985390582*^9, 3.693207985748513*^9}, {3.693208016707836*^9, 
   3.6932080255509253`*^9}, {3.6932080754216423`*^9, 3.693208080753087*^9}, {
   3.6932081684126987`*^9, 3.6932081687501087`*^9}, {3.693208297166788*^9, 
   3.693208338217551*^9}, {3.6932083994970827`*^9, 3.69320843799277*^9}, {
   3.693209085930689*^9, 3.693209102904922*^9}, {3.6932091393151503`*^9, 
   3.693209178427332*^9}, {3.693209212806425*^9, 3.693209247713369*^9}, {
   3.693209280339925*^9, 3.693209311592454*^9}, {3.693209371981536*^9, 
   3.693209430085087*^9}, {3.6932094713504066`*^9, 3.693209496618821*^9}, 
   3.6932119275955763`*^9, {3.693212031759049*^9, 3.693212071942574*^9}, {
   3.693212127831294*^9, 3.6932121407798357`*^9}, {3.693212174621189*^9, 
   3.693212197479657*^9}, {3.693212450264653*^9, 3.6932124594678097`*^9}, {
   3.693212498166594*^9, 3.693212510776452*^9}, 3.693212599965467*^9, 
   3.693212694409498*^9, {3.69321276407168*^9, 3.693212764573299*^9}, {
   3.6932671980200167`*^9, 3.693267204373417*^9}, {3.6932672654402847`*^9, 
   3.6932672715362597`*^9}, {3.693267390415722*^9, 3.693267395050537*^9}, {
   3.693267464026039*^9, 3.693267625509468*^9}, {3.69338734971747*^9, 
   3.693387412547888*^9}, {3.693387599520523*^9, 3.693387600389485*^9}, {
   3.693387631435237*^9, 3.693387634666725*^9}, {3.696763975699391*^9, 
   3.696763988261155*^9}, {3.696764240551014*^9, 3.696764241181069*^9}, {
   3.69682860546528*^9, 3.696828606342087*^9}, {3.6975672321263027`*^9, 
   3.697567240629919*^9}, {3.697567289897121*^9, 3.6975672912448606`*^9}, {
   3.6975673564299183`*^9, 3.697567358193839*^9}, {3.6985709490947123`*^9, 
   3.698570964881323*^9}, {3.698742880508086*^9, 3.6987429851553183`*^9}, {
   3.698743039005073*^9, 3.6987430473956547`*^9}, {3.698743104390995*^9, 
   3.698743174312319*^9}, {3.6987666248611183`*^9, 3.698766625466299*^9}, {
   3.698766690793676*^9, 3.6987668105113783`*^9}, {3.6992499865376673`*^9, 
   3.699250030310458*^9}, {3.699250070630229*^9, 3.6992500726765738`*^9}, {
   3.699250119498558*^9, 3.699250132210731*^9}, {3.699250211344949*^9, 
   3.6992502803265743`*^9}, {3.699250310581299*^9, 3.6992503141221848`*^9}, {
   3.6992503548152027`*^9, 3.699250560359679*^9}, {3.699250620457304*^9, 
   3.6992507452626343`*^9}, {3.699250784594921*^9, 3.6992507856953487`*^9}, {
   3.701095651727941*^9, 3.701095669589156*^9}, 3.701105004881365*^9, {
   3.7011622853429337`*^9, 3.7011622864096212`*^9}, {3.7015004429578123`*^9, 
   3.7015004512384644`*^9}, {3.701500973693204*^9, 3.701500979610585*^9}, {
   3.701593228209036*^9, 3.701593266189296*^9}, {3.7015934917585382`*^9, 
   3.701593493653356*^9}, {3.701593525300839*^9, 3.7015935605042143`*^9}, {
   3.701593593020709*^9, 3.701593593548558*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "5c293add-696a-41fa-a1fc-79001887ac42"]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigenvalues at approximate rest points", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 
   3.693079502571559*^9}},ExpressionUUID->"d57bf0b2-7a95-4682-82fb-\
54305dc96b80"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "::", "usage"}], 
    "=", "\"\<EigenvaluesAtRationalApproximateRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the exact eigenvalues of the (projected) \
Jacobian of the mean dynamics of the BEP dynamics for a Centipede game of \
length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1), \
evaluated at a rational point close to the exact rest point. This rational \
approximation is computed using the function RationalApproximateRestPoint.\n\n\
\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "fixedPointRules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedPointRules", "=", 
        RowBox[{"RationalApproximateRestPoint", "[", 
         RowBox[{
         "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
          "verbosity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EigenvaluesAt", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
         "fixedPointRules", ",", "verbosity"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NEigenvaluesAtRationalApproximateRestPoint", "::", "usage"}], 
    "=", "\"\<NEigenvaluesAtRationalApproximateRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the approximate eigenvalues of the \
(projected) Jacobian of the mean dynamics of the BEP dynamics for a Centipede \
game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1), \
evaluated at a 16-digit-precision approximation to a rational point close to \
the exact rest point. The rational approximation is computed using the \
function RationalApproximateRestPoint, and the 16-digit-precision \
approximation to the rational number is computed using N[ ,16]. Thus, the \
computation of the eigenvalues is conducted using arbitrary-precision \
numbers.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NEigenvaluesAtRationalApproximateRestPoint", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fixedPointRules", ",", "vars"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fixedPointRules", "=", 
        RowBox[{"RationalApproximateRestPoint", "[", 
         RowBox[{
         "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
          "verbosity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], "}"}]}],
            "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"IntegerPart", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], "}"}]}],
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fixedPointRules", "=", 
        RowBox[{"Thread", "[", 
         RowBox[{"vars", "\[Rule]", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"vars", "/.", "fixedPointRules"}], ")"}], ",", "16"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"EigenvaluesAt", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
         "fixedPointRules", ",", "verbosity"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesAt", "[", 
    RowBox[{
    "testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     "pointRules_", ",", 
     RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"projectedJacobian", ",", "eigenvalues", ",", 
       RowBox[{"scientificDigits", "=", "3"}], ",", 
       RowBox[{"decimalPlaces", "=", "4"}], ",", "niceEigenvalues", ",", 
       "Nice"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"projectedJacobian", "=", 
       RowBox[{"ProjectedJacobian", "[", 
        RowBox[{
         RowBox[{"MeanDynamics", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False", 
           ",", "False", ",", "0"}], "]"}], ",", 
         RowBox[{"verbosity", "-", "1"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eigenvalues", "=", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"projectedJacobian", "/.", "pointRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Nice", "[", "a_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "a", "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "2"}]]}], ",", 
            RowBox[{"ScientificForm", "[", 
             RowBox[{"a", ",", "scientificDigits"}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"decimalPlaces", "+", "4"}], ",", "decimalPlaces"}], 
               "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"niceEigenvalues", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Nice", "[", 
                RowBox[{"Re", "[", "#", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"Nice", "[", 
                 RowBox[{"Im", "[", "#", "]"}], "]"}], "*", "I"}]}], ")"}], 
             "&"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{"eigenvalues", ",", "16"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Eigenvalues at rational approximate rest point:\>\"", ",", 
           RowBox[{"TableForm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"niceEigenvalues", ",", 
                RowBox[{"Precision", "/@", "eigenvalues"}]}], "}"}], 
              "\[Transpose]"}], ",", 
             RowBox[{"TableHeadings", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"\"\<\[Lambda]\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], ",", "Bold", ",", 
                    "14"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"n", "+", "2"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Numerical approx.\>\"", ",", " ", 
                  "\"\<Precision of returned values\>\""}], "}"}]}], "}"}]}], 
             ",", 
             RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
             RowBox[{"TableSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"3", ",", "1"}], "}"}]}], ",", 
             RowBox[{"TableAlignments", "\[Rule]", "Center"}]}], "]"}]}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "eigenvalues"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, 
   3.693119174720704*^9, 3.693119643490077*^9, 3.6968286089392023`*^9, {
   3.697567397265039*^9, 3.6975673990526857`*^9}, 3.6975678614350233`*^9, 
   3.6985709885700283`*^9, {3.699253713054598*^9, 3.6992537204549007`*^9}, {
   3.699253808417655*^9, 3.699253828543388*^9}, {3.6994530565545807`*^9, 
   3.6994530594007397`*^9}, {3.699453110824827*^9, 3.699453128858018*^9}, {
   3.6994532211220827`*^9, 3.6994532397282753`*^9}, {3.699453478501113*^9, 
   3.6994535673647842`*^9}, {3.699585423166418*^9, 3.699585483285293*^9}, {
   3.699585528856862*^9, 3.6995856132665586`*^9}, {3.699585654358037*^9, 
   3.699585790237199*^9}, {3.699585823535777*^9, 3.6995858432874537`*^9}, {
   3.699585886213945*^9, 3.6995858863789377`*^9}, 3.699585933183832*^9, {
   3.699585972439208*^9, 3.6995860150334272`*^9}, {3.699586543872924*^9, 
   3.699586546262618*^9}, {3.69958855276404*^9, 3.699588634114349*^9}, {
   3.6995887483241863`*^9, 3.699588890850594*^9}, {3.699588941174588*^9, 
   3.6995889937179813`*^9}, {3.699590279003351*^9, 3.699590281376186*^9}, {
   3.699703090746953*^9, 3.699703092708194*^9}, {3.699703140087376*^9, 
   3.699703152879236*^9}, {3.699703307410837*^9, 3.699703343490498*^9}, 
   3.7002067257136097`*^9, {3.701161718829686*^9, 3.70116172504992*^9}, {
   3.701161772964473*^9, 3.701161773288969*^9}, {3.7015004535650663`*^9, 
   3.701500464409895*^9}, {3.701500990386951*^9, 3.701501003662244*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "ef3ddae7-5ab7-4988-8529-aade0de221fe"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Local stability of interior rest point (perturbation theorem)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 
   3.693122910064415*^9}},ExpressionUUID->"3007b06d-e525-45c6-9e50-\
b9338c6d4522"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LocalStabilityOfInteriorRestPoint", "::", "usage"}], "=", 
    "\"\<LocalStabilityOfInteriorRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\):precision ] analyzes the local stability of the \
interior rest point of the BEP dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). To \
conduct this analysis, the function computes the exact eigenvalues of the \
(projected and reduced) Jacobian of the mean dynamics of the BEP dynamics, \
evaluated at a rational point close to the exact rest point (which is \
computed by obtaining a Gr\[ODoubleDot]bner basis). Then, using a \
perturbation theorem, it computes a bound for the eigenvalues at the exact \
interior rest point. Using the computed bound and the eigenvalues at the \
close rational point, the function checks whether all the eignevalues at the \
exact interior rest point have negative real part. See Appendix B and Online \
Appendix III of the paper for details.\n\nThe function returns \!\(\*
StyleBox[\"True\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) if the conducted analysis concludes \
that the interior rest point is locally stable. Otherwise it returns \!\(\*
StyleBox[\"False\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\) is an optional parameter, which determines the way \
some numbers are displayed (i.e. it has no effect on any important \
computation). It is an integer that controls the number of digits displayed \
in the messages that show numerical approximations to exact values. The \
default value is \!\(\*
StyleBox[\"precision\",
FontSlant->\"Italic\"]\), which is a global parameter set at the top of this \
notebook, in the cell \\\"General options\\\".\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocalStabilityOfInteriorRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorRestPoint", ",", "reducedJacobian", ",", "closeRational", ",",
        "closeAPN", ",", "eigensystem", ",", "eigenvalues", ",", 
       "eigenvectors", ",", "Neigenvectors", ",", "tolerance", ",", "xVector",
        ",", "yVector", ",", "allvars", ",", "Rbar1", ",", "Rbar2", ",", " ", 
       "Rbar", ",", "timeComputingEigensystem", ",", " ", "EM", ",", "bound", 
       ",", " ", "aux1", ",", " ", "aux2", ",", "boundsEigenvalues"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"y", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"xVector", ",", "yVector"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorRestPoint", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"ExactRestPoints", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False", 
           ",", "False", ",", "verbosity", ",", "prec"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "/.", "#"}], ")"}], "\[NotEqual]",
             "1"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "interiorRestPoint", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interiorRestPoint", "=", 
          RowBox[{"First", "[", "interiorRestPoint", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to interior exact solution: \\n\>\"",
              ",", " ", 
             RowBox[{"(", 
              RowBox[{"interiorRestPoint", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{"z", "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"closeRational", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"xVector", ",", "yVector"}], "]"}], "\[Rule]", " ", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"xVector", "/.", "interiorRestPoint"}], ",", 
                    "6"}], "]"}], ",", "0"}], "]"}], ",", "Total"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Normalize", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"yVector", "/.", "interiorRestPoint"}], ",", 
                    "6"}], "]"}], ",", "0"}], "]"}], ",", "Total"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Rational point close to interior exact solution: \\n\>\"", 
              ",", " ", "closeRational"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Numerical approximation to rational point close to interior \
exact solution: \\n\>\"", ",", " ", 
              RowBox[{"(", 
               RowBox[{"closeRational", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                  ",", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                 "}"}]}], ")"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"EM", " ", "=", 
          RowBox[{"MeanDynamics", "[", 
           RowBox[{
           "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False",
             ",", "False", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Rbar1", "=", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["s1"], "-", "s1"}], 
              RowBox[{"s1", 
               RowBox[{"(", 
                RowBox[{"s1", "-", "1"}], ")"}]}]], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s1", "-", "1"}], ",", 
               RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}], "+", " ", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"s1", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Rbar2", "=", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             FractionBox[
              RowBox[{
               SqrtBox["s2"], "-", "s2"}], 
              RowBox[{"s2", 
               RowBox[{"(", 
                RowBox[{"s2", "-", "1"}], ")"}]}]], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"s2", "-", "1"}], ",", 
               RowBox[{"s2", "-", "1"}]}], "}"}]}], "]"}], "+", " ", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"s2", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Rbar1", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{"Rbar1", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s1", "-", "1"}], ",", "s1"}], "}"}], ",", " ", 
            RowBox[{"-", 
             FractionBox[
              SqrtBox["s1"], "s1"]}]}], "]"}]}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Add", " ", "a", " ", "column", " ", "of", " ", "elements", " ", 
            "equal", " ", "to"}], " ", "-", 
           FractionBox[
            SqrtBox["s1"], "s1"]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Rbar2", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{"Rbar2", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"s2", "-", "1"}], ",", "s2"}], "}"}], ",", " ", 
            RowBox[{"-", 
             FractionBox[
              SqrtBox["s2"], "s2"]}]}], "]"}]}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Add", " ", "a", " ", "column", " ", "of", " ", "elements", " ", 
            "equal", " ", "to"}], " ", "-", 
           FractionBox[
            SqrtBox["s2"], "s2"]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Rbar", "=", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Rbar1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Rbar2"}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "9"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Rbar = \>\"", ",", 
             RowBox[{"Rbar", "//", "MatrixForm"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"reducedJacobian", "=", 
          RowBox[{"Rbar", ".", 
           RowBox[{"JacobianOfMeanDynamics", "[", 
            RowBox[{"EM", ",", "verbosity"}], "]"}], ".", 
           RowBox[{"Rbar", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "8"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Reduced Jacobian:\\nRJ = \>\"", ",", 
             RowBox[{"reducedJacobian", "//", "MatrixForm"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"timeComputingEigensystem", "=", 
          RowBox[{"First", "[", 
           RowBox[{"Timing", "[", 
            RowBox[{"eigensystem", "=", 
             RowBox[{"Eigensystem", "[", 
              RowBox[{"reducedJacobian", "/.", "closeRational"}], "]"}]}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "7"}], ",", 
           RowBox[{"Print", " ", "[", 
            RowBox[{
            "\"\<Time computing the eigensystem at the rational point: \>\"", 
             ",", "timeComputingEigensystem"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"eigenvalues", "=", 
          RowBox[{"First", "[", "eigensystem", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvectors", "=", 
          RowBox[{"Last", "[", "eigensystem", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "6"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Eigenvalues at close rational point:\\n\>\"", ",", 
             "eigenvalues"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to eigenvalues at close rational \
point:\\n\>\"", ",", 
             RowBox[{"N", "[", 
              RowBox[{"eigenvalues", ",", "4"}], "]"}]}], "]"}]}], "]"}], ";",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "6"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Eigenvectors at close rational point (in rows):\\n\>\"", ",", 
             RowBox[{"MatrixForm", "@", "eigenvectors"}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "5"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to eigenvectors at close rational \
point (in rows):\\n\>\"", ",", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"N", "[", 
               RowBox[{"eigenvectors", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "eigenvectors", "]"}], "\[NotEqual]", 
            "n"}], ",", 
           RowBox[{"Print", "[", "\"\<\!\(\*
StyleBox[\"WARNING\",
FontVariations->{\"Underline\"->True}]\)\!\(\*
StyleBox[\"!\",
FontVariations->{\"Underline\"->True}]\) Number of eigenvectors \[NotEqual] \
Number of dimensions\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<Working with normalized approximations to the exact \
eigenvectors at the rational point, and tracing accuracy...\>\"", "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$MaxExtraPrecision", "=", "100"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Neigenvectors", "=", 
             RowBox[{"Map", "[", 
              RowBox[{"Normalize", ",", 
               RowBox[{"N", "[", 
                RowBox[{"eigenvectors", ",", " ", "40"}], "]"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"aux1", " ", "=", " ", 
             RowBox[{
              FractionBox["2", 
               RowBox[{"Abs", "[", 
                RowBox[{"Det", "[", "Neigenvectors", "]"}], "]"}]], 
              SuperscriptBox[
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"Total", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Abs", "[", "Neigenvectors", "]"}], ")"}], "^", 
                    "2"}], ",", "2"}], "]"}], "n"], ")"}], 
               FractionBox["n", "2"]]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"bound", " ", "=", " ", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"D", "[", 
                    RowBox[{"EM", ",", 
                    RowBox[{"{", "allvars", "}"}]}], "]"}], ")"}], ",", 
                   RowBox[{"{", "allvars", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "/.", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "\[Rule]", "1"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "\[Rule]", "1"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"aux2", " ", "=", " ", 
             RowBox[{"4", "*", "bound", " ", "*", " ", 
              RowBox[{"Total", "[", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"allvars", "/.", "closeRational"}], ",", "40"}], 
                  "]"}], "-", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"allvars", "/.", "interiorRestPoint"}], ",", 
                   "40"}], "]"}]}], "]"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tolerance", "=", 
             RowBox[{"n", " ", "aux1", "*", "aux2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "9"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<\!\(\*FractionBox[\(\(2\)\(\\\ \)\), \
\(\(|\)\(Det[Q]\)\(|\)\)]\)(\!\(\*FractionBox[\(\*UnderscriptBox[\(\[Sum]\), \
\(i, j\)]\(\(|\)\*SubscriptBox[\(Q\), \(ij\)]\*SuperscriptBox[\(|\), \(2\)]\)\
\), \(d\)]\)\!\(\*SuperscriptBox[\()\), FractionBox[\(d\), \(2\)]]\) =  \>\"",
                  ",", " ", "aux1", ",", " ", "\"\<;  Accuracy : \>\"", ",", 
                 " ", 
                 RowBox[{"Accuracy", "[", "aux1", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(Max\), \(i, j\)]\) \
\!\(\*UnderscriptBox[\(\[Sum]\), \
\(k\)]\)\!\(\*FractionBox[\(\*SuperscriptBox[\(\[PartialD]\), \
\(2\)]\*SubscriptBox[\(V\), \(i\)]\), \(\[PartialD]\*SubscriptBox[\(\[Xi]\), \
\(j\)] \[PartialD]\*SubscriptBox[\(\[Xi]\), \(k\)]\)]\) at \[Xi]=(1,...,1) = \
\>\"", ",", "bound"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<4 \!\(\*SubscriptBox[\(Max\), \(i, j\)]\) \
\!\(\*UnderscriptBox[\(\[Sum]\), \
\(k\)]\)\!\(\*FractionBox[\(\*SuperscriptBox[\(\[PartialD]\), \
\(2\)]\*SubscriptBox[\(V\), \(i\)]\), \(\[PartialD]\*SubscriptBox[\(\[Xi]\), \
\(j\)] \[PartialD]\*SubscriptBox[\(\[Xi]\), \(k\)]\)]\)\!\(\*SubscriptBox[\(|\
\), \((1,  ... , 1)\)]\) \!\(\*UnderscriptBox[\(\[Sum]\), \(k\)]\) \
|N[\!\(\*SubscriptBox[\(\[Xi]\), \(k\)]\),40] - N[\!\(\*SubsuperscriptBox[\(\
\[Xi]\), \(k\), \(*\)]\),40]| = \>\"", ",", "aux2", ",", " ", 
                 "\"\<;  Accuracy = \>\"", ",", " ", 
                 RowBox[{"Accuracy", "[", "aux2", "]"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Tolerance computed with perturbation theorem: \>\"", ",", 
             "tolerance"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Precision of tolerance: \>\"", ",", 
              RowBox[{"Precision", "[", "tolerance", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Accuracy of tolerance: \>\"", ",", 
              RowBox[{"Accuracy", "[", "tolerance", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Real Digits of tolerance: \>\"", ",", 
              RowBox[{"RealDigits", "[", "tolerance", "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"boundsEigenvalues", " ", "=", " ", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"Re", "[", "eigenvalues", "]"}], " ", ",", "6"}], "]"}], 
           "+", " ", "tolerance", "+", 
           RowBox[{"10", "^", 
            RowBox[{"-", 
             RowBox[{"Accuracy", "[", "tolerance", "]"}]}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The real part of the relevant eigenvalues at the interior \
rest point is no more than:\\n\>\"", ",", "boundsEigenvalues"}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"And", "@@", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "<", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"boundsEigenvalues", ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", "n"}], "]"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<All the relevant eigenvalues have strictly negative real \
part. Thus, we can conclude that the interior rest point is (locally) \
asymptotically stable\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "True", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<Some eigenvalue may have a positive real part. Thus, the \
local stability analysis is inconclusive\>\"", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<There is no interior rest point\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693123940611732*^9, 3.693123942309989*^9}, 
   3.693134579229377*^9, 3.69313461170756*^9, {3.696764552369035*^9, 
   3.696764561943048*^9}, 3.696828610369659*^9, {3.696946495908783*^9, 
   3.696946497077032*^9}, {3.696946952765254*^9, 3.69694695366282*^9}, {
   3.697566319992201*^9, 3.697566342098579*^9}, {3.697566586086954*^9, 
   3.6975665880557547`*^9}, {3.6975674272934933`*^9, 3.697567427562397*^9}, {
   3.697568143905817*^9, 3.6975681758318987`*^9}, {3.697568790472384*^9, 
   3.697568802194532*^9}, 3.697568967156713*^9, {3.697605178338138*^9, 
   3.697605217734125*^9}, {3.697826612217906*^9, 3.6978266126321163`*^9}, 
   3.698571000561255*^9, {3.698580090045847*^9, 3.698580163743224*^9}, {
   3.698767007072419*^9, 3.698767027000958*^9}, {3.7001906019196672`*^9, 
   3.700190603747678*^9}, {3.7001908552969303`*^9, 3.700190865112228*^9}, {
   3.7001909392802362`*^9, 3.7001910417219667`*^9}, {3.700191195250923*^9, 
   3.700191197348963*^9}, {3.700191278727839*^9, 3.70019127883491*^9}, {
   3.700191456646514*^9, 3.7001914875755453`*^9}, {3.700191631345999*^9, 
   3.700191632992771*^9}, {3.700191698166844*^9, 3.700191729270102*^9}, {
   3.700191761225913*^9, 3.700191771607531*^9}, {3.700192174321554*^9, 
   3.700192202309544*^9}, {3.7001940387370167`*^9, 3.700194224722588*^9}, {
   3.700194377852129*^9, 3.700194407508967*^9}, {3.700194615890184*^9, 
   3.700194650201769*^9}, {3.700194699364188*^9, 3.700194728542428*^9}, {
   3.70019476168997*^9, 3.7001948171140823`*^9}, {3.700194869759749*^9, 
   3.700194882021469*^9}, {3.700195055200398*^9, 3.7001951014165*^9}, {
   3.700195140298448*^9, 3.7001952987245293`*^9}, {3.700195361260902*^9, 
   3.7001953794285088`*^9}, {3.700195411450713*^9, 3.7001954261368856`*^9}, {
   3.700195460605823*^9, 3.7001954681141367`*^9}, {3.700195692811022*^9, 
   3.700195697841467*^9}, {3.700195781394085*^9, 3.7001957851114407`*^9}, {
   3.7001959139877653`*^9, 3.700195914823395*^9}, {3.700195953146968*^9, 
   3.700195979802286*^9}, {3.700196039786791*^9, 3.700196069352613*^9}, {
   3.700205339866588*^9, 3.70020534836495*^9}, {3.700205394985515*^9, 
   3.7002054148232927`*^9}, {3.700205596666955*^9, 3.700205697095381*^9}, {
   3.7002057535737*^9, 3.700205762002633*^9}, {3.7002058036389523`*^9, 
   3.700205849746344*^9}, {3.700205889894535*^9, 3.700205987913509*^9}, {
   3.700206021972896*^9, 3.700206178605164*^9}, {3.7002062606460943`*^9, 
   3.700206269716625*^9}, {3.700206426448998*^9, 3.700206439750455*^9}, 
   3.7003038469401503`*^9, {3.701500465650917*^9, 3.701500467068069*^9}, 
   3.7015010079062023`*^9, {3.701501214841956*^9, 3.701501222478916*^9}, {
   3.701501375765902*^9, 3.701501389103445*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "71f3c586-8ec3-49fe-903a-a7d8435bb841"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Global stability of interior rest point (exact Lyapunov function)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 
   3.6931346290431128`*^9},ExpressionUUID->"dea0ee0c-8cd9-417f-90b2-\
211bde3765f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GlobalStabilityOfInteriorRestPoint", "::", "usage"}], "=", 
    "\"\<GlobalStabilityOfInteriorRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\):precision ] analyzes the global stability of the \
interior rest point of the BEP dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). To \
conduct this analysis, the function uses the Euclidean distance to the exact \
interior rest point (or a reduced version of this distance, depending on the \
\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) used) as a tentative Lyapunov function. The \
computation of the exact interior rest point is performed by obtaining a Gr\
\[ODoubleDot]bner basis.\n\nThe function returns \!\(\*
StyleBox[\"True\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) if and only if the conducted \
analysis concludes that the interior rest point attracts all solutions (other \
than the backward induction solution, which is stationary). Otherwise it \
returns \!\(\*
StyleBox[\"False\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"prec\",
FontSlant->\"Italic\"]\) is an optional parameter, which determines the way \
some numbers are displayed (i.e. it has no effect on any important \
computation). It is an integer that controls the number of digits displayed \
in the messages that show numerical approximations to exact values. The \
default value is \!\(\*
StyleBox[\"precision\",
FontSlant->\"Italic\"]\), which is a global parameter set at the top of this \
notebook, in the cell \\\"General options\\\".\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GlobalStabilityOfInteriorRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorRestPointRules", ",", "interiorRestPoint", ",", 
       "reducedInteriorRestPoint", ",", "otherPointsWhereDerivativeEquals0", 
       ",", "xVector", ",", "yVector"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"y", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorRestPointRules", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"ExactRestPoints", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", "False", 
           ",", "False", ",", "verbosity", ",", "prec"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "/.", "#"}], ")"}], "\[NotEqual]",
             "1"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "interiorRestPointRules", "]"}], ">", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interiorRestPointRules", "=", 
          RowBox[{"First", "[", "interiorRestPointRules", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to interior exact solution: \\n\>\"",
              ",", " ", 
             RowBox[{"(", 
              RowBox[{"interiorRestPointRules", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"testSetRule", "\[Equal]", "\"\<two\>\""}], "&&", 
            RowBox[{"tieBreakingRule", "\[Equal]", "\"\<min\>\""}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Distance", " ", "to", " ", "interior", " ", "rest", " ", 
             "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"interiorRestPoint", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"xVector", ",", "yVector"}], "]"}], "/.", 
              "interiorRestPointRules"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Lyapunov function: euclidean distance to interior rest \
point, i.e. distance to:\\n\>\"", ",", " ", "interiorRestPointRules"}], "]"}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[Rule]", 
                   RowBox[{"N", "@", "interiorRestPoint"}]}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", 
                "\"\<Checking whether the derivative of the Lyapunov function \
is always different from zero (except at the rest points)...\>\"", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"otherPointsWhereDerivativeEquals0", "=", 
             RowBox[{"CylindricalDecomposition", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MeanDynamics", "[", 
                    RowBox[{
                    "testSetRule", ",", "tieBreakingRule", ",", "n", ",", 
                    "False", ",", "False", ",", "0"}], "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "-", 
                    "interiorRestPoint"}], ")"}]}], "\[Equal]", "0"}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"y", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Total", "[", "xVector", "]"}], "\[Equal]", "1"}],
                    ",", 
                   RowBox[{
                    RowBox[{"Total", "[", "yVector", "]"}], "\[Equal]", 
                    "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[NotEqual]",
                    "interiorRestPoint"}], "}"}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[NotEqual]", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"s1", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"s2", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"xVector", ",", "yVector"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Reduced", " ", "Distance", " ", "to", " ", "interior", " ", 
             "rest", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"reducedInteriorRestPoint", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "/.", 
              "interiorRestPointRules"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Lyapunov function: euclidean distance to interior rest \
point ignoring x[1] and y[1], i.e. distance to:\\n\>\"", ",", " ", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "\[Rule]",
                    "reducedInteriorRestPoint"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "\[Rule]", 
                   RowBox[{"N", "@", "reducedInteriorRestPoint"}]}], "]"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", 
                "\"\<Checking whether the derivative of the Lyapunov function \
is always different from zero (except at the rest points)...\>\"", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"otherPointsWhereDerivativeEquals0", "=", 
             RowBox[{"CylindricalDecomposition", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MeanDynamicsWithoutFirstVariables", "[", 
                    RowBox[{
                    "testSetRule", ",", "tieBreakingRule", ",", "n", ",", 
                    "False", ",", "0"}], "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "-", 
                    "reducedInteriorRestPoint"}], ")"}]}], "\[Equal]", "0"}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"y", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], 
                    "\[LessEqual]", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}], 
                    "\[LessEqual]", "1"}]}], "}"}], ","}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], 
                   "\[NotEqual]", "reducedInteriorRestPoint"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], 
                   "\[NotEqual]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", "n"}], "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                 RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}]}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"otherPointsWhereDerivativeEquals0", "===", "False"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<The derivative of the Lyapunov function is always \
different from zero (except at the rest points)\>\"", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", 
             "\"\<The interior point is almost globally asymptotically stable\
\>\"", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "True", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<There are other points where the derivative of the \
Lyapunov function equals 0:\\n\>\"", ",", 
                 "otherPointsWhereDerivativeEquals0"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"N", "@", "otherPointsWhereDerivativeEquals0"}]}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", "\"\<Global stability analysis is inconclusive\>\"",
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<There is no interior rest point\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.696828611348506*^9, 3.6968286134972343`*^9}, {
   3.697566369874991*^9, 3.6975663820697002`*^9}, {3.6975674373286963`*^9, 
   3.6975674627988033`*^9}, {3.698571050041506*^9, 3.698571077395574*^9}, {
   3.69857119266982*^9, 3.698571274477426*^9}, {3.698577491299317*^9, 
   3.698577492217358*^9}, {3.69857769256465*^9, 3.698577720925242*^9}, {
   3.698580185393664*^9, 3.6985802188235617`*^9}, {3.698767035766108*^9, 
   3.698767051310917*^9}, {3.700207751126247*^9, 3.700207848074394*^9}, {
   3.7002078885243797`*^9, 3.700207965156487*^9}, {3.700208094029716*^9, 
   3.700208147252616*^9}, {3.7002082033443203`*^9, 3.700208218275858*^9}, {
   3.700208263097587*^9, 3.700208276236389*^9}, {3.7015004681577387`*^9, 
   3.701500469721587*^9}, 3.70150101018886*^9, 3.7015012421990557`*^9, {
   3.701501275500456*^9, 3.70150128523111*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "2b651595-f338-40b9-a1d5-41518a1d1265"]
}, Closed]],

Cell[CellGroupData[{

Cell["Initial conditions (RandomPoints and MeshPoints)", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.6935481457963953`*^9, 3.693548153805209*^9}, 3.6935484636113663`*^9, {
   3.6967558852074213`*^9, 
   3.696755908028101*^9}},ExpressionUUID->"3c94bdab-101e-4ea8-954f-\
837729b157b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomPoints", "::", "usage"}], "=", "\"\<RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] returns a list of \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\) random points for a Centipede game of length \
d\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomPoints", "[", 
     RowBox[{"n_", ",", "nPoints_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Total", "[", "#", "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"1", ",", "s1"}], "]"}], ",", "nPoints"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Total", "[", "#", "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"1", ",", "s2"}], "]"}], ",", "nPoints"}], "]"}]}], 
           "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplexMesh", "::", "usage"}], "=", "\"\<SimplexMesh[\!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)] returns a list of all the possible strategy \
distributions in a population of \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\) agents who can choose one of \!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\) possible strategies. The number of possible \
distributions is Binomial[\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)+\!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\)-1, \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimplexMesh", "[", 
     RowBox[{"nStrategies_", ",", "nAgents_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Permutations", "/@", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"nAgents", ",", 
          RowBox[{"{", "nStrategies", "}"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "nAgents"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
      "/", 
     RowBox[{"N", "@", "nAgents"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeshPoints", "::", "usage"}], "=", "\"\<MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)] returns a list of all the possible states in a \
Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)with \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\) agents in each population. The number of possible \
distributions is Binomial[\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)+ \!\(\*
StyleBox[\"IntegerPart\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"[\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"(\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"+\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"3\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\")\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"/\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"2\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)- 1, \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"*\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)Binomial[\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)+ \!\(\*
StyleBox[\"IntegerPart\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"[\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"(\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"+\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"2\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\")\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"/\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"2\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)- 1, \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeshPoints", "[", 
    RowBox[{"n_", ",", "nAgentsPerPopulation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Join", ",", 
         RowBox[{"SimplexMesh", "[", 
          RowBox[{"s1", ",", "nAgentsPerPopulation"}], "]"}], ",", 
         RowBox[{"SimplexMesh", "[", 
          RowBox[{"s2", ",", "nAgentsPerPopulation"}], "]"}], ",", "1"}], 
        "]"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693548160511352*^9, 3.693548453958748*^9}, 
   3.693574850326124*^9, {3.693574883164336*^9, 3.693574991615878*^9}, {
   3.693575023375538*^9, 3.693575063787862*^9}, {3.693575123220561*^9, 
   3.6935752039380827`*^9}, {3.693576077465584*^9, 3.693576295087234*^9}, {
   3.6968264325108232`*^9, 3.696826460635049*^9}, {3.7002100565844917`*^9, 
   3.700210064774343*^9}, {3.700210097005746*^9, 3.7002101466037683`*^9}, {
   3.701500475872697*^9, 3.701500477346527*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "a4367b14-d13a-4ff4-9e7d-07e41b41b398"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Numerical global stability of interior rest point (numerical evaluation of an \
approximate Lyapunov function)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}},ExpressionUUID->"5fff5317-0f27-4699-8ff3-\
5bd42c3fe345"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "NumericalGlobalStabilityOfInteriorRestPointLyapunov", "::", "usage"}], 
    "=", "\"\<NumericalGlobalStabilityOfInteriorRestPointLyapunov[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"points\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\):10^5 ] analyses the global stability of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). \
This function uses the Euclidean distance to the interior rest point computed \
using \!\(\*
StyleBox[\"FloatingPointApproximateRestPoint\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)as a tentative Lyapunov function. Specifically, the \
function numerically evaluates the derivative of the tentative Lyapunov \
function at each of the points provided by the user (as fourth parameter, \
called \!\(\*
StyleBox[\"points\",
FontSlant->\"Italic\"]\) above), using (IEEE 754) floating-point arithmetic.\n\
\nYou can create the list of points required as fourth parameter by using the \
functions RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] and MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)]. Thus, for example, to run the function on \
\!\(\*SuperscriptBox[\(10\), \(6\)]\) random points, you can evaluate:\n\n\
\\tNumericalGlobalStabilityOfInteriorRestPointLyapunov[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),\!\(\*SuperscriptBox[\(10\), \(6\)]\)] ]\n\n\\tAnd \
to run the function on a grid with mesh 1/4, you can evaluate:\n\n\
\\tNumericalGlobalStabilityOfInteriorRestPointLyapunov[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),4] ]\n\nThe function returns the list of points with \
a non-negative evaluation of the derivative of the tentative Lyapunov \
function. Thus, if the function returns an empty list, it means that the \
derivative of the tentative Lyapunov function was strictly negative in all \
evaluated points. \n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"points\",
FontSlant->\"Italic\"]\) is the list of points at which the derivative of the \
tentative Lyapunov function will be evaluated. Each point must be a list \
containing \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2 numbers. You can use the functions RandomPoints[\
\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] and MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)] to create this list.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\) is an optional parameter. For efficiency reasons, \
the list of points provided by the user is partitioned into several packs, \
each containing \!\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\) points. Each of these packs is sent to one kernel \
(up to the number of cores in the computer) and computed in parallel.\>\""}], 
   " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "::", 
     StyleBox["invalidValueOf_points",
      FontSlant->"Italic"]}], "=", "\"\<the parameter \!\(\*
StyleBox[\"points\",
FontSlant->\"Italic\"]\) in \
NumericalGlobalStabilityOfInteriorRestPointLyapunov[testSetRule, \
tieBreakingRule, \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"points\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)] must be a list of points. Each \
point should be a list containing (\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2) numbers. `1` is not a valid list of \
points.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     StyleBox["points_",
      FontSlant->"Italic"], ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"samplesPerPack_:", 
      RowBox[{"10", "^", "5"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorFPRestPoint", ",", "vars", ",", "packs", ",", "CompiledVdot", 
       ",", "valuesOfVdot", ",", "pos", ",", 
       RowBox[{"nonNegativeValuePoints", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"p", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"First", ",", " ", 
       RowBox[{
       "check", " ", "that", " ", "the", " ", "list", " ", "of", " ", 
        "points", " ", "is", " ", "fine"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "\[NotEqual]", 
              RowBox[{"n", "+", "2"}]}], ")"}], "&"}], ",", 
           StyleBox["points",
            FontSlant->"Italic"]}], "]"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{
            "NumericalGlobalStabilityOfInteriorRestPointLyapunov", "::", 
             "invalidValueOf_points"}], ",", 
            StyleBox["points",
             FontSlant->"Italic"]}], "]"}], ";", 
          RowBox[{
          "Print", "[", "\"\<Error reading the list of points\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorFPRestPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Numerical (floating-point) approximation to interior exact \
solution: \\n\>\"", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "\[Rule]", "interiorFPRestPoint"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"packs", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         StyleBox["points",
          FontSlant->"Italic"], ",", 
         RowBox[{"UpTo", "[", "samplesPerPack", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Distance", " ", "to", " ", "interior", " ", "rest", " ", "point"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Lyapunov function: Euclidean distance to (floating-point \
approximation to) the interior rest point.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We now evaluate the derivative of the Lyapunov function at \
\>\"", ",", " ", 
           RowBox[{"Length", "[", 
            StyleBox["points",
             FontSlant->"Italic"], "]"}], ",", " ", 
           "\"\< points using (IEEE 754) floating-point arithmetic, in packs \
of up to \>\"", ",", "samplesPerPack", ",", "\"\< points.\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CompiledVdot", "=", 
       RowBox[{"Compile", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"MeanDynamics", "[", 
            RowBox[{
            "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
             "False", ",", "False", ",", "0"}], "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"vars", "-", "interiorFPRestPoint"}], ")"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"pack", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"valuesOfVdot", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"CompiledVdot", "@@", "#"}], ")"}], "&"}], ",", 
              "pack"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Pack \>\"", ",", " ", "p", ",", 
                "\"\<; Size of pack: \>\"", ",", " ", 
                RowBox[{"Length", "@", "pack"}]}], "]"}], ";", 
              RowBox[{"p", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tFirst \>\"", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"Length", "[", "pack", "]"}]}], "]"}], ",", 
                "\"\< points in pack:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"pack", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t... and their values of Vdot:\\t\>\"", ",", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"valuesOfVdot", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"valuesOfVdot", ",", 
              RowBox[{"_", "?", "NonNegative"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pos", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<\\tNonnegative values of vdot found at: \>\"", "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<\\t\\tPoints: \>\"", ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<\\t\\tValues: \>\"", ",", 
                   RowBox[{"Extract", "[", 
                    RowBox[{"valuesOfVdot", ",", "pos"}], "]"}]}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nonNegativeValuePoints", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"nonNegativeValuePoints", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                   RowBox[{"Extract", "[", 
                    RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
                RowBox[{
                "Print", "[", 
                 "\"\<\\tAll values in the pack are negative\>\"", "]"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"valuesOfVdot", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", 
                RowBox[{"-", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "15"}]}]}]}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pos", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<\\n\\tValues of vdot greater than \
-\!\(\*SuperscriptBox[\(10\), \(-15\)]\) found at: \>\"", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<\\t\\tPoints: \>\"", ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<\\t\\tValues: \>\"", ",", 
                   RowBox[{"Extract", "[", 
                    RowBox[{"valuesOfVdot", ",", "pos"}], "]"}]}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
                RowBox[{
                "Print", "[", 
                 "\"\<\\n\\tAll values are below \
-\!\(\*SuperscriptBox[\(10\), \(-15\)]\)\\n\>\"", "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "packs"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "nonNegativeValuePoints", "]"}], ">", 
            "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<Below you can see the points we have found where the \
derivative of the Lyapunov function is non-negative. If you can see other \
points besides the \\\"stop-immediately\\\" rest point, that means that the \
chosen function is not a Lyapunov function. Alternatively, if there are no \
points below, or if the only point below is the \\\"stop-immediately\\\" rest \
point, then this means that we have not found numerical evidence that \
contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation would suggest that \
the interior rest point might be almost globally asymptotically stable.\>\"", 
             "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<The derivative of the Lyapunov function is negative in all \
evaluated points.\\nWe have evaluated \>\"", ",", 
              RowBox[{"Length", "[", 
               StyleBox["points",
                FontSlant->"Italic"], "]"}], ",", 
              "\"\< points and we have not found numerical evidence that \
contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation suggests that the \
interior rest point might be almost globally asymptotically stable\>\""}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "nonNegativeValuePoints"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547839490122*^9, 3.693547842989127*^9}, 
   3.6935478812397327`*^9, {3.693548487373272*^9, 3.693548488599038*^9}, {
   3.6935485938789053`*^9, 3.693548796999235*^9}, {3.693548837095186*^9, 
   3.693548869978437*^9}, {3.69354893253012*^9, 3.6935489619596567`*^9}, {
   3.6935490188515472`*^9, 3.693549086972417*^9}, 3.693549188391201*^9, {
   3.693549351090857*^9, 3.693549351201787*^9}, {3.693549448967774*^9, 
   3.693549449967637*^9}, {3.693549487047615*^9, 3.6935494876095877`*^9}, {
   3.693549523982626*^9, 3.693549524937772*^9}, {3.693549651569436*^9, 
   3.6935496584090967`*^9}, {3.69355086174575*^9, 3.6935508653106728`*^9}, {
   3.693551158466208*^9, 3.693551160154084*^9}, {3.693551194410965*^9, 
   3.693551274354513*^9}, {3.693552474968545*^9, 3.693552476565979*^9}, {
   3.6935525121495037`*^9, 3.6935525154336863`*^9}, {3.693559435220812*^9, 
   3.6935595965915956`*^9}, {3.6935596310636797`*^9, 3.693559664114852*^9}, 
   3.6968286143407507`*^9, {3.6975670124664803`*^9, 3.697567013028245*^9}, 
   3.6985713080082283`*^9, {3.6985802516187267`*^9, 3.69858026079561*^9}, {
   3.69873309073809*^9, 3.6987331258129883`*^9}, {3.700141138442233*^9, 
   3.70014114869107*^9}, {3.700141182204686*^9, 3.700141219140543*^9}, {
   3.7001422099931507`*^9, 3.700142272375002*^9}, {3.700143331293694*^9, 
   3.7001433639851303`*^9}, {3.700143433309331*^9, 3.7001438825266123`*^9}, {
   3.700143928146172*^9, 3.700144040961691*^9}, {3.7001440893839684`*^9, 
   3.700144141492228*^9}, {3.700210209028759*^9, 3.7002102101100903`*^9}, {
   3.7002155428369007`*^9, 3.700215562086979*^9}, {3.7002156464406424`*^9, 
   3.7002156527969227`*^9}, {3.700215684333021*^9, 3.7002158250388393`*^9}, {
   3.700216445354175*^9, 3.700216445696219*^9}, {3.7002166508262463`*^9, 
   3.7002166511845713`*^9}, 3.700217397404954*^9, {3.7002927292676764`*^9, 
   3.700292741810626*^9}, 3.701498711782158*^9, {3.701500488983156*^9, 
   3.7015004930320787`*^9}, 3.701501015420537*^9, {3.701522150354048*^9, 
   3.701522245030851*^9}, {3.701522276171709*^9, 3.701522558276813*^9}, {
   3.701522643826792*^9, 3.701522687474633*^9}, {3.701522838789741*^9, 
   3.701522847279513*^9}, {3.701522895014895*^9, 3.701522917558978*^9}, {
   3.701522968108387*^9, 3.701522968701797*^9}, {3.701523000858242*^9, 
   3.70152300391463*^9}, {3.701523039940432*^9, 3.701523065891173*^9}, {
   3.701523231044495*^9, 3.70152323140247*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "b2c2fb22-6e42-4220-8464-04d0f0df3c52"]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical global stability of interior rest point (NDSolve)", \
"Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}, {3.693547818767255*^9, 
   3.693547820801915*^9}},ExpressionUUID->"51dfba0a-20f4-4ad9-8192-\
c5e8f39094c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "NumericalGlobalStabilityOfInteriorRestPointNDSolve", "::", "usage"}], 
    "=", "\"\<NumericalGlobalStabilityOfInteriorRestPointNDSolve[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"initialPoints\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 , \!\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\):10^3,\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\):200, \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\):10.^-4, \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\):6 ] analyses the global stability of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). \
This function numerically integrates the mean dynamics (using NDSolve) \
starting at each of the initial points provided by the user (as fourth \
parameter, called \!\(\*
StyleBox[\"initialPoints\",
FontSlant->\"Italic\"]\) above), and checks whether the final point of the \
computed trajectory is close to the interior fixed point (computed using \!\(\*
StyleBox[\"FloatingPointApproximateRestPoint\",
FontSlant->\"Italic\"]\)).\n\nYou can create the list of initial points \
required as fourth parameter by using the functions RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] and MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)]. Thus, for example, to run the function on \
\!\(\*SuperscriptBox[\(10\), \(6\)]\) random initial points, you can \
evaluate:\n\n\\tNumericalGlobalStabilityOfInteriorRestPointNDSolve[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),\!\(\*SuperscriptBox[\(10\), \(6\)]\)] ]\n\n\\tAnd \
to run the function on a grid with mesh 1/4, you can evaluate:\n\n\
\\tNumericalGlobalStabilityOfInteriorRestPointNDSolve[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),4] ]\n\nThe function returns the list of initial \
points that did not lead to the vicinity of the interior rest point computed \
using \!\(\*
StyleBox[\"FloatingPointApproximateRestPoint\",
FontSlant->\"Italic\"]\). Thus, if the function returns an empty list, it \
means that all computed trajectories (as many as initial points provided by \
the user) ended close to the interior rest point computed using \!\(\*
StyleBox[\"FloatingPointApproximateRestPoint\",
FontSlant->\"Italic\"]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"initialPoints\",
FontSlant->\"Italic\"]\) is the list of initial points. Each initial point \
must be a list containing \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2 numbers. You can use the functions RandomPoints[\
\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] and MeshPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)] to create this list.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\) is an optional parameter. For efficiency reasons, \
the list of initial points provided by the user is partitioned into several \
packs, each containing \!\(\*
StyleBox[\"samplesPerPack\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)initial points. Each of these packs is sent to one \
kernel (up to the number of cores in the computer) and computed in parallel. \
\n- \!\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\) is an optional parameter. It indicates the maximum \
final time used when integrating the mean dynamics using NDSolve.\n- \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\) is an optional parameter. The integration of the \
mean dynamics will stop if the norm of the difference between the last point \
in the computed trajectory and the interior rest point computed using \!\(\*
StyleBox[\"FloatingPointApproximateRestPoint\",
FontSlant->\"Italic\"]\) is less than the \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\).\n- \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\) is an optional parameter, which indicates the \
AccuracyGoal used in NDSolve.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NumericalGlobalStabilityOfInteriorRestPointNDSolve", "::", 
     StyleBox[
      RowBox[{"invalidValueOf_", 
       StyleBox["initialPoints",
        FontSlant->"Italic"]}]]}], "=", "\"\<the parameter \!\(\*
StyleBox[\"initialPoints\",
FontSlant->\"Italic\"]\) in \
NumericalGlobalStabilityOfInteriorRestPointNDSolve[testSetRule, \
tieBreakingRule, \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"initialPoints\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)] must be a list of initial points. \
Each initial point should be a list containing (\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2) numbers. `1` is not a valid list of initial \
points.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NumericalGlobalStabilityOfInteriorRestPointNDSolve", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     StyleBox["initialPoints_",
      FontSlant->"Italic"], ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"samplesPerPack_:", 
      RowBox[{"10", "^", "3"}]}], ",", 
     RowBox[{"time_:", "300"}], ",", 
     RowBox[{"tolerance_:", 
      RowBox[{"10.", "^", 
       RowBox[{"-", "4"}]}]}], ",", 
     RowBox[{"accuracyGoal_:", "6"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorFPRestPoint", ",", "vars", ",", "rulesToAddt", ",", 
       "varsWitht", ",", "packs", ",", "Dvars", ",", "projectedEM", ",", 
       RowBox[{"p", "=", "1"}], ",", "FinalPoint", ",", "finalPoints", ",", 
       RowBox[{"problematicPoints", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"First", ",", " ", 
       RowBox[{
       "check", " ", "that", " ", "the", " ", "list", " ", "of", " ", 
        "initial", " ", "points", " ", "is", " ", "fine"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "\[NotEqual]", 
              RowBox[{"n", "+", "2"}]}], ")"}], "&"}], ",", 
           StyleBox["initialPoints",
            FontSlant->"Italic"]}], "]"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"NumericalGlobalStabilityOfInteriorRestPointNDSolve", "::", 
             StyleBox[
              RowBox[{"invalidValueOf_", 
               StyleBox["initialPoints",
                FontSlant->"Italic"]}]]}], ",", 
            StyleBox["initialPoints",
             FontSlant->"Italic"]}], "]"}], ";", 
          RowBox[{
          "Print", "[", "\"\<Error reading the list of initial points\>\"", 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"SetSharedVariable", "[", "problematicPoints", "]"}], ";", " ", 
      
      RowBox[{"(*", 
       RowBox[{"So", " ", "we", " ", "can", " ", "use", " ", "ParallelMap"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varsWitht", "=", 
       RowBox[{"vars", "/.", "rulesToAddt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorFPRestPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Numerical (floating-point) approximation to interior exact \
solution: \\n\>\"", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "\[Rule]", "interiorFPRestPoint"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"projectedEM", "=", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s1"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}], ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s2"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
          "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MeanDynamics", "[", 
           RowBox[{
           "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "False", ",",
             "False", ",", "0"}], "]"}], "/.", "rulesToAddt"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"packs", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         StyleBox["initialPoints",
          FontSlant->"Italic"], ",", 
         RowBox[{"UpTo", "[", "samplesPerPack", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "NDSolve", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We now solve the differential equation numerically (with \
NDSolve), starting at each of the \>\"", ",", " ", 
           RowBox[{"Length", "[", 
            StyleBox["initialPoints",
             FontSlant->"Italic"], "]"}], ",", " ", 
           "\"\< points provided, in packs of up to \>\"", ",", 
           "samplesPerPack", ",", "\"\< points.\>\""}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FinalPoint", "[", "initialPoint_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"finalTime", "=", "time"}], ",", "sol"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sol", "=", 
           RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"Dvars", "\[Equal]", "projectedEM"}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"varsWitht", "/.", 
                   RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "==", 
                 "initialPoint"}], "]"}], ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"varsWitht", "-", "interiorFPRestPoint"}], "]"}], 
                   "<", "tolerance"}], "]"}], ",", " ", 
                 RowBox[{"\"\<StopIntegration\>\"", ";", 
                  RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "vars", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "time"}], "}"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Another", " ", "approach", " ", "would", " ", 
            RowBox[{"be", ":", " ", "\[IndentingNewLine]", 
             RowBox[{"WhenEvent", "[", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{
                 RowBox[{"Norm", "[", "Dvars", "]"}], "<", "tolerance"}], 
                "]"}], ",", " ", 
               RowBox[{"\"\<StopIntegration\>\"", ";", 
                RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}]}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verbosity", "\[GreaterEqual]", "10"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Evaluate", "@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{"Tooltip", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", "sol"}], "]"}], 
                    ",", "vars"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], "]"}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"finalTime", "\[GreaterEqual]", "time"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Fixed point not reached:\\n\\t\>\"", ",", "initialPoint", 
               ",", "\"\<\\n\\t-> \>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
                "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"problematicPoints", ",", 
               RowBox[{"initialPoint", "\[Rule]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
                 "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"pack", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"finalPoints", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{"FinalPoint", ",", "pack"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"If", " ", "you", " ", "want", " ", "graphics"}], ",", 
             " ", 
             RowBox[{
             "you", " ", "need", " ", "to", " ", "replace", " ", 
              "ParallelMap", " ", "with", " ", "Map"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Pack \>\"", ",", " ", "p", ",", 
                "\"\<; Size of pack: \>\"", ",", " ", 
                RowBox[{"Length", "@", "pack"}]}], "]"}], ";", 
              RowBox[{"p", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tFirst \>\"", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"Length", "[", "pack", "]"}]}], "]"}], ",", 
                "\"\< initial points in pack:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"pack", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\\t... and their corresponding final points:\\t\>\"", ",", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"finalPoints", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tProblematic points so far:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", "problematicPoints", "]"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", "packs"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "problematicPoints", "]"}], ">", "0"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<We have found initial points that did not lead to the \
proximities of the interior rest point. The following are the problematic \
initial conditions and their corresponding end points. If you can see other \
points beside the \\\"stop-immediately\\\" initial condition, you may want to \
try again starting at the problematic initial conditions, and using a greater \
value of time and/or a greater value of tolerance.\\n\>\"", ",", 
              "problematicPoints"}], "]"}], ";"}], "\[IndentingNewLine]", ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<All initial points evaluated led to the proximities of the \
interior rest point.\\nWe have evaluated \>\"", ",", 
              RowBox[{"Length", "[", 
               StyleBox["initialPoints",
                FontSlant->"Italic"], "]"}], ",", 
              "\"\< initial points and we have not found numerical evidence \
that contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation suggests that the \
interior rest point might be almost globally asymptotically stable\>\""}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "problematicPoints"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547870609191*^9, 3.693547876840765*^9}, {
   3.693549311547332*^9, 3.693549311635388*^9}, {3.693549416441812*^9, 
   3.693549431000176*^9}, {3.693549678314641*^9, 3.693549684555966*^9}, {
   3.693549725472664*^9, 3.6935497380601587`*^9}, {3.693549774658777*^9, 
   3.693549884615756*^9}, {3.693549935084861*^9, 3.693550159345563*^9}, {
   3.6935501900133963`*^9, 3.6935502047604303`*^9}, {3.693550826467147*^9, 
   3.6935508380755157`*^9}, {3.693550875056007*^9, 3.6935510718406467`*^9}, {
   3.693551306947064*^9, 3.693551314888282*^9}, {3.693551369351716*^9, 
   3.6935514829989223`*^9}, {3.6935515754880238`*^9, 3.693551587602271*^9}, {
   3.693551778113003*^9, 3.693551784648252*^9}, {3.693551896430581*^9, 
   3.693551896621065*^9}, {3.693552009392975*^9, 3.6935520106744537`*^9}, {
   3.693552076071445*^9, 3.693552082382131*^9}, {3.693552190677342*^9, 
   3.6935521924424133`*^9}, {3.693552374064519*^9, 3.693552385159031*^9}, {
   3.6935524365828447`*^9, 3.693552456012289*^9}, {3.693552495342204*^9, 
   3.69355250069598*^9}, {3.693552564608667*^9, 3.693552591214561*^9}, {
   3.693552637522148*^9, 3.69355265384328*^9}, {3.693552720658547*^9, 
   3.693552746308487*^9}, {3.6935527768421803`*^9, 3.693552797754736*^9}, {
   3.6935530058382397`*^9, 3.693553054966484*^9}, {3.693553091497259*^9, 
   3.693553091912405*^9}, {3.6935567557935743`*^9, 3.6935567709909763`*^9}, {
   3.6935593472127132`*^9, 3.6935594054084167`*^9}, 3.693568766414254*^9, {
   3.693569059636038*^9, 3.69356910626648*^9}, {3.693574565047756*^9, 
   3.693574568927229*^9}, {3.693934190497493*^9, 3.693934208719932*^9}, {
   3.69393437710388*^9, 3.693934399119731*^9}, {3.693935983654544*^9, 
   3.693935997152545*^9}, 3.696828617704845*^9, {3.697481867004352*^9, 
   3.697481905556364*^9}, {3.6975671196143007`*^9, 3.697567119882341*^9}, 
   3.69857132341074*^9, {3.698580309261578*^9, 3.698580354929379*^9}, {
   3.7001378254796658`*^9, 3.700137900695045*^9}, {3.70013880882627*^9, 
   3.700138814956841*^9}, {3.700138988061576*^9, 3.7001389993007193`*^9}, {
   3.700139066272275*^9, 3.7001391368237762`*^9}, {3.700139206675775*^9, 
   3.700139260899844*^9}, {3.700139335062079*^9, 3.700139343204884*^9}, {
   3.7001393760456667`*^9, 3.700139390658722*^9}, {3.700139682567129*^9, 
   3.7001396896540413`*^9}, {3.700139881344523*^9, 3.700139909431468*^9}, {
   3.700139970614417*^9, 3.700139979480987*^9}, {3.70014002712403*^9, 
   3.700140123716127*^9}, {3.700140263658022*^9, 3.7001403602383947`*^9}, {
   3.70014044829489*^9, 3.700140505759252*^9}, {3.700140547992406*^9, 
   3.700140552525237*^9}, {3.700140622109604*^9, 3.700140661853759*^9}, {
   3.7001407305951233`*^9, 3.700140821819723*^9}, {3.70014088146938*^9, 
   3.700140902820219*^9}, 3.700141195595241*^9, {3.700141310965332*^9, 
   3.700141311041032*^9}, {3.70014138544064*^9, 3.7001415585100517`*^9}, {
   3.700141603017383*^9, 3.700142063044754*^9}, {3.700142164386574*^9, 
   3.700142192748103*^9}, {3.7001422821753283`*^9, 3.700142297295513*^9}, {
   3.700142381176879*^9, 3.7001424374483013`*^9}, {3.700142505590515*^9, 
   3.700142509504765*^9}, 3.7001425698762007`*^9, {3.700142606752245*^9, 
   3.7001427641282787`*^9}, {3.700142807487232*^9, 3.7001429074774437`*^9}, {
   3.700142943862938*^9, 3.700143161100099*^9}, {3.700143248864954*^9, 
   3.7001432681894493`*^9}, {3.700143300484159*^9, 3.700143302559449*^9}, {
   3.7002102259755373`*^9, 3.7002102264808702`*^9}, {3.700215878429797*^9, 
   3.700215882796585*^9}, {3.700215919116027*^9, 3.7002159238083763`*^9}, {
   3.7002927722776012`*^9, 3.700292785978939*^9}, 3.700292934719528*^9, {
   3.701088591866173*^9, 3.701088618325677*^9}, {3.70150049790416*^9, 
   3.7015005016958437`*^9}, 3.701500713266591*^9, 3.7015007535860653`*^9, 
   3.701501023105448*^9, {3.7015231026263866`*^9, 3.701523170866694*^9}, {
   3.701523216827087*^9, 3.701523217306535*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "66820d2c-f57a-4fd4-b57b-7128969015a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerically solve mean dynamics", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}, {3.693547818767255*^9, 3.693547820801915*^9}, {
   3.693934271832981*^9, 3.6939342864229116`*^9}, {3.693935338063829*^9, 
   3.693935340399613*^9}, {3.696828491828691*^9, 
   3.6968284954268513`*^9}},ExpressionUUID->"6dcca70e-3035-4ac9-8adb-\
a747bdd929aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NDSolveMeanDynamics", "::", "usage"}], "=", 
    "\"\<NDSolveMeanDynamics[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\":\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"RandomPoint\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 , \!\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\):300, \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\):10.^-4, \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\):6 ] numerically integrates the BEP dynamics for a \
Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). The \
numerical integration is conducted using NDSolve (a \!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) function), starting at the initial point provided by \
the user (as fourth parameter, called \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) above), or at a random initial point if the user \
does not provide one.\n\nThe function returns a list of the form {\!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"solution\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"finalPoint\",
FontSlant->\"Italic\"]\)}, where:\n- \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) is the initial point used for the integration.\n- \!\
\(\*
StyleBox[\"solution\",
FontSlant->\"Italic\"]\) is the solution of the integration (i.e. a list of \
interpolationg functions). \n- \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\) is the greatest time for which the dynamics have \
been integrated. \n- \!\(\*
StyleBox[\"finalPoint\",
FontSlant->\"Italic\"]\) is the last point in the computed trajectory (i.e. \
the solution evaluated at \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\)).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) is an optional parameter. It is the initial point, \
provided as a list containing \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2 numbers. If this parameter is not provided, the \
function takes a random initial point using RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), 1].\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\) is an optional parameter. It indicates the maximum \
final time used when integrating the mean dynamics using NDSolve. If the norm \
of the mean dynamics gets sufficiently small, then the integration stops (see \
below).\n- \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\) is an optional parameter. The integration of the \
mean dynamics will stop if the norm of the mean dynamics is less than the \
\!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\).\n- \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\) is an optional parameter, which indicates the \
AccuracyGoal used in NDSolve.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NDSolveMeanDynamics", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{
      StyleBox["ip_:",
       FontSlant->"Italic"], 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"maxTime_:", "300"}], ",", 
     RowBox[{"tolerance_:", 
      RowBox[{"10.", "^", 
       RowBox[{"-", "4"}]}]}], ",", 
     RowBox[{"accuracyGoal_:", "6"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "vars", 
       ",", "rulesToAddt", ",", "varsWitht", ",", "Dvars", ",", "projectedEM",
        ",", "sol", ",", "finalTime", ",", "initialPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         StyleBox["ip",
          FontSlant->"Italic"], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"initialPoint", "=", 
         RowBox[{"First", "[", 
          RowBox[{"RandomPoints", "[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"initialPoint", "=", 
         StyleBox["ip",
          FontSlant->"Italic"]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varsWitht", "=", 
       RowBox[{"vars", "/.", "rulesToAddt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"projectedEM", "=", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s1"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}], ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s2"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
          "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"MeanDynamics", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "False", ",", 
           "False", ",", 
           RowBox[{"verbosity", "-", "1"}]}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "NDSolve", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We solve the differential equation numerically (with NDSolve), \
starting at the initial point: \>\"", ",", " ", "initialPoint"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"finalTime", "=", "maxTime"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"Dvars", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"projectedEM", "/.", "rulesToAddt"}], ")"}]}], "]"}], 
           ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"varsWitht", "/.", 
               RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "==", "initialPoint"}],
             "]"}], ",", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"Norm", "[", "Dvars", "]"}], "<", "tolerance"}], "]"}],
              ",", " ", 
             RowBox[{"\"\<StopIntegration\>\"", ";", 
              RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "vars", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Tooltip", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "&"}], ",", "sol"}], "]"}], 
                ",", "vars"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "@", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", "s1"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<First mover\>\""}], ",", 
                
                RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "}"}]}],
                   "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<Second mover\>\""}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\"\<                \>\"", 
            ",", " ", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "15"}], ",", 
            RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"initialPoint", ",", "sol", ",", "finalTime", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], "]"}]}],
        "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547870609191*^9, 3.693547876840765*^9}, {
   3.693549311547332*^9, 3.693549311635388*^9}, {3.693549416441812*^9, 
   3.693549431000176*^9}, {3.693549678314641*^9, 3.693549684555966*^9}, {
   3.693549725472664*^9, 3.6935497380601587`*^9}, {3.693549774658777*^9, 
   3.693549884615756*^9}, {3.693549935084861*^9, 3.693550159345563*^9}, {
   3.6935501900133963`*^9, 3.6935502047604303`*^9}, {3.693550826467147*^9, 
   3.6935508380755157`*^9}, {3.693550875056007*^9, 3.6935510718406467`*^9}, {
   3.693551306947064*^9, 3.693551314888282*^9}, {3.693551369351716*^9, 
   3.6935514829989223`*^9}, {3.6935515754880238`*^9, 3.693551587602271*^9}, {
   3.693551778113003*^9, 3.693551784648252*^9}, {3.693551896430581*^9, 
   3.693551896621065*^9}, {3.693552009392975*^9, 3.6935520106744537`*^9}, {
   3.693552076071445*^9, 3.693552082382131*^9}, {3.693552190677342*^9, 
   3.6935521924424133`*^9}, {3.693552374064519*^9, 3.693552385159031*^9}, {
   3.6935524365828447`*^9, 3.693552456012289*^9}, {3.693552495342204*^9, 
   3.69355250069598*^9}, {3.693552564608667*^9, 3.693552591214561*^9}, {
   3.693552637522148*^9, 3.69355265384328*^9}, {3.693552720658547*^9, 
   3.693552746308487*^9}, {3.6935527768421803`*^9, 3.693552797754736*^9}, {
   3.6935530058382397`*^9, 3.693553054966484*^9}, {3.693553091497259*^9, 
   3.693553091912405*^9}, {3.6935567557935743`*^9, 3.6935567709909763`*^9}, {
   3.6935593472127132`*^9, 3.6935594054084167`*^9}, 3.693568766414254*^9, {
   3.693569059636038*^9, 3.69356910626648*^9}, {3.693574565047756*^9, 
   3.693574568927229*^9}, {3.693934190497493*^9, 3.693934208719932*^9}, {
   3.6939342908364677`*^9, 3.6939343103788*^9}, {3.693934346762501*^9, 
   3.693934354591413*^9}, {3.693934413263646*^9, 3.693934482674617*^9}, {
   3.693934553686747*^9, 3.693934665694441*^9}, {3.693934698364242*^9, 
   3.69393481757242*^9}, {3.693935125344976*^9, 3.693935148732542*^9}, {
   3.693935357266725*^9, 3.693935358616227*^9}, {3.693935452544137*^9, 
   3.693935458922089*^9}, {3.693935592181519*^9, 3.693935622566729*^9}, {
   3.693935680100809*^9, 3.6939357981939*^9}, {3.69393591118036*^9, 
   3.693935955988894*^9}, {3.6940834949218493`*^9, 3.694083528959385*^9}, {
   3.694083602377006*^9, 3.694083605702134*^9}, {3.694083656314159*^9, 
   3.694083661615933*^9}, {3.69408378051335*^9, 3.6940837850648527`*^9}, {
   3.694083818141468*^9, 3.694083818517556*^9}, {3.694083848610623*^9, 
   3.6940838576498404`*^9}, {3.694083965776401*^9, 3.69408397155042*^9}, {
   3.6940841341457367`*^9, 3.694084153337166*^9}, {3.694084283541135*^9, 
   3.69408429047682*^9}, {3.694084340038885*^9, 3.694084414860186*^9}, {
   3.694084462975082*^9, 3.694084470836763*^9}, {3.694084525329296*^9, 
   3.694084571471583*^9}, {3.6940846548806953`*^9, 3.6940846550855722`*^9}, {
   3.69408475629461*^9, 3.6940848154757967`*^9}, {3.6940848692042837`*^9, 
   3.694084871586136*^9}, {3.694084936168445*^9, 3.6940849616622562`*^9}, {
   3.6940856533508263`*^9, 3.694085655014455*^9}, 3.696828619144527*^9, {
   3.697567140752997*^9, 3.697567151809947*^9}, {3.697826775523543*^9, 
   3.697826796628026*^9}, 3.698571334089377*^9, {3.700218375385624*^9, 
   3.700218468131584*^9}, {3.7002185055014753`*^9, 3.70021860606087*^9}, {
   3.7002186396177197`*^9, 3.700218823086006*^9}, {3.700219911206216*^9, 
   3.700219917315268*^9}, {3.700220353449315*^9, 3.700220517144368*^9}, {
   3.700220562328499*^9, 3.700220616960886*^9}, {3.70022065077985*^9, 
   3.700220706441099*^9}, {3.7002208598513403`*^9, 3.700220859965176*^9}, {
   3.701088155179331*^9, 3.701088177272811*^9}, {3.70108863596239*^9, 
   3.701088636243333*^9}, {3.701088677724004*^9, 3.701088678307539*^9}, {
   3.701090732734398*^9, 3.701090733711979*^9}, {3.701091086039632*^9, 
   3.701091152444364*^9}, {3.7010911825705833`*^9, 3.701091184043187*^9}, {
   3.701091276835565*^9, 3.70109131374354*^9}, {3.70109150448072*^9, 
   3.701091522497307*^9}, {3.701091602077574*^9, 3.701091638144745*^9}, {
   3.70150050269567*^9, 3.701500503809793*^9}, {3.701500715785728*^9, 
   3.701500717337585*^9}, 3.701501026467618*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "50c872db-3501-4f36-9411-4a9f8b17e216"]
}, Closed]],

Cell[CellGroupData[{

Cell["Instability of vertex rest point", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.6968276816816893`*^9, 3.696827682853569*^9}, {3.700144835566155*^9, 
   3.7001448361079884`*^9}, {3.7002215490905533`*^9, 
   3.7002215640717993`*^9}, {3.700302477209796*^9, 3.700302478491838*^9}, 
   3.700302989167473*^9},ExpressionUUID->"146c33ec-1a58-447f-a90c-\
c7e01fd5977e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InstabilityOfVertexRestPoint", "::", "usage"}], "=", 
    "\"\<InstabilityOfVertexRestPoint[ \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] analyzes the local stability of the vertex rest \
point of the BEP dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), using \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). For \
details, see the paper.\n\nThe function returns \!\(\*
StyleBox[\"True\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) if the conducted analysis concludes \
that the vertex rest point is unstable. Otherwise it returns \!\(\*
StyleBox[\"False\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\"]\) is a string that indicates the test set rule. \
Possible values are: \\\"all\\\" (test all), \\\"two\\\" (test two) or \
\\\"adj\\\" (test adjacent).\n- \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\"]\) is a string that indicates the tie breaking rule. \
Possible values are: \\\"min\\\" (min if tie), \\\"stick\\\" (stick if tie) \
or \\\"unif\\\" (uniform if tie).\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InstabilityOfVertexRestPoint", "::", "invalidValueOf_d"}], "=", 
    "\"\<the variable d (number of nodes in the game) in \
LocalStabilityOfVertexRestPoint[testSetRule, tieBreakingRule, \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)] cannot take the value `1`. It must \
be an integer strictly greater than 2\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InstabilityOfVertexRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "2"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "Q", ",", "QatPoint", ",", "vertexRules", ",", 
       "characteristicPolynomial", ",", "jordan", ",", "eigenvectors", ",", 
       "eigenvalues", ",", "eigensystem", ",", "negativeEigenvectors", ",", 
       "positiveEigenvectors", ",", "zeroEigenvectors", ",", "p", ",", 
       "projections", ",", "allProjectionsSameSign"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vertexRules", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "[", "1", "]"}], "\[Rule]", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], "\[Rule]", "1"}], "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], "\[Rule]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], "\[Rule]", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
         RowBox[{"n", "<", "3"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{
            "InstabilityOfVertexRestPoint", "::", "invalidValueOf_d"}], ",", 
            "n"}], "]"}], ";", 
          RowBox[{
          "Print", "[", 
           "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 3)\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EM", "=", 
       RowBox[{"MeanDynamics", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "False", ",", 
         "False", ",", "verbosity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"QatPoint", "=", 
          RowBox[{
           RowBox[{"JacobianOfMeanDynamics", "[", 
            RowBox[{"EM", ",", "verbosity"}], "]"}], "/.", "vertexRules"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Jacobian at the vertex:\\n\>\"", ",", 
           RowBox[{"MatrixForm", "[", "QatPoint", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Characteristic Polynomial: \>\"", ",", 
           RowBox[{"Factor", "[", 
            RowBox[{"CharacteristicPolynomial", "[", 
             RowBox[{"QatPoint", ",", "x"}], "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"PostProjectedJacobian", "[", 
        RowBox[{"EM", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"QatPoint", "=", 
       RowBox[{"Q", "/.", "vertexRules"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"characteristicPolynomial", " ", "=", " ", 
       RowBox[{"Factor", "[", 
        RowBox[{"CharacteristicPolynomial", "[", 
         RowBox[{"QatPoint", ",", "x"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Post-projected Jacobian at the vertex:\\n\>\"", ",", 
           RowBox[{"MatrixForm", "[", "QatPoint", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Characteristic Polynomial of post-projected Jacobian: \>\"", 
           ",", "characteristicPolynomial"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"testSetRule", "\[Equal]", "\"\<adj\>\""}], " ", "&&", " ", 
         RowBox[{"tieBreakingRule", "\[Equal]", "\"\<min\>\""}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "This", " ", "is", " ", "for", " ", "the", " ", 
          "\"\<adjacent, min-if-tie\>\"", " ", "case"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jordan", " ", "=", " ", 
          RowBox[{"JordanDecomposition", "[", "QatPoint", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Jordan Decomposition:\\n\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{"MatrixForm", ",", "jordan"}], "]"}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"eigenvectors", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"First", "[", "jordan", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvalues", "=", " ", 
          RowBox[{"Diagonal", "[", 
           RowBox[{"Last", "[", "jordan", "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "is", " ", "for", " ", "the", " ", "other", " ", 
          "cases"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eigensystem", "=", 
          RowBox[{"Eigensystem", "[", "QatPoint", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvalues", "=", 
          RowBox[{"First", "[", "eigensystem", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvectors", "=", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"Last", "[", "eigensystem", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"negativeEigenvectors", "=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "<", "0"}], ",", 
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"##", "&"}], "[", "]"}]}], "]"}], "&"}], ",", 
         "eigenvalues"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"positiveEigenvectors", "=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", ">", "0"}], ",", 
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"##", "&"}], "[", "]"}]}], "]"}], "&"}], ",", 
         "eigenvalues"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zeroEigenvectors", "=", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "==", "0"}], ",", 
            RowBox[{"eigenvectors", "[", 
             RowBox[{"[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"##", "&"}], "[", "]"}]}], "]"}], "&"}], ",", 
         "eigenvalues"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"FullSimplify", "[", 
         RowBox[{"NullSpace", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"negativeEigenvectors", ",", "zeroEigenvectors"}], "]"}], 
          "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"projections", "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "-", 
                 RowBox[{"PadRight", "[", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", "s1"}], "]"}]}], ")"}], 
               "&"}], ",", 
              RowBox[{"Permutations", "[", 
               RowBox[{"UnitVector", "[", 
                RowBox[{"s1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", "All"}], "]"}], "]"}], ".", 
           RowBox[{"p", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "s1"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Outer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#1", "-", 
                 RowBox[{"PadRight", "[", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], ",", "s2"}], "]"}]}], ")"}], 
               "&"}], ",", 
              RowBox[{"Permutations", "[", 
               RowBox[{"UnitVector", "[", 
                RowBox[{"s2", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
            "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", ";;"}], ",", "All"}], "]"}], "]"}], ".", 
           RowBox[{"p", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"s1", "+", "1"}], ";;", 
              RowBox[{"s1", "+", "s2"}]}], "]"}], "]"}]}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Eigenvalues: \>\"", ",", " ", "eigenvalues"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Numerical approximation to eigenvalues = \>\"", ",", 
           RowBox[{"N", "[", 
            RowBox[{"eigenvalues", ",", "6"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"testSetRule", "\[Equal]", "\"\<adj\>\""}], " ", "&&", 
            " ", 
            RowBox[{"tieBreakingRule", "\[Equal]", "\"\<min\>\""}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Generalized Eigenvectors: rows of \\n\>\"", ",", 
              RowBox[{"MatrixForm", "[", "eigenvectors", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Nullspace to Generalized Eigenvectors with negative or zero \
eigenvalue.(If this is just one vector, it is the normal vector to the \
hyperplane):\\n\>\"", ",", "p"}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Eigenvectors: rows of \\n\>\"", ",", " ", 
              RowBox[{"MatrixForm", "[", "eigenvectors", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Nullspace to Eigenvectors with negative or zero \
eigenvalue.(If this is just one vector, it is the normal vector to the \
hyperplane):\\n\>\"", ",", "p"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Projections of the normal vector on the edges from the vertex:\
\\n\>\"", ",", "projections"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"allProjectionsSameSign", "=", 
       RowBox[{"And", "@@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sign", "[", 
             RowBox[{"First", "[", "projections", "]"}], "]"}], "\[Equal]", 
            RowBox[{"Sign", "[", "#", "]"}]}], "&"}], ",", "projections"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"allProjectionsSameSign", ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<The vertex is unstable\>\"", "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
           "Print", "[", "\"\<The analysis is inconclusive.\>\"", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "allProjectionsSameSign"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.696827689935356*^9, 3.6968277154588184`*^9}, 
   3.696827783906498*^9, 3.696828059318956*^9, {3.6968281471678247`*^9, 
   3.6968281480272083`*^9}, {3.696828270753394*^9, 3.6968282748479004`*^9}, {
   3.696828330041394*^9, 3.6968283596180463`*^9}, {3.6968284461504917`*^9, 
   3.6968284520929585`*^9}, 3.6968284926695304`*^9, {3.6968285334667025`*^9, 
   3.6968285625067415`*^9}, {3.6968286672894154`*^9, 3.696828719839525*^9}, {
   3.6968288050577755`*^9, 3.69682881512261*^9}, {3.696828847689764*^9, 
   3.6968289006835546`*^9}, {3.6968289345590887`*^9, 
   3.6968289347465887`*^9}, {3.6968289872680655`*^9, 
   3.6968289874712176`*^9}, {3.6968290861654177`*^9, 3.696829112500805*^9}, {
   3.6968292768275824`*^9, 3.6968293150606365`*^9}, {3.6968294195526533`*^9, 
   3.6968294478194137`*^9}, {3.6968294975696597`*^9, 3.696829504953573*^9}, {
   3.69682956782802*^9, 3.696829568124877*^9}, {3.6968298281657114`*^9, 
   3.696829846022339*^9}, {3.6968299401617947`*^9, 3.696830009681182*^9}, 
   3.6968300483154497`*^9, {3.6968301168328176`*^9, 3.696830185105404*^9}, {
   3.6968302745817595`*^9, 3.696830336692626*^9}, {3.6968303900235944`*^9, 
   3.696830393626917*^9}, {3.696830478145055*^9, 3.696830478441934*^9}, {
   3.696830540448933*^9, 3.696830570314289*^9}, {3.696830793054738*^9, 
   3.6968308429205804`*^9}, {3.6968310066743593`*^9, 
   3.6968310076743584`*^9}, {3.6968313156632843`*^9, 
   3.6968313591255217`*^9}, {3.696831714700754*^9, 3.6968317234627748`*^9}, {
   3.6968317751177607`*^9, 3.6968318107312255`*^9}, {3.6968319174257183`*^9, 
   3.69683192909626*^9}, {3.6968320924315014`*^9, 3.696832169907116*^9}, {
   3.6968323208997746`*^9, 3.696832321306057*^9}, {3.696832457698236*^9, 
   3.696832472430764*^9}, {3.6968325867160487`*^9, 3.6968326402802877`*^9}, {
   3.696832808038528*^9, 3.696832839856928*^9}, {3.6968329229221725`*^9, 
   3.696832943210587*^9}, {3.6968330549296975`*^9, 3.6968330789183626`*^9}, {
   3.6968331295600834`*^9, 3.696833144319704*^9}, {3.6968333427284865`*^9, 
   3.696833393674821*^9}, {3.6968335416331434`*^9, 3.696833546801689*^9}, {
   3.6968335898617325`*^9, 3.6968335967854686`*^9}, {3.6968337386874714`*^9, 
   3.6968337754668427`*^9}, {3.6968338059006777`*^9, 
   3.6968338623796945`*^9}, {3.6968353169600477`*^9, 
   3.6968353502207856`*^9}, {3.697567162454978*^9, 3.697567162633936*^9}, 
   3.6985713463948507`*^9, {3.700191842369412*^9, 3.700191855495503*^9}, 
   3.700221544478582*^9, {3.7002988232170773`*^9, 3.700299043109071*^9}, {
   3.700299111408153*^9, 3.700299135617775*^9}, {3.700299191431315*^9, 
   3.70029919436589*^9}, {3.700299316565295*^9, 3.700299362770397*^9}, {
   3.700299412507761*^9, 3.700299550355133*^9}, {3.700299594420985*^9, 
   3.700299739510687*^9}, {3.70029983881882*^9, 3.700299971342763*^9}, {
   3.700300026020123*^9, 3.700300106793915*^9}, {3.700300203252491*^9, 
   3.700300331190906*^9}, {3.700300365019018*^9, 3.70030037146426*^9}, {
   3.700300411639104*^9, 3.700300462522501*^9}, {3.700300526029602*^9, 
   3.700300557685948*^9}, {3.7003006037566853`*^9, 3.7003006041040573`*^9}, {
   3.700300678421822*^9, 3.700300693497322*^9}, 3.700300773587469*^9, {
   3.7003008139295397`*^9, 3.7003008140860367`*^9}, {3.70030091942313*^9, 
   3.70030092167157*^9}, {3.7003009564600687`*^9, 3.700301069036476*^9}, {
   3.700301152108729*^9, 3.700301152297591*^9}, {3.7003011907967863`*^9, 
   3.700301311587888*^9}, {3.70030135227964*^9, 3.700301502570517*^9}, {
   3.700301551834608*^9, 3.700301567033297*^9}, {3.700301629336377*^9, 
   3.700301821847803*^9}, {3.700301865659423*^9, 3.700302062386424*^9}, {
   3.7003021285258417`*^9, 3.700302136569663*^9}, {3.700302170533854*^9, 
   3.700302238359767*^9}, {3.7003023013746367`*^9, 3.700302302440919*^9}, {
   3.700302335742024*^9, 3.7003023646488733`*^9}, {3.700302456883107*^9, 
   3.700302464802765*^9}, {3.70030249651689*^9, 3.700302557785254*^9}, {
   3.7003027103492737`*^9, 3.700302726592637*^9}, {3.7003029007126637`*^9, 
   3.7003029603698683`*^9}, {3.70030300125351*^9, 3.7003030019949007`*^9}, {
   3.700303067089553*^9, 3.7003030686064463`*^9}, 3.7003031449079027`*^9, {
   3.7003031785442257`*^9, 3.700303180038871*^9}, {3.700303263910379*^9, 
   3.700303334505275*^9}, 3.700303445701496*^9, 3.700303572780676*^9, {
   3.7003036066909924`*^9, 3.700303612977455*^9}, {3.700303687095602*^9, 
   3.700303718729123*^9}, {3.7003037494653187`*^9, 3.700303802587161*^9}, {
   3.700303863183503*^9, 3.7003038637140017`*^9}, {3.7015005067787046`*^9, 
   3.701500509365942*^9}, 3.701501029875709*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "895edc6f-5982-4677-a995-fdb13e435fec"]
}, Closed]],

Cell[CellGroupData[{

Cell["Larger number of trials (only test-all, min-if-tie) ", "Subsection",
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.6968276816816893`*^9, 3.696827682853569*^9}, {3.700144835566155*^9, 
   3.7001448361079884`*^9}, {3.7002215490905533`*^9, 
   3.7002215640717993`*^9}, {3.700286415188365*^9, 3.700286416401713*^9}, {
   3.700286463180599*^9, 
   3.7002864776023617`*^9}},ExpressionUUID->"146c33ec-1a58-447f-a90c-\
c7e01fd5977e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestAllMinIfTieManyTrials", "::", "invalidValueOf_d"}], "=", 
    "\"\<the variable \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) (number of nodes in the game) in \
MeanDynamicsTestAllMinIfTieManyTrials[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be an integer \
strictly greater than 1\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestAllMinIfTieManyTrials", "::", "invalidValueOf_trials"}], 
    "=", "\"\<the variable \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) in MeanDynamicsTestAllMinIfTieManyTrials[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)\!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\):1, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be an integer \
strictly greater than 0\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "::", "usage"}], "=", 
    "\"\<MeanDynamicsTestAllMinIfTieManyTrials[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the mean dynamics of the BEP dynamics \
for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"all\",
FontSlant->\"Italic\"]\) as test set rule, \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule, and they test each strategy \
using \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) number of trials.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
indicates the number of trials used to test each strategy.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "mean", " ", "dynamics"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"trials_:", "1"}], ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "MD", 
        ",", "timeComputingMD"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
          RowBox[{"n", "<", "2"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestAllMinIfTieManyTrials", "::", 
              "invalidValueOf_d"}], ",", "n"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 2)\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "trials", "]"}], "]"}], " ", "||", 
          RowBox[{"trials", "<", "1"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestAllMinIfTieManyTrials", "::", 
              "invalidValueOf_trials"}], ",", "trials"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the number of trials (number of trials \
must be an integer greater than 0)\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"timeComputingMD", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Timing", "[", 
          RowBox[{"MD", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"FirstMoversInflowTestAllMinIfTieManyTrials", "[", 
               RowBox[{"n", ",", "trials"}], "]"}], "-", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"SecondMoversInflowTestAllMinIfTieManyTrials", "[", 
               RowBox[{"n", ",", "trials"}], "]"}], "-", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"verbosity", "\[GreaterEqual]", "1"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"StringQ", "[", "MD", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Time computing the mean dynamics: \>\"", ",", 
            "timeComputingMD"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Mean dynamics of BEP, test-all, min-if-tie, \>\"", ",", "n", 
            ",", "\"\< nodes, and \>\"", ",", " ", "trials", ",", 
            "\"\< trials:\\n\>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}], "]"}], 
            ",", "\"\<==\>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", "MD", ",", 
               
               RowBox[{"Short", "/@", "MD"}]}], "]"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "MD"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Inflows", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowTestAllMinIfTieManyTrials", "[", 
     RowBox[{"n_", ",", "trials_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"payoffsX", "=", 
         RowBox[{"PayoffsX", "[", "n", "]"}]}], ",", "eventsAndProbs", ",", 
        "payoffsAndProbabilities", ",", "payoffPMFs", ",", "payoffCDFs", ",", 
        "CDFunctions", ",", "CDStrictFunctions", ",", "PDFunctions", ",", 
        "\[Pi]v", ",", "\[Pi]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Pi]v", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"eventsAndProbs", "=", 
        RowBox[{"possibleEventsWithProbabilities", "[", 
         RowBox[{"trials", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"payoffsAndProbabilities", "=", 
        RowBox[{"MapAtColumn", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"payoffsX", ".", "#"}], "&"}], ",", "eventsAndProbs", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"payoffPMFs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PMF", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"List", "[", 
              RowBox[{
               RowBox[{"payoffsAndProbabilities", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], ",", 
               RowBox[{"payoffsAndProbabilities", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "]"}], "&"}], ",", 
          RowBox[{"Range", "[", "s1", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"payoffCDFs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AccumulateAndFixColumnInMatrix", "[", 
            RowBox[{"2", ",", "#"}], "]"}], "&"}], ",", "payoffPMFs"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CDFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnCumulativeListIntoStrictFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffCDFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CDStrictFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnCumulativeListIntoFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffCDFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnListIntoFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffPMFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"listOfPayoffProbPairs", ",", "listedIndex"}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"payoffProbPair", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"PDFunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "listedIndex", "]"}], "]"}], "]"}], 
                   "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"First", "[", "listedIndex", "]"}], "]"}], 
                    "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], "}"}]}], 
                  ")"}], "*", 
                 RowBox[{
                  UnderoverscriptBox["\[Product]", 
                   RowBox[{"j", "=", "1"}], "s1"], 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[Equal]", 
                    RowBox[{"First", "[", "listedIndex", "]"}]}], ",", "1", 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"First", "[", "listedIndex", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CDStrictFunctions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", "j", "]"}], "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], "}"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CDFunctions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", "j", "]"}], "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "listOfPayoffProbPairs"}], 
             "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "payoffPMFs"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowTestAllMinIfTieManyTrials", "[", 
     RowBox[{"n_", ",", "trials_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"payoffsY", "=", 
         RowBox[{"PayoffsY", "[", "n", "]"}]}], ",", "eventsAndProbs", ",", 
        "payoffsAndProbabilities", ",", "payoffPMFs", ",", "payoffCDFs", ",", 
        "CDFunctions", ",", "CDStrictFunctions", ",", "PDFunctions", ",", 
        "\[Pi]v", ",", "\[Pi]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Pi]v", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[Pi]", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"eventsAndProbs", "=", 
        RowBox[{"possibleEventsWithProbabilities", "[", 
         RowBox[{"trials", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"payoffsAndProbabilities", "=", 
        RowBox[{"MapAtColumn", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"payoffsY", ".", "#"}], "&"}], ",", "eventsAndProbs", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"payoffPMFs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"PMF", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"List", "[", 
              RowBox[{
               RowBox[{"payoffsAndProbabilities", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1", ",", "#"}], "]"}], "]"}], ",", 
               RowBox[{"payoffsAndProbabilities", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], 
            "]"}], "&"}], ",", 
          RowBox[{"Range", "[", "s2", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"payoffCDFs", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"AccumulateAndFixColumnInMatrix", "[", 
            RowBox[{"2", ",", "#"}], "]"}], "&"}], ",", "payoffPMFs"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"CDFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnCumulativeListIntoStrictFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffCDFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CDStrictFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnCumulativeListIntoFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffCDFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PDFunctions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"TurnListIntoFunctionOf", ",", 
          RowBox[{"{", 
           RowBox[{"payoffPMFs", ",", "\[Pi]v"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"listOfPayoffProbPairs", ",", "listedIndex"}], "}"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Total", "[", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"payoffProbPair", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"PDFunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{"First", "[", "listedIndex", "]"}], "]"}], "]"}], 
                   "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"First", "[", "listedIndex", "]"}], "]"}], 
                    "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], "}"}]}], 
                  ")"}], "*", 
                 RowBox[{
                  UnderoverscriptBox["\[Product]", 
                   RowBox[{"j", "=", "1"}], "s2"], 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"j", "\[Equal]", 
                    RowBox[{"First", "[", "listedIndex", "]"}]}], ",", "1", 
                    ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"First", "[", "listedIndex", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CDStrictFunctions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", "j", "]"}], "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], "}"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CDFunctions", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", "j", "]"}], "\[Rule]", 
                    RowBox[{"First", "[", "payoffProbPair", "]"}]}], 
                    "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "listOfPayoffProbPairs"}], 
             "]"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "payoffPMFs"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Supporting", " ", "functions"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"possibleEvents", "[", 
    RowBox[{"numTypes_", ",", "numDraws_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Permutations", "/@", 
      RowBox[{"IntegerPartitions", "[", 
       RowBox[{"numDraws", ",", 
        RowBox[{"{", "numTypes", "}"}], ",", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", "numDraws"}], "]"}]}], "]"}]}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"possibleEventsWithProbabilities", "[", 
    RowBox[{"numDraws_", ",", "probabilities_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"events", "=", 
       RowBox[{"possibleEvents", "[", 
        RowBox[{
         RowBox[{"Length", "[", "probabilities", "]"}], ",", "numDraws"}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"List", "[", 
         RowBox[{"#", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Multinomial", "@@", "#"}], ")"}], "*", 
           RowBox[{"Apply", "[", 
            RowBox[{"Times", ",", 
             SuperscriptBox["probabilities", "#"]}], "]"}]}]}], "]"}], "&"}], 
       ",", "events"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapAtColumn", "[", 
    RowBox[{"f_", ",", "l_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MapAt", "[", 
       RowBox[{"f", ",", "#", ",", "c"}], "]"}], "&"}], ",", "l"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PMF", "[", "l_", "]"}], ":=", 
   RowBox[{"SortBy", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"List", "[", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{"Total", "@", 
           RowBox[{"Map", "[", 
            RowBox[{"Last", ",", "#"}], "]"}]}]}], "]"}], "&"}], ",", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"l", ",", "First"}], "]"}]}], "]"}], ",", "First"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AccumulateAndFixColumnInMatrix", "[", 
    RowBox[{"c_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"new", "=", "m"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "I", " ", "define", " ", "new", " ", "rather", " ", "than", " ", 
        "modifying", " ", "the", " ", "argument"}], ",", " ", 
       RowBox[{
        RowBox[{
        "in", " ", "the", " ", "hope", " ", "that", " ", "the", " ", 
         "function", " ", "will", " ", "be", " ", "automatically", " ", 
         RowBox[{"compiled", ".", " ", "See"}], " ", 
         "\"\<A compiled function can't change the value of its \
argument.\>\"", " ", "in", " ", 
         RowBox[{"http", ":"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
            "questions"}], "/", "1803"}], "/", "how"}], "-", "to", "-", 
         "compile", "-", "effectively"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "This", " ", "function", " ", "prepends", " ", "a", " ", "0", " ", 
        "and", " ", "removes", " ", "the", " ", "last", " ", "element"}], ",",
        " ", 
       RowBox[{
       "which", " ", "is", " ", "assumed", " ", "to", " ", "be", " ", "a", 
        " ", "1.", " ", "The", " ", "motivation", " ", "is", " ", "to", " ", 
        "leave", " ", "everything", " ", "nice", " ", "and", " ", "ready", 
        " ", "for", " ", 
        RowBox[{"TurnListIntoStrictFunctionOf", "."}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"new", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "c"}], "]"}], "]"}], "=", " ", 
       RowBox[{"Most", "[", 
        RowBox[{"FoldList", "[", 
         RowBox[{"Plus", ",", "0", ",", 
          RowBox[{"m", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "c"}], "]"}], "]"}]}], "]"}], "]"}]}], ";", 
      "new"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnListIntoFunctionOf", "[", 
    RowBox[{"l_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"MapAtColumn", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "\[Equal]", "#"}], ")"}], "&"}], ",", "l", ",", "1"}],
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Reverse", ",", "m"}], "]"}], ",", 
       "\"\<Shouldn't happen!\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnCumulativeListIntoFunctionOf", "[", 
    RowBox[{"l_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"MapAtColumn", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "\[LessEqual]", "#"}], ")"}], "&"}], ",", "l", ",", 
           "1"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "\[LessEqual]", 
            RowBox[{"First", "[", 
             RowBox[{"First", "[", "l", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Reverse", ",", "m"}], "]"}], ",", "1"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnCumulativeListIntoStrictFunctionOf", "[", 
    RowBox[{"l_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"MapAtColumn", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "<", "#"}], ")"}], "&"}], ",", "l", ",", "1"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "<", 
            RowBox[{"First", "[", 
             RowBox[{"First", "[", "l", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
        "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Reverse", ",", "m"}], "]"}], ",", "1"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PayoffsX", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"centipedePlus", "=", "3"}], ",", 
       RowBox[{"centipedeMinus", "=", "1"}], ",", "gain", ",", 
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gain", "=", 
       RowBox[{"centipedePlus", "-", "centipedeMinus"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[GreaterEqual]", "i"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"i", "-", "1"}], ")"}], "*", "gain"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "gain"}], "-", 
           "centipedeMinus"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PayoffsY", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"centipedePlus", "=", "3"}], ",", 
        RowBox[{"centipedeMinus", "=", "1"}], ",", "gain", ",", 
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gain", "=", 
        RowBox[{"centipedePlus", "-", "centipedeMinus"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[GreaterEqual]", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "gain"}], "+", 
            "centipedePlus"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "*", "gain"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "s1"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "FloatingPointApproximateRestPointTestAllMinIfTieManyTrials", "::", 
     "usage"}], "=", 
    "\"\<FloatingPointApproximateRestPointTestAllMinIfTieManyTrials[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns an approximate rest point of the BEP \
dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"all\",
FontSlant->\"Italic\"]\) as test set rule, \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule, and they test each strategy \
using \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) number of trials. This approximate rest point is \
computed by applying the \!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) function FindRoot on the appropriate mean dynamics. \
You can find more details about FindRoot in the \!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)documentation. \n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
indicates the number of trials used to test each strategy.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FloatingPointApproximateRestPointTestAllMinIfTieManyTrials", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"trials_:", "1"}], ",", " ", 
      RowBox[{
       StyleBox["verbosity_:",
        FontSlant->"Italic"], "1"}]}], " ", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "MD"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MD", "=", 
        RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
         RowBox[{"n", ",", "trials", ",", "verbosity"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FindRoot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"s1", "-", "1"}]}], "]"}], "\[Equal]", 
             RowBox[{"MD", "[", 
              RowBox[{"[", 
               RowBox[{"2", ";;", "s1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"s2", "-", "1"}]}], "]"}], "\[Equal]", 
             RowBox[{"MD", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"s1", "+", "2"}], ";;", 
                RowBox[{"s1", "+", "s2"}]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "\[Equal]", 
              RowBox[{"1", "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"y", "[", "1", "]"}], "\[Equal]", 
              RowBox[{"1", "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"y", "[", "j", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "2", ",", "s2"}], "}"}]}], "]"}]}]}]}], 
            "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "/", "s1"}], ",", "0", ",", "1"}], "}"}], ",", 
                "#"}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "/", "s2"}], ",", "0", ",", "1"}], "}"}], ",", 
                "#"}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NDSolveMeanDynamicsTestAllMinIfTieManyTrials", "::", "usage"}], 
    "=", "\"\<NDSolveMeanDynamicsTestAllMinIfTieManyTrials[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\):1, \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\":\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"RandomPoint\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 , \!\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\):300, \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\):10.^-4, \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\):6 ] numerically integrates the BEP dynamics for a \
Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"all\",
FontSlant->\"Italic\"]\) as test set rule, \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule, and they test each strategy \
using \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) number of trials. The numerical integration is \
conducted using NDSolve (a \!\(\*
StyleBox[\"Mathematica\",
FontSlant->\"Italic\"]\) function), starting at the initial point provided by \
the user (as third parameter, called \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) above), or at a random initial point if the user \
does not provide one.\n\nThe function returns a list of the form {\!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"solution\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"finalPoint\",
FontSlant->\"Italic\"]\)}, where:\n- \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) is the initial point used for the integration.\n- \!\
\(\*
StyleBox[\"solution\",
FontSlant->\"Italic\"]\) is the solution of the integration (i.e. a list of \
interpolationg functions). \n- \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\) is the greatest time for which the dynamics have \
been integrated. \n- \!\(\*
StyleBox[\"finalPoint\",
FontSlant->\"Italic\"]\) is the last point in the computed trajectory (i.e. \
the solution evaluated at \!\(\*
StyleBox[\"finalTime\",
FontSlant->\"Italic\"]\)).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"trials\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
indicates the number of trials used to test each strategy.\n- \!\(\*
StyleBox[\"initialPoint\",
FontSlant->\"Italic\"]\) is an optional parameter. It is the initial point, \
provided as a list containing \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) + 2 numbers. If this parameter is not provided, the \
function takes a random initial point using RandomPoints[\!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), 1].\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"maxTime\",
FontSlant->\"Italic\"]\) is an optional parameter. It indicates the maximum \
final time used when integrating the mean dynamics using NDSolve. If the norm \
of the mean dynamics gets sufficiently small, then the integration stops (see \
below).\n- \!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\) is an optional parameter. The integration of the \
mean dynamics will stop if the norm of the mean dynamics is less than the \
\!\(\*
StyleBox[\"tolerance\",
FontSlant->\"Italic\"]\).\n- \!\(\*
StyleBox[\"accuracyGoal\",
FontSlant->\"Italic\"]\) is an optional parameter, which indicates the \
AccuracyGoal used in NDSolve.\>\""}], " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{" ", 
         RowBox[{
         "The", " ", "only", " ", "differences", " ", "between", " ", "this", 
          " ", "function", " ", "below", " ", "and", " ", 
          "NDSolveMeanDynamics", " ", "are", " ", "a"}], ")"}], " ", "the", 
        " ", "one", " ", "below", " ", "uses", " ", "the", " ", "mean", " ", 
        "dynamics", " ", "computing", " ", 
        RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
         RowBox[{"n", ",", "trials", ",", "verbosity"}], "]"}], " ", "rather",
         " ", "than", " ", 
        RowBox[{"MeanDynamics", "[", 
         RowBox[{
         "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "False", ",", 
          "False", ",", "verbosity"}], "]"}]}], ",", " ", 
       RowBox[{"and", " ", "b"}]}], ")"}], " ", "the", " ", "function", " ", 
     "below", " ", "uses", " ", "Method"}], "->", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
      "}"}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NDSolveMeanDynamicsTestAllMinIfTieManyTrials", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"trials_:", "1"}], ",", 
     RowBox[{
      StyleBox["ip_:",
       FontSlant->"Italic"], 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"maxTime_:", "300"}], ",", 
     RowBox[{"tolerance_:", 
      RowBox[{"10.", "^", 
       RowBox[{"-", "4"}]}]}], ",", 
     RowBox[{"accuracyGoal_:", "6"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"initialPoint", ",", 
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "projectedMD", ",", "vars", ",", "rulesToAddt", ",", "varsWitht", ",", 
       "Dvars", ",", "sol", ",", "finalTime"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         StyleBox["ip",
          FontSlant->"Italic"], "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"initialPoint", "=", 
         RowBox[{"First", "[", 
          RowBox[{"RandomPoints", "[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"initialPoint", "=", 
         StyleBox["ip",
          FontSlant->"Italic"]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varsWitht", "=", 
       RowBox[{"vars", "/.", "rulesToAddt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"projectedMD", "=", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s1"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}], ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s2"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
          "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
          RowBox[{"n", ",", "trials", ",", 
           RowBox[{"verbosity", "-", "1"}]}], "]"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "NDSolve", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We solve the differential equation numerically (with NDSolve), \
starting at the initial point: \>\"", ",", " ", "initialPoint"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"finalTime", "=", "maxTime"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"Dvars", "\[Equal]", 
             RowBox[{"(", 
              RowBox[{"projectedMD", "/.", "rulesToAddt"}], ")"}]}], "]"}], 
           ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"varsWitht", "/.", 
               RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "==", "initialPoint"}],
             "]"}], ",", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"Norm", "[", "Dvars", "]"}], "<", "tolerance"}], "]"}],
              ",", " ", 
             RowBox[{"\"\<StopIntegration\>\"", ";", 
              RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "vars", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "maxTime"}], "}"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}], ",", 
         RowBox[{"Method", "->", 
          RowBox[{"{", 
           RowBox[{
           "\"\<EquationSimplification\>\"", "->", "\"\<Residual\>\""}], 
           "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Tooltip", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "&"}], ",", "sol"}], "]"}], 
                ",", "vars"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "@", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", "s1"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<First mover\>\""}], ",", 
                
                RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "}"}]}],
                   "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<Second mover\>\""}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\"\<                \>\"", 
            ",", " ", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "15"}], ",", 
            RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"initialPoint", ",", "sol", ",", "finalTime", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], "]"}]}],
        "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.696827689935356*^9, 3.6968277154588184`*^9}, 
   3.696827783906498*^9, 3.696828059318956*^9, {3.6968281471678247`*^9, 
   3.6968281480272083`*^9}, {3.696828270753394*^9, 3.6968282748479004`*^9}, {
   3.696828330041394*^9, 3.6968283596180463`*^9}, {3.6968284461504917`*^9, 
   3.6968284520929585`*^9}, 3.6968284926695304`*^9, {3.6968285334667025`*^9, 
   3.6968285625067415`*^9}, {3.6968286672894154`*^9, 3.696828719839525*^9}, {
   3.6968288050577755`*^9, 3.69682881512261*^9}, {3.696828847689764*^9, 
   3.6968289006835546`*^9}, {3.6968289345590887`*^9, 
   3.6968289347465887`*^9}, {3.6968289872680655`*^9, 
   3.6968289874712176`*^9}, {3.6968290861654177`*^9, 3.696829112500805*^9}, {
   3.6968292768275824`*^9, 3.6968293150606365`*^9}, {3.6968294195526533`*^9, 
   3.6968294478194137`*^9}, {3.6968294975696597`*^9, 3.696829504953573*^9}, {
   3.69682956782802*^9, 3.696829568124877*^9}, {3.6968298281657114`*^9, 
   3.696829846022339*^9}, {3.6968299401617947`*^9, 3.696830009681182*^9}, 
   3.6968300483154497`*^9, {3.6968301168328176`*^9, 3.696830185105404*^9}, {
   3.6968302745817595`*^9, 3.696830336692626*^9}, {3.6968303900235944`*^9, 
   3.696830393626917*^9}, {3.696830478145055*^9, 3.696830478441934*^9}, {
   3.696830540448933*^9, 3.696830570314289*^9}, {3.696830793054738*^9, 
   3.6968308429205804`*^9}, {3.6968310066743593`*^9, 
   3.6968310076743584`*^9}, {3.6968313156632843`*^9, 
   3.6968313591255217`*^9}, {3.696831714700754*^9, 3.6968317234627748`*^9}, {
   3.6968317751177607`*^9, 3.6968318107312255`*^9}, {3.6968319174257183`*^9, 
   3.69683192909626*^9}, {3.6968320924315014`*^9, 3.696832169907116*^9}, {
   3.6968323208997746`*^9, 3.696832321306057*^9}, {3.696832457698236*^9, 
   3.696832472430764*^9}, {3.6968325867160487`*^9, 3.6968326402802877`*^9}, {
   3.696832808038528*^9, 3.696832839856928*^9}, {3.6968329229221725`*^9, 
   3.696832943210587*^9}, {3.6968330549296975`*^9, 3.6968330789183626`*^9}, {
   3.6968331295600834`*^9, 3.696833144319704*^9}, {3.6968333427284865`*^9, 
   3.696833393674821*^9}, {3.6968335416331434`*^9, 3.696833546801689*^9}, {
   3.6968335898617325`*^9, 3.6968335967854686`*^9}, {3.6968337386874714`*^9, 
   3.6968337754668427`*^9}, {3.6968338059006777`*^9, 
   3.6968338623796945`*^9}, {3.6968353169600477`*^9, 
   3.6968353502207856`*^9}, {3.697567162454978*^9, 3.697567162633936*^9}, 
   3.6985713463948507`*^9, {3.700191842369412*^9, 3.700191855495503*^9}, 
   3.700221544478582*^9, {3.700286676426059*^9, 3.700286710742215*^9}, {
   3.700286753525886*^9, 3.700286767610125*^9}, {3.7002868163889933`*^9, 
   3.700286857047408*^9}, {3.700286904781719*^9, 3.700286954869*^9}, {
   3.7002870182500067`*^9, 3.700287020792564*^9}, {3.700287270154249*^9, 
   3.7002872807481747`*^9}, {3.700287333197072*^9, 3.700287475715457*^9}, {
   3.700287557346855*^9, 3.700287557783383*^9}, {3.700291695621359*^9, 
   3.7002917327350903`*^9}, {3.700291817389977*^9, 3.700291841927243*^9}, {
   3.700291891685471*^9, 3.700291912610012*^9}, {3.7002920260567827`*^9, 
   3.7002920745783243`*^9}, 3.700292119050542*^9, {3.700292221155966*^9, 
   3.7002922725571203`*^9}, {3.700292310584629*^9, 3.700292314868843*^9}, {
   3.700293345525783*^9, 3.700293449057757*^9}, {3.7002934940469923`*^9, 
   3.700293592722321*^9}, 3.700293624144095*^9, {3.700293798725031*^9, 
   3.7002938190848923`*^9}, {3.700293892707374*^9, 3.700293941150261*^9}, {
   3.7002941265326023`*^9, 3.700294164421632*^9}, {3.700294214746409*^9, 
   3.7002942495951033`*^9}, {3.700394391692952*^9, 3.7003944503206263`*^9}, 
   3.700394516757365*^9, {3.7003945702284317`*^9, 3.7003945802269497`*^9}, {
   3.700394611863882*^9, 3.70039461280937*^9}, {3.700394642832849*^9, 
   3.70039479449599*^9}, {3.700394872630781*^9, 3.700395074388817*^9}, {
   3.7003951084841127`*^9, 3.7003951363384953`*^9}, {3.700395175879771*^9, 
   3.7003952056143513`*^9}, {3.700395296608645*^9, 3.7003952998181753`*^9}, {
   3.700395859797472*^9, 3.700395995179701*^9}, {3.7003960437187757`*^9, 
   3.7003961422413063`*^9}, {3.700396250852634*^9, 3.700396344806937*^9}, {
   3.7003964465564127`*^9, 3.7003964731867123`*^9}, {3.700396519913138*^9, 
   3.7003965604976587`*^9}, {3.7003965906066427`*^9, 3.700396612647242*^9}, {
   3.700396688116406*^9, 3.700396766008471*^9}, {3.7003968049321213`*^9, 
   3.70039691094622*^9}, {3.700397054749299*^9, 3.70039710365492*^9}, 
   3.700397152622591*^9, {3.700397392500225*^9, 3.700397438181683*^9}, {
   3.700397490752324*^9, 3.700397510041771*^9}, {3.7010871556151323`*^9, 
   3.701087155974077*^9}, {3.701087206205523*^9, 3.7010872065448103`*^9}, 
   3.701087404533368*^9, 3.701087434704303*^9, {3.701087579342342*^9, 
   3.7010875829327383`*^9}, {3.701087678569037*^9, 3.70108771281035*^9}, {
   3.7010877631578074`*^9, 3.701087770173099*^9}, {3.701087804657331*^9, 
   3.7010879135011177`*^9}, {3.701087944528446*^9, 3.701087951838567*^9}, 
   3.7010880104756536`*^9, {3.701088110368567*^9, 3.701088143109475*^9}, {
   3.701088293178771*^9, 3.701088379129629*^9}, {3.7010885090527573`*^9, 
   3.7010885101877737`*^9}, {3.7010887198376617`*^9, 3.701088739381483*^9}, {
   3.701089073090334*^9, 3.7010890849129133`*^9}, 3.701089152484825*^9, 
   3.70108918883291*^9, 3.701089253846817*^9, {3.701089328791985*^9, 
   3.701089358081977*^9}, 3.701089481855282*^9, 3.701089514459196*^9, {
   3.7010897031767693`*^9, 3.7010897035795517`*^9}, {3.7010898585325737`*^9, 
   3.701089876487355*^9}, {3.701090537674761*^9, 3.701090604442882*^9}, {
   3.701090744110001*^9, 3.70109074466033*^9}, {3.701090940671815*^9, 
   3.701090976541936*^9}, {3.701091196083013*^9, 3.7010911973651037`*^9}, {
   3.701091372908757*^9, 3.701091430313455*^9}, {3.701091535459571*^9, 
   3.7010915560245647`*^9}, {3.701091652852769*^9, 3.701091666329623*^9}, {
   3.7010918631224403`*^9, 3.701091863179676*^9}, {3.701094030451824*^9, 
   3.701094065416683*^9}, {3.701172042199535*^9, 3.701172108573131*^9}, {
   3.7011731088755207`*^9, 3.7011731089541683`*^9}, {3.7012645832694407`*^9, 
   3.701264630266247*^9}, {3.7012647185646772`*^9, 3.701264752076232*^9}, {
   3.701500511067511*^9, 3.7015005326457567`*^9}, {3.70150072055646*^9, 
   3.701500756095648*^9}, {3.701528253085202*^9, 3.701528358190032*^9}, {
   3.7015285551269913`*^9, 3.701528556764388*^9}, {3.701591646642468*^9, 
   3.7015916685964823`*^9}},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "895edc6f-5982-4677-a995-fdb13e435fec"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Introduction of backward induction agents, with the other agents using \
test-all, min-if-tie\
\>", "Subsection",
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.6968276816816893`*^9, 3.696827682853569*^9}, {3.700144835566155*^9, 
   3.7001448361079884`*^9}, {3.7002215490905533`*^9, 
   3.7002215640717993`*^9}, {3.700286415188365*^9, 3.700286416401713*^9}, {
   3.700286463180599*^9, 3.7002864776023617`*^9}, {3.701093691759749*^9, 
   3.701093700555978*^9}, {3.701093790702235*^9, 3.701093801579474*^9}, {
   3.701094195370756*^9, 3.7010941958083982`*^9}, {3.701149206330098*^9, 
   3.701149219671883*^9}},ExpressionUUID->"146c33ec-1a58-447f-a90c-\
c7e01fd5977e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestAllMinIfTieWithBIAgents", "::", "invalidValueOf_d"}], 
    "=", "\"\<the variable \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) (number of nodes in the game) in \
MeanDynamicsTestAllMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be an integer \
strictly greater than 1\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestAllMinIfTieWithBIAgents", "::", "invalidValueOf_b"}], 
    "=", "\"\<the variable \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) in MeanDynamicsTestAllMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be a number \
in the range [0,1).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestAllMinIfTieWithBIAgents", "::", "usage"}], "=", 
    "\"\<MeanDynamicsTestAllMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the mean dynamics of the BEP dynamics \
for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where a fraction \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) of agents in each population stop at their first \
opportunity, whilst the rest of the agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"all\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). \
Variables x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] in the equations returned by this function refer to \
the population of BEP agents, i.e. \!\(\*
StyleBox[\"excluding\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) the backward induction agents. Thus, \
both the sum of x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and of y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] are equal to 1-\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) is an optional parameter. It is a number in the \
range [0,1) that indicates the fraction of backward induction agents in each \
population.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "mean", " ", "dynamics"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestAllMinIfTieWithBIAgents", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"b_:", "0"}], ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "MD", 
        ",", "timeComputingMD"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
          RowBox[{"n", "<", "2"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestAllMinIfTieWithBIAgents", "::", 
              "invalidValueOf_d"}], ",", "n"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 2)\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"NumericQ", "[", "b", "]"}], "]"}], "||", 
          RowBox[{"b", "<", "0"}], " ", "||", 
          RowBox[{"b", "\[GreaterEqual]", "1"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestAllMinIfTieWithBIAgents", "::", 
              "invalidValueOf_b"}], ",", "b"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the fraction of backward induction \
agents. It must be a number in the range [0,1).\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"timeComputingMD", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Timing", "[", 
          RowBox[{"MD", "=", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "b"}], ")"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                    RowBox[{"y", "[", "k", "]"}]}], ")"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"m", "=", "1"}], "i"], 
                    RowBox[{"y", "[", "m", "]"}]}], ")"}], 
                    RowBox[{"s1", "-", "i"}]]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{"y", "[", "l", "]"}]}], ")"}], 
                    RowBox[{"i", "-", "k"}]], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"m", "=", "1"}], "k"], 
                    RowBox[{"y", "[", "m", "]"}]}], ")"}], 
                    RowBox[{"s1", "-", "i"}]]}]}]}], ")"}]}], "-", 
                  RowBox[{"x", "[", "i", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"y", "[", "1", "]"}], "+", "b"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "b"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "s1"], 
                    RowBox[{"x", "[", "k", "]"}]}], ")"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "+", 
                    RowBox[{"x", "[", "2", "]"}]}], ")"}], 
                    RowBox[{"s2", "-", "1"}]]}], "+", 
                    SuperscriptBox[
                    RowBox[{"x", "[", "1", "]"}], "s2"]}], ")"}]}], "-", 
                   RowBox[{"y", "[", "1", "]"}]}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "b"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"j", "+", "1"}]}], "s1"], 
                    RowBox[{"x", "[", "k", "]"}]}], ")"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"m", "=", "1"}], 
                    RowBox[{"j", "+", "1"}]], 
                    RowBox[{"x", "[", "m", "]"}]}], ")"}], 
                    RowBox[{"s2", "-", "j"}]]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "j"], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                    RowBox[{"j", "-", "k", "+", "1"}]], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"m", "=", "1"}], "k"], 
                    RowBox[{"x", "[", "m", "]"}]}], ")"}], 
                    RowBox[{"s2", "-", "j"}]]}]}]}], ")"}]}], "-", 
                    RowBox[{"y", "[", "j", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"x", "[", "1", "]"}], "+", "b"}]}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "1"}], "s1"], 
                RowBox[{"x", "[", "j", "]"}]}], "\[Rule]", 
               RowBox[{"1", "-", "b"}]}], ",", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "1"}], "s2"], 
                RowBox[{"y", "[", "j", "]"}]}], "\[Rule]", 
               RowBox[{"1", "-", "b"}]}]}], "}"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"verbosity", "\[GreaterEqual]", "1"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"StringQ", "[", "MD", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Time computing the mean dynamics: \>\"", ",", 
            "timeComputingMD"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Mean dynamics of BEP, test-all, min-if-tie, \>\"", ",", "n", 
            ",", "\"\< nodes, and a fraction \>\"", ",", " ", "b", ",", 
            "\"\< of backward induction agents in each population:\\n\>\"", 
            ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}], "]"}], 
            ",", "\"\<==\>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", "MD", ",", 
               
               RowBox[{"Short", "/@", "MD"}]}], "]"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "MD"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents", "::", 
     "usage"}], "=", 
    "\"\<FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the approximate interior rest point of \
the BEP dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where a fraction \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) of agents in each population stop at their first \
opportunity, whilst the rest of the agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"all\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). The \
output of this function refers to the population of BEP agents, i.e. \!\(\*
StyleBox[\"excluding\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) the backward induction agents. Thus, \
both the sum of x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and of y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] will be equal to 1-\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\).\n\nThis function employs the Euler method to find a \
fixed point of the equation \n\\t \!\(\*SubscriptBox[\(x\), \(t + 1\)]\) = \!\
\(\*SubscriptBox[\(x\), \(t\)]\) + step * MeanDynamics(\!\(\*SubscriptBox[\(x\
\), \(t\)]\)) \n      using floating-point arithmetic and starting from the \
center of the simplices.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) is an optional parameter. It is a number in the \
range [0,1) that indicates the fraction of backward induction agents in each \
population.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\) is an optional parameter. It determines the \
magnitude of the step used in the Euler method.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"b_:", "0"}], ",", " ", 
     RowBox[{
      StyleBox["verbosity_:",
       FontSlant->"Italic"], "1"}], ",", 
     RowBox[{"step_:", 
      RowBox[{"2.", "^", 
       RowBox[{"-", "4"}]}]}]}], " ", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "P", ",", "vars", 
       ",", "CompiledNextIteration", ",", "Compiledfpoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EM", "=", 
       RowBox[{"MeanDynamicsTestAllMinIfTieWithBIAgents", "[", 
        RowBox[{"n", ",", "b", ",", "verbosity"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]1", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s1"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]2", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s2"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CompiledNextIteration", "=", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "vars", "]"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b"}], ")"}], "*", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b"}], ")"}], "*", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
           "+", 
           RowBox[{"step", "*", 
            RowBox[{"P", ".", "EM"}]}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Compiledfpoint", "=", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"FixedPoint", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CompiledNextIteration", "@@", "#"}], ")"}], "&"}], ",", 
           
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "b"}], ")"}], "*", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s1"}], ",", "s1"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s2"}], ",", "s2"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"10", "^", "6"}], ",", 
           RowBox[{"SameTest", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], "<", 
               RowBox[{"10", "^", 
                RowBox[{"-", "16"}]}]}], "&"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", "Compiledfpoint"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.696827689935356*^9, 3.6968277154588184`*^9}, 
   3.696827783906498*^9, 3.696828059318956*^9, {3.6968281471678247`*^9, 
   3.6968281480272083`*^9}, {3.696828270753394*^9, 3.6968282748479004`*^9}, {
   3.696828330041394*^9, 3.6968283596180463`*^9}, {3.6968284461504917`*^9, 
   3.6968284520929585`*^9}, 3.6968284926695304`*^9, {3.6968285334667025`*^9, 
   3.6968285625067415`*^9}, {3.6968286672894154`*^9, 3.696828719839525*^9}, {
   3.6968288050577755`*^9, 3.69682881512261*^9}, {3.696828847689764*^9, 
   3.6968289006835546`*^9}, {3.6968289345590887`*^9, 
   3.6968289347465887`*^9}, {3.6968289872680655`*^9, 
   3.6968289874712176`*^9}, {3.6968290861654177`*^9, 3.696829112500805*^9}, {
   3.6968292768275824`*^9, 3.6968293150606365`*^9}, {3.6968294195526533`*^9, 
   3.6968294478194137`*^9}, {3.6968294975696597`*^9, 3.696829504953573*^9}, {
   3.69682956782802*^9, 3.696829568124877*^9}, {3.6968298281657114`*^9, 
   3.696829846022339*^9}, {3.6968299401617947`*^9, 3.696830009681182*^9}, 
   3.6968300483154497`*^9, {3.6968301168328176`*^9, 3.696830185105404*^9}, {
   3.6968302745817595`*^9, 3.696830336692626*^9}, {3.6968303900235944`*^9, 
   3.696830393626917*^9}, {3.696830478145055*^9, 3.696830478441934*^9}, {
   3.696830540448933*^9, 3.696830570314289*^9}, {3.696830793054738*^9, 
   3.6968308429205804`*^9}, {3.6968310066743593`*^9, 
   3.6968310076743584`*^9}, {3.6968313156632843`*^9, 
   3.6968313591255217`*^9}, {3.696831714700754*^9, 3.6968317234627748`*^9}, {
   3.6968317751177607`*^9, 3.6968318107312255`*^9}, {3.6968319174257183`*^9, 
   3.69683192909626*^9}, {3.6968320924315014`*^9, 3.696832169907116*^9}, {
   3.6968323208997746`*^9, 3.696832321306057*^9}, {3.696832457698236*^9, 
   3.696832472430764*^9}, {3.6968325867160487`*^9, 3.6968326402802877`*^9}, {
   3.696832808038528*^9, 3.696832839856928*^9}, {3.6968329229221725`*^9, 
   3.696832943210587*^9}, {3.6968330549296975`*^9, 3.6968330789183626`*^9}, {
   3.6968331295600834`*^9, 3.696833144319704*^9}, {3.6968333427284865`*^9, 
   3.696833393674821*^9}, {3.6968335416331434`*^9, 3.696833546801689*^9}, {
   3.6968335898617325`*^9, 3.6968335967854686`*^9}, {3.6968337386874714`*^9, 
   3.6968337754668427`*^9}, {3.6968338059006777`*^9, 
   3.6968338623796945`*^9}, {3.6968353169600477`*^9, 
   3.6968353502207856`*^9}, {3.697567162454978*^9, 3.697567162633936*^9}, 
   3.6985713463948507`*^9, {3.700191842369412*^9, 3.700191855495503*^9}, 
   3.700221544478582*^9, {3.700286676426059*^9, 3.700286710742215*^9}, {
   3.700286753525886*^9, 3.700286767610125*^9}, {3.7002868163889933`*^9, 
   3.700286857047408*^9}, {3.700286904781719*^9, 3.700286954869*^9}, {
   3.7002870182500067`*^9, 3.700287020792564*^9}, {3.700287270154249*^9, 
   3.7002872807481747`*^9}, {3.700287333197072*^9, 3.700287475715457*^9}, {
   3.700287557346855*^9, 3.700287557783383*^9}, {3.700291695621359*^9, 
   3.7002917327350903`*^9}, {3.700291817389977*^9, 3.700291841927243*^9}, {
   3.700291891685471*^9, 3.700291912610012*^9}, {3.7002920260567827`*^9, 
   3.7002920745783243`*^9}, 3.700292119050542*^9, {3.700292221155966*^9, 
   3.7002922725571203`*^9}, {3.700292310584629*^9, 3.700292314868843*^9}, {
   3.700293345525783*^9, 3.700293449057757*^9}, {3.7002934940469923`*^9, 
   3.700293592722321*^9}, 3.700293624144095*^9, {3.700293798725031*^9, 
   3.7002938190848923`*^9}, {3.700293892707374*^9, 3.700293941150261*^9}, {
   3.7002941265326023`*^9, 3.700294164421632*^9}, {3.700294214746409*^9, 
   3.7002942495951033`*^9}, {3.700394391692952*^9, 3.7003944503206263`*^9}, 
   3.700394516757365*^9, {3.7003945702284317`*^9, 3.7003945802269497`*^9}, {
   3.700394611863882*^9, 3.70039461280937*^9}, {3.700394642832849*^9, 
   3.70039479449599*^9}, {3.700394872630781*^9, 3.700395074388817*^9}, {
   3.7003951084841127`*^9, 3.7003951363384953`*^9}, {3.700395175879771*^9, 
   3.7003952056143513`*^9}, {3.700395296608645*^9, 3.7003952998181753`*^9}, {
   3.700395859797472*^9, 3.700395995179701*^9}, {3.7003960437187757`*^9, 
   3.7003961422413063`*^9}, {3.700396250852634*^9, 3.700396344806937*^9}, {
   3.7003964465564127`*^9, 3.7003964731867123`*^9}, {3.700396519913138*^9, 
   3.7003965604976587`*^9}, {3.7003965906066427`*^9, 3.700396612647242*^9}, {
   3.700396688116406*^9, 3.700396766008471*^9}, {3.7003968049321213`*^9, 
   3.70039691094622*^9}, {3.700397054749299*^9, 3.70039710365492*^9}, 
   3.700397152622591*^9, {3.700397392500225*^9, 3.700397438181683*^9}, {
   3.700397490752324*^9, 3.700397510041771*^9}, {3.7010871556151323`*^9, 
   3.701087155974077*^9}, {3.701087206205523*^9, 3.7010872065448103`*^9}, 
   3.701087404533368*^9, 3.701087434704303*^9, {3.701087579342342*^9, 
   3.7010875829327383`*^9}, {3.701087678569037*^9, 3.70108771281035*^9}, {
   3.7010877631578074`*^9, 3.701087770173099*^9}, {3.701087804657331*^9, 
   3.7010879135011177`*^9}, {3.701087944528446*^9, 3.701087951838567*^9}, 
   3.7010880104756536`*^9, {3.701088110368567*^9, 3.701088143109475*^9}, {
   3.701088293178771*^9, 3.701088379129629*^9}, {3.7010885090527573`*^9, 
   3.7010885101877737`*^9}, {3.7010887198376617`*^9, 3.701088739381483*^9}, {
   3.701089073090334*^9, 3.7010890849129133`*^9}, 3.701089152484825*^9, 
   3.70108918883291*^9, 3.701089253846817*^9, {3.701089328791985*^9, 
   3.701089358081977*^9}, 3.701089481855282*^9, 3.701089514459196*^9, {
   3.7010897031767693`*^9, 3.7010897035795517`*^9}, {3.7010898585325737`*^9, 
   3.701089876487355*^9}, {3.701090537674761*^9, 3.701090604442882*^9}, {
   3.701090744110001*^9, 3.70109074466033*^9}, {3.701090940671815*^9, 
   3.701090976541936*^9}, {3.701091196083013*^9, 3.7010911973651037`*^9}, {
   3.701091372908757*^9, 3.701091430313455*^9}, {3.701091535459571*^9, 
   3.7010915560245647`*^9}, {3.701091652852769*^9, 3.701091666329623*^9}, {
   3.7010918631224403`*^9, 3.701091863179676*^9}, {3.701093861984775*^9, 
   3.7010938827055693`*^9}, {3.701093946430955*^9, 3.7010939472141953`*^9}, {
   3.701094012254652*^9, 3.701094018290476*^9}, {3.701094129599442*^9, 
   3.701094184709098*^9}, {3.701094245682613*^9, 3.701094560431757*^9}, {
   3.701094658778802*^9, 3.701094802776205*^9}, {3.701094850668914*^9, 
   3.701094854739272*^9}, {3.701094897129724*^9, 3.701094945039769*^9}, {
   3.701095000728998*^9, 3.701095210291378*^9}, {3.701095290175902*^9, 
   3.701095320605071*^9}, {3.7010953571788387`*^9, 3.7010954586426697`*^9}, {
   3.7010955652582283`*^9, 3.7010955657395678`*^9}, {3.701095600013732*^9, 
   3.701095624524124*^9}, 3.701095787432762*^9, {3.701095823163238*^9, 
   3.701095828574436*^9}, {3.701096244536227*^9, 3.701096269892839*^9}, {
   3.701096315468917*^9, 3.70109632548929*^9}, {3.701104948697639*^9, 
   3.701104990173641*^9}, {3.7011051015026503`*^9, 3.701105187844385*^9}, {
   3.701107584642405*^9, 3.7011075847524548`*^9}, {3.701107703027706*^9, 
   3.701107703396533*^9}, {3.701153598208914*^9, 3.701153604799778*^9}, {
   3.7011536518020563`*^9, 3.701153665818362*^9}, {3.701153712767832*^9, 
   3.701153853376032*^9}, {3.701154140716682*^9, 3.7011541924921494`*^9}, 
   3.701154489674263*^9, {3.70115551484743*^9, 3.701155527953867*^9}, {
   3.701156443601883*^9, 3.701156444364333*^9}, 3.701156575631524*^9, 
   3.701156612564027*^9, {3.7011568054309483`*^9, 3.7011568342844753`*^9}, {
   3.701156985563973*^9, 3.701156996497452*^9}, {3.701157032215849*^9, 
   3.701157106937791*^9}, {3.701157152716679*^9, 3.7011571754818287`*^9}, {
   3.701160193952302*^9, 3.7011602423207703`*^9}, {3.701162108259822*^9, 
   3.7011621107170973`*^9}, {3.7011621610176783`*^9, 
   3.7011621899315987`*^9}, {3.701171171328534*^9, 3.701171193136053*^9}, 
   3.701171290351638*^9, {3.701500539201556*^9, 3.701500543792238*^9}, 
   3.70150074270472*^9, {3.7015010566168737`*^9, 3.70150106104961*^9}, {
   3.701528651421954*^9, 3.701528720811461*^9}, {3.7015288406930237`*^9, 
   3.7015288467895603`*^9}, 3.702746190688476*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "895edc6f-5982-4677-a995-fdb13e435fec"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Introduction of backward induction agents, with the other agents using \
test-two, min-if-tie\
\>", "Subsection",
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.6968276816816893`*^9, 3.696827682853569*^9}, {3.700144835566155*^9, 
   3.7001448361079884`*^9}, {3.7002215490905533`*^9, 
   3.7002215640717993`*^9}, {3.700286415188365*^9, 3.700286416401713*^9}, {
   3.700286463180599*^9, 3.7002864776023617`*^9}, {3.701093691759749*^9, 
   3.701093700555978*^9}, {3.701093790702235*^9, 3.701093801579474*^9}, {
   3.701094195370756*^9, 3.7010941958083982`*^9}, {3.701149195430787*^9, 
   3.7011492220567837`*^9}},ExpressionUUID->"146c33ec-1a58-447f-a90c-\
c7e01fd5977e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestTwoMinIfTieWithBIAgents", "::", "invalidValueOf_d"}], 
    "=", "\"\<the variable \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) (number of nodes in the game) in \
MeanDynamicsTestTwoMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be an integer \
strictly greater than 1\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "MeanDynamicsTestTwoMinIfTieWithBIAgents", "::", "invalidValueOf_b"}], 
    "=", "\"\<the variable \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) in MeanDynamicsTestTwoMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\),\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] cannot take the value `1`. It must be a number \
in the range [0,1).\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestTwoMinIfTieWithBIAgents", "::", "usage"}], "=", 
    "\"\<MeanDynamicsTestTwoMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the mean dynamics of the BEP dynamics \
for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where a fraction \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) of agents in each population stop at their first \
opportunity, whilst the rest of the agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"two\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). \
Variables x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] in the equations returned by this function refer to \
the population of BEP agents, i.e. \!\(\*
StyleBox[\"excluding\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) the backward induction agents. Thus, \
both the sum of x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and of y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] are equal to 1-\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\).\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) is an optional parameter. It is a number in the \
range [0,1) that indicates the fraction of backward induction agents in each \
population.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented \
messages.\>\""}], " ", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"The", " ", "mean", " ", "dynamics"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MeanDynamicsTestTwoMinIfTieWithBIAgents", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"b_:", "0"}], ",", 
      RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "MD", 
        ",", "timeComputingMD"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
          RowBox[{"n", "<", "2"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestTwoMinIfTieWithBIAgents", "::", 
              "invalidValueOf_d"}], ",", "n"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 2)\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"NumericQ", "[", "b", "]"}], "]"}], "||", 
          RowBox[{"b", "<", "0"}], " ", "||", 
          RowBox[{"b", "\[GreaterEqual]", "1"}]}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{
             "MeanDynamicsTestTwoMinIfTieWithBIAgents", "::", 
              "invalidValueOf_b"}], ",", "b"}], "]"}], ";", 
           RowBox[{
           "Print", "[", 
            "\"\<Error parameterizing the fraction of backward induction \
agents. It must be a number in the range [0,1).\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"timeComputingMD", "=", 
        RowBox[{"First", "@", 
         RowBox[{"Timing", "[", 
          RowBox[{"MD", "=", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"s1", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"h", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                    RowBox[{"y", "[", "k", "]"}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "h"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "+", 
                    RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"s1", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"h", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                    SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "+", 
                    RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
                  RowBox[{"x", "[", "i", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"y", "[", "1", "]"}], "+", "b"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"s2", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"h", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "s1"], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"h", "+", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "+", 
                    RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"s2", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"h", "=", 
                    RowBox[{"i", "+", "1"}]}], "s2"], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "i"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "i"], 
                    SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "+", 
                    RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
                  RowBox[{"y", "[", "i", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], "/.", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "1", "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"x", "[", "1", "]"}], "+", "b"}]}], ")"}]}]}], 
             "\[IndentingNewLine]", "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "1"}], "s1"], 
                RowBox[{"x", "[", "j", "]"}]}], "\[Rule]", 
               RowBox[{"1", "-", "b"}]}], ",", 
              RowBox[{
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "1"}], "s2"], 
                RowBox[{"y", "[", "j", "]"}]}], "\[Rule]", 
               RowBox[{"1", "-", "b"}]}]}], "}"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"verbosity", "\[GreaterEqual]", "1"}], "&&", 
          RowBox[{"Not", "[", 
           RowBox[{"StringQ", "[", "MD", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Time computing the mean dynamics: \>\"", ",", 
            "timeComputingMD"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Mean dynamics of BEP, test-two, min-if-tie, \>\"", ",", "n", 
            ",", "\"\< nodes, and a fraction \>\"", ",", " ", "b", ",", 
            "\"\< of backward induction agents in each population:\\n\>\"", 
            ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", "i", "]"}], "'"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}], "]"}], 
            ",", "\"\<==\>\"", ",", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", "MD", ",", 
               
               RowBox[{"Short", "/@", "MD"}]}], "]"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "MD"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
    "FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents", "::", 
     "usage"}], "=", 
    "\"\<FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents[ \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\):0, \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\):1 ] returns the approximate interior rest point of \
the BEP dynamics for a Centipede game of length \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\), where a fraction \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) of agents in each population stop at their first \
opportunity, whilst the rest of the agents use \!\(\*
StyleBox[\"test\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"two\",
FontSlant->\"Italic\"]\) as test set rule and \!\(\*
StyleBox[\"min\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"if\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"-\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"tie\",
FontSlant->\"Italic\"]\) as tie breaking rule (and number of trials = 1). The \
output of this function refers to the population of BEP agents, i.e. \!\(\*
StyleBox[\"excluding\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\) the backward induction agents. Thus, \
both the sum of x[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] and of y[\!\(\*
StyleBox[\"i\",
FontSlant->\"Italic\"]\)] will be equal to 1-\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\).\n\nThis function employs the Euler method to find a \
fixed point of the equation \n\\t \!\(\*SubscriptBox[\(x\), \(t + 1\)]\) = \!\
\(\*SubscriptBox[\(x\), \(t\)]\) + step * MeanDynamics(\!\(\*SubscriptBox[\(x\
\), \(t\)]\)) \n      using floating-point arithmetic and starting from the \
center of the simplices.\n\n\!\(\*
StyleBox[\"PARAMETERS\",
FontWeight->\"Bold\",
FontVariations->{\"Underline\"->True}]\):\n- \!\(\*
StyleBox[\"d\",
FontSlant->\"Italic\"]\) is an integer that indicates the number of nodes in \
the Centipede game.\n- \!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\) is an optional parameter. It is a number in the \
range [0,1) that indicates the fraction of backward induction agents in each \
population.\n- \!\(\*
StyleBox[\"verbosity\",
FontSlant->\"Italic\"]\) is an optional parameter. It is an integer that \
controls the number of messages that are shown by the function. The higher \
the value of verbosity, the more messages are printed along the execution of \
any function. 0 prints no messages. 10 prints all implemented messages.\n- \!\
\(\*
StyleBox[\"step\",
FontSlant->\"Italic\"]\) is an optional parameter. It determines the \
magnitude of the step used in the Euler method.\>\""}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents", "[", 
    RowBox[{"n_", ",", 
     RowBox[{"b_:", "0"}], ",", " ", 
     RowBox[{
      StyleBox["verbosity_:",
       FontSlant->"Italic"], "1"}], ",", 
     RowBox[{"step_:", 
      RowBox[{"2.", "^", 
       RowBox[{"-", "4"}]}]}]}], " ", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "P", ",", "vars", 
       ",", "CompiledNextIteration", ",", "Compiledfpoint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EM", "=", 
       RowBox[{"MeanDynamicsTestTwoMinIfTieWithBIAgents", "[", 
        RowBox[{"n", ",", "b", ",", "verbosity"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]1", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s1"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]2", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s2"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"P", "=", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"CompiledNextIteration", "=", 
       RowBox[{"Compile", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", "vars", "]"}], ",", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b"}], ")"}], "*", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "b"}], ")"}], "*", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], "]"}]}]}], "]"}], 
           "+", 
           RowBox[{"step", "*", 
            RowBox[{"P", ".", "EM"}]}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Compiledfpoint", "=", 
       RowBox[{"Clip", "[", 
        RowBox[{
         RowBox[{"FixedPoint", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"CompiledNextIteration", "@@", "#"}], ")"}], "&"}], ",", 
           
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "b"}], ")"}], "*", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s1"}], ",", "s1"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s2"}], ",", "s2"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"10", "^", "6"}], ",", 
           RowBox[{"SameTest", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], "<", 
               RowBox[{"10", "^", 
                RowBox[{"-", "16"}]}]}], "&"}], ")"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", "Compiledfpoint"}], "]"}]}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.696827689935356*^9, 3.6968277154588184`*^9}, 
   3.696827783906498*^9, 3.696828059318956*^9, {3.6968281471678247`*^9, 
   3.6968281480272083`*^9}, {3.696828270753394*^9, 3.6968282748479004`*^9}, {
   3.696828330041394*^9, 3.6968283596180463`*^9}, {3.6968284461504917`*^9, 
   3.6968284520929585`*^9}, 3.6968284926695304`*^9, {3.6968285334667025`*^9, 
   3.6968285625067415`*^9}, {3.6968286672894154`*^9, 3.696828719839525*^9}, {
   3.6968288050577755`*^9, 3.69682881512261*^9}, {3.696828847689764*^9, 
   3.6968289006835546`*^9}, {3.6968289345590887`*^9, 
   3.6968289347465887`*^9}, {3.6968289872680655`*^9, 
   3.6968289874712176`*^9}, {3.6968290861654177`*^9, 3.696829112500805*^9}, {
   3.6968292768275824`*^9, 3.6968293150606365`*^9}, {3.6968294195526533`*^9, 
   3.6968294478194137`*^9}, {3.6968294975696597`*^9, 3.696829504953573*^9}, {
   3.69682956782802*^9, 3.696829568124877*^9}, {3.6968298281657114`*^9, 
   3.696829846022339*^9}, {3.6968299401617947`*^9, 3.696830009681182*^9}, 
   3.6968300483154497`*^9, {3.6968301168328176`*^9, 3.696830185105404*^9}, {
   3.6968302745817595`*^9, 3.696830336692626*^9}, {3.6968303900235944`*^9, 
   3.696830393626917*^9}, {3.696830478145055*^9, 3.696830478441934*^9}, {
   3.696830540448933*^9, 3.696830570314289*^9}, {3.696830793054738*^9, 
   3.6968308429205804`*^9}, {3.6968310066743593`*^9, 
   3.6968310076743584`*^9}, {3.6968313156632843`*^9, 
   3.6968313591255217`*^9}, {3.696831714700754*^9, 3.6968317234627748`*^9}, {
   3.6968317751177607`*^9, 3.6968318107312255`*^9}, {3.6968319174257183`*^9, 
   3.69683192909626*^9}, {3.6968320924315014`*^9, 3.696832169907116*^9}, {
   3.6968323208997746`*^9, 3.696832321306057*^9}, {3.696832457698236*^9, 
   3.696832472430764*^9}, {3.6968325867160487`*^9, 3.6968326402802877`*^9}, {
   3.696832808038528*^9, 3.696832839856928*^9}, {3.6968329229221725`*^9, 
   3.696832943210587*^9}, {3.6968330549296975`*^9, 3.6968330789183626`*^9}, {
   3.6968331295600834`*^9, 3.696833144319704*^9}, {3.6968333427284865`*^9, 
   3.696833393674821*^9}, {3.6968335416331434`*^9, 3.696833546801689*^9}, {
   3.6968335898617325`*^9, 3.6968335967854686`*^9}, {3.6968337386874714`*^9, 
   3.6968337754668427`*^9}, {3.6968338059006777`*^9, 
   3.6968338623796945`*^9}, {3.6968353169600477`*^9, 
   3.6968353502207856`*^9}, {3.697567162454978*^9, 3.697567162633936*^9}, 
   3.6985713463948507`*^9, {3.700191842369412*^9, 3.700191855495503*^9}, 
   3.700221544478582*^9, {3.700286676426059*^9, 3.700286710742215*^9}, {
   3.700286753525886*^9, 3.700286767610125*^9}, {3.7002868163889933`*^9, 
   3.700286857047408*^9}, {3.700286904781719*^9, 3.700286954869*^9}, {
   3.7002870182500067`*^9, 3.700287020792564*^9}, {3.700287270154249*^9, 
   3.7002872807481747`*^9}, {3.700287333197072*^9, 3.700287475715457*^9}, {
   3.700287557346855*^9, 3.700287557783383*^9}, {3.700291695621359*^9, 
   3.7002917327350903`*^9}, {3.700291817389977*^9, 3.700291841927243*^9}, {
   3.700291891685471*^9, 3.700291912610012*^9}, {3.7002920260567827`*^9, 
   3.7002920745783243`*^9}, 3.700292119050542*^9, {3.700292221155966*^9, 
   3.7002922725571203`*^9}, {3.700292310584629*^9, 3.700292314868843*^9}, {
   3.700293345525783*^9, 3.700293449057757*^9}, {3.7002934940469923`*^9, 
   3.700293592722321*^9}, 3.700293624144095*^9, {3.700293798725031*^9, 
   3.7002938190848923`*^9}, {3.700293892707374*^9, 3.700293941150261*^9}, {
   3.7002941265326023`*^9, 3.700294164421632*^9}, {3.700294214746409*^9, 
   3.7002942495951033`*^9}, {3.700394391692952*^9, 3.7003944503206263`*^9}, 
   3.700394516757365*^9, {3.7003945702284317`*^9, 3.7003945802269497`*^9}, {
   3.700394611863882*^9, 3.70039461280937*^9}, {3.700394642832849*^9, 
   3.70039479449599*^9}, {3.700394872630781*^9, 3.700395074388817*^9}, {
   3.7003951084841127`*^9, 3.7003951363384953`*^9}, {3.700395175879771*^9, 
   3.7003952056143513`*^9}, {3.700395296608645*^9, 3.7003952998181753`*^9}, {
   3.700395859797472*^9, 3.700395995179701*^9}, {3.7003960437187757`*^9, 
   3.7003961422413063`*^9}, {3.700396250852634*^9, 3.700396344806937*^9}, {
   3.7003964465564127`*^9, 3.7003964731867123`*^9}, {3.700396519913138*^9, 
   3.7003965604976587`*^9}, {3.7003965906066427`*^9, 3.700396612647242*^9}, {
   3.700396688116406*^9, 3.700396766008471*^9}, {3.7003968049321213`*^9, 
   3.70039691094622*^9}, {3.700397054749299*^9, 3.70039710365492*^9}, 
   3.700397152622591*^9, {3.700397392500225*^9, 3.700397438181683*^9}, {
   3.700397490752324*^9, 3.700397510041771*^9}, {3.7010871556151323`*^9, 
   3.701087155974077*^9}, {3.701087206205523*^9, 3.7010872065448103`*^9}, 
   3.701087404533368*^9, 3.701087434704303*^9, {3.701087579342342*^9, 
   3.7010875829327383`*^9}, {3.701087678569037*^9, 3.70108771281035*^9}, {
   3.7010877631578074`*^9, 3.701087770173099*^9}, {3.701087804657331*^9, 
   3.7010879135011177`*^9}, {3.701087944528446*^9, 3.701087951838567*^9}, 
   3.7010880104756536`*^9, {3.701088110368567*^9, 3.701088143109475*^9}, {
   3.701088293178771*^9, 3.701088379129629*^9}, {3.7010885090527573`*^9, 
   3.7010885101877737`*^9}, {3.7010887198376617`*^9, 3.701088739381483*^9}, {
   3.701089073090334*^9, 3.7010890849129133`*^9}, 3.701089152484825*^9, 
   3.70108918883291*^9, 3.701089253846817*^9, {3.701089328791985*^9, 
   3.701089358081977*^9}, 3.701089481855282*^9, 3.701089514459196*^9, {
   3.7010897031767693`*^9, 3.7010897035795517`*^9}, {3.7010898585325737`*^9, 
   3.701089876487355*^9}, {3.701090537674761*^9, 3.701090604442882*^9}, {
   3.701090744110001*^9, 3.70109074466033*^9}, {3.701090940671815*^9, 
   3.701090976541936*^9}, {3.701091196083013*^9, 3.7010911973651037`*^9}, {
   3.701091372908757*^9, 3.701091430313455*^9}, {3.701091535459571*^9, 
   3.7010915560245647`*^9}, {3.701091652852769*^9, 3.701091666329623*^9}, {
   3.7010918631224403`*^9, 3.701091863179676*^9}, {3.701093861984775*^9, 
   3.7010938827055693`*^9}, {3.701093946430955*^9, 3.7010939472141953`*^9}, {
   3.701094012254652*^9, 3.701094018290476*^9}, {3.701094129599442*^9, 
   3.701094184709098*^9}, {3.701094245682613*^9, 3.701094560431757*^9}, {
   3.701094658778802*^9, 3.701094802776205*^9}, {3.701094850668914*^9, 
   3.701094854739272*^9}, {3.701094897129724*^9, 3.701094945039769*^9}, {
   3.701095000728998*^9, 3.701095210291378*^9}, {3.701095290175902*^9, 
   3.701095320605071*^9}, {3.7010953571788387`*^9, 3.7010954586426697`*^9}, {
   3.7010955652582283`*^9, 3.7010955657395678`*^9}, {3.701095600013732*^9, 
   3.701095624524124*^9}, 3.701095787432762*^9, {3.701095823163238*^9, 
   3.701095828574436*^9}, {3.701096244536227*^9, 3.701096269892839*^9}, {
   3.701096315468917*^9, 3.70109632548929*^9}, {3.701104948697639*^9, 
   3.701104990173641*^9}, {3.7011051015026503`*^9, 3.701105187844385*^9}, {
   3.701107584642405*^9, 3.7011075847524548`*^9}, {3.701107703027706*^9, 
   3.701107703396533*^9}, {3.7011493537396173`*^9, 3.7011493847427473`*^9}, {
   3.701149429125065*^9, 3.701149430292748*^9}, {3.701149508057702*^9, 
   3.701149592303461*^9}, {3.701149640105732*^9, 3.701149647619282*^9}, {
   3.7011543440213633`*^9, 3.701154415105685*^9}, 3.70115453377503*^9, {
   3.701156400346266*^9, 3.701156401244088*^9}, {3.701161988219187*^9, 
   3.701162038055059*^9}, {3.701162295379047*^9, 3.701162296332746*^9}, {
   3.7011711951295233`*^9, 3.7011712150737133`*^9}, 3.701171304526917*^9, {
   3.701500545704092*^9, 3.701500549856077*^9}, 3.701500743583143*^9, {
   3.701501067439412*^9, 3.701501073346201*^9}, {3.701528873340972*^9, 
   3.701528874375663*^9}, {3.701528907361506*^9, 3.7015289194666452`*^9}, 
   3.701528964255611*^9, 3.702746198659548*^9},
 Background->GrayLevel[0.85],
 ExpressionUUID -> "895edc6f-5982-4677-a995-fdb13e435fec"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Documentation (alphabetical order)", "Section",
 CellChangeTimes->{{3.692974713726569*^9, 3.692974745779025*^9}, {
  3.692975725474792*^9, 3.6929757289605*^9}, {3.693048053256386*^9, 
  3.6930480564046507`*^9}, {3.6931347632003527`*^9, 3.693134766629697*^9}, {
  3.699250799957007*^9, 3.6992508018682957`*^9}, {3.700304390290905*^9, 
  3.700304394564872*^9}},ExpressionUUID->"4009a82b-8634-48ab-b894-\
d305596c1f3a"],

Cell[BoxData[
 RowBox[{"?", "EigenvaluesAtRationalApproximateRestPoint"}]], "Input",Expressi\
onUUID->"5f6e5ccc-c24e-4664-9250-22cd80bae77c"],

Cell[BoxData[
 RowBox[{"?", "ExactRestPoints"}]], "Input",
 CellChangeTimes->{{3.7003046441404457`*^9, 
  3.700304647322205*^9}},ExpressionUUID->"919d6535-b535-400d-b698-\
8b7ff2545666"],

Cell[BoxData[
 RowBox[{"?", "FloatingPointApproximateRestPoint"}]], "Input",ExpressionUUID->"17412e27-4c67-40b4-8586-c09c66b09d33"],

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{3.700414268475787*^9, 
  3.701264814841784*^9},ExpressionUUID->"18c57370-d27e-40ea-aee8-\
481567601731"],

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{
  3.701171217209049*^9},ExpressionUUID->"8d448d92-87de-4ee2-8d96-\
f82b12456944"],

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{
  3.701171218727824*^9},ExpressionUUID->"7be13048-f02f-47b4-b1b2-\
963d48c0c439"],

Cell[BoxData[
 RowBox[{"?", "GlobalStabilityOfInteriorRestPoint"}]], "Input",
 CellChangeTimes->{
  3.70030479646489*^9},ExpressionUUID->"becbdfd2-f182-459f-97ee-46b0966f8a5e"],

Cell[BoxData[
 RowBox[{"?", "InstabilityOfVertexRestPoint"}]], "Input",ExpressionUUID->"8cd12fd1-7b1b-46e1-b2f9-f5b89835e153"],

Cell[BoxData[
 RowBox[{"?", "JacobianOfMeanDynamics"}]], "Input",
 CellChangeTimes->{{3.6992509357753763`*^9, 
  3.699250940084811*^9}},ExpressionUUID->"c62a1b3d-6689-48c1-8407-\
8605ac2105f7"],

Cell[BoxData[
 RowBox[{"?", "LocalStabilityOfInteriorRestPoint"}]], "Input",
 CellChangeTimes->{{3.7003043722683783`*^9, 
  3.700304374563344*^9}},ExpressionUUID->"b73da2f1-7f56-474f-bf7c-\
02374457d46d"],

Cell[BoxData[
 RowBox[{"?", "MeanDynamics"}]], "Input",ExpressionUUID->"18435135-ad74-4876-9aa7-d685c594bf33"],

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{3.700395562625411*^9, 
  3.701264655574004*^9},ExpressionUUID->"21136c97-fb33-4c1c-9209-\
87e11d56f31f"],

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestAllMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{{3.701095856828974*^9, 3.701095860395589*^9}, 
   3.701171223981502*^9},ExpressionUUID->"2681646b-b146-4632-9b80-\
6d8612220b00"],

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestTwoMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{
  3.701171237808791*^9},ExpressionUUID->"264b53c5-2a39-4fd7-8515-\
247eff8c8ff0"],

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsWithoutFirstVariables"}]], "Input",ExpressionUUID->"57aa68c6-930a-4a40-afbc-b862af53f7a8"],

Cell[BoxData[
 RowBox[{"?", "MeshPoints"}]], "Input",
 CellChangeTimes->{
  3.700386438430668*^9},ExpressionUUID->"b12eeb83-7c86-4130-bdbc-\
c07961d93962"],

Cell[BoxData[
 RowBox[{"?", "NDSolveMeanDynamics"}]], "Input",
 CellChangeTimes->{
  3.700386538691009*^9},ExpressionUUID->"11259bf6-fb76-45f2-bd2d-\
2e3edebc1df1"],

Cell[BoxData[
 RowBox[{"?", "NDSolveMeanDynamicsTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{{3.701088782502306*^9, 3.701088786967463*^9}, 
   3.701264666633009*^9},ExpressionUUID->"810f18a1-47b9-4c99-b717-\
7e8d26bb20c9"],

Cell[BoxData[
 RowBox[{"?", "NEigenvaluesAtRationalApproximateRestPoint"}]], "Input",Express\
ionUUID->"7305dbcc-2839-42f4-a85f-87233aa886f1"],

Cell[BoxData[
 RowBox[{"?", 
  "NumericalGlobalStabilityOfInteriorRestPointLyapunov"}]], "Input",
 CellChangeTimes->{
  3.7003864781380167`*^9},ExpressionUUID->"6c2344b0-1604-412c-813b-\
79d4eb28641a"],

Cell[BoxData[
 RowBox[{"?", "NumericalGlobalStabilityOfInteriorRestPointNDSolve"}]], "Input",\

 CellChangeTimes->{
  3.7003865102802153`*^9},ExpressionUUID->"2785b9b3-20bd-47be-a15e-\
29068c5fd31b"],

Cell[BoxData[
 RowBox[{"?", "PostProjectedJacobian"}]], "Input",ExpressionUUID->"63efb794-185c-452b-8d4a-07aa5704e990"],

Cell[BoxData[
 RowBox[{"?", "ProjectedJacobian"}]], "Input",
 CellChangeTimes->{{3.6992509786366262`*^9, 
  3.699250983172744*^9}},ExpressionUUID->"66d3cbdd-0ced-4715-aa09-\
e8bda58dabed"],

Cell[BoxData[
 RowBox[{"?", "RandomPoints"}]], "Input",
 CellChangeTimes->{{3.6992510502871313`*^9, 3.6992510579610567`*^9}, 
   3.7003046570766363`*^9, {3.7003866138667088`*^9, 
   3.70038661423416*^9}},ExpressionUUID->"e7de3199-89e3-4626-a5ba-\
ae5f1d88ecfe"],

Cell[BoxData[
 RowBox[{"?", "RationalApproximateRestPoint"}]], "Input",
 CellChangeTimes->{
  3.699251070572003*^9},ExpressionUUID->"e330d837-7187-4200-88df-\
ba335f126ebb"],

Cell[BoxData[
 RowBox[{"?", "SimplexMesh"}]], "Input",
 CellChangeTimes->{
  3.700304834422792*^9},ExpressionUUID->"7ef7945b-f6cf-4a7c-baee-\
66e5ac9874b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of usage", "Section",
 CellChangeTimes->{{3.692974713726569*^9, 3.692974745779025*^9}, {
  3.692975725474792*^9, 3.6929757289605*^9}, {3.693048053256386*^9, 
  3.6930480564046507`*^9}, {3.6931347632003527`*^9, 
  3.693134766629697*^9}},ExpressionUUID->"7414cb2e-17b8-4341-8689-\
80b153edcda0"],

Cell[CellGroupData[{

Cell["Mean dynamics", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, 
   3.701500693914688*^9},ExpressionUUID->"9e4c3019-1f48-4f2d-b705-\
843878f6f6d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MeanDynamics"}]], "Input",
 PrivateCellOptions->{"InitializationCellStyle"->"InitializationCell"},
 InitializationGroup->
  False,ExpressionUUID->"55972b50-71ad-4df2-840c-eb5a8ce163cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanDynamics", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", " ", ",", "3"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696757833275291*^9, 3.69675783633934*^9}, 
   3.6968285311482077`*^9, {3.697566621512157*^9, 3.6975666263918657`*^9}, {
   3.6975667164954653`*^9, 3.69756672097267*^9}, {3.6985791848139143`*^9, 
   3.6985791861154346`*^9}, {3.699085996644328*^9, 3.699086004567419*^9}, 
   3.699086391859961*^9, {3.699251159142044*^9, 
   3.699251163899996*^9}},ExpressionUUID->"bd05a4a3-6829-410d-a8a2-\
38525195e876"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Full", " ", "simplify"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MeanDynamics", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", " ", ",", "3", ",", "True"}], 
    "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.696758701579878*^9, 3.696758741808259*^9}, 
   3.696828534037071*^9, {3.6975666312777033`*^9, 3.6975666539451723`*^9}, {
   3.6985713772512217`*^9, 3.6985713948597393`*^9}, {3.698577843949665*^9, 
   3.698577844074142*^9}, {3.698577875675652*^9, 3.6985779000678453`*^9}, {
   3.698579204117054*^9, 3.69857920425074*^9}, {3.69925117640994*^9, 
   3.699251198470785*^9}},ExpressionUUID->"ad3440c0-9e3e-4b65-866b-\
e6ed785e047e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Full", " ", "simplify", " ", "and", " ", "omit", " ", "last", " ", 
    "variable"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MeanDynamics", "[", 
    RowBox[{
    "\"\<all\>\"", ",", "\"\<min\>\"", " ", ",", "3", ",", "True", ",", 
     "True"}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.696758895726344*^9, 3.6967589006930447`*^9}, 
   3.696828534936315*^9, {3.697566684715724*^9, 3.6975666849950438`*^9}, {
   3.698571415495016*^9, 3.698571418600637*^9}, {3.6985779081869*^9, 
   3.6985779279011393`*^9}, 
   3.699251241256215*^9},ExpressionUUID->"f0b58740-c1d4-4891-b7e5-\
a60caedbca5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanDynamicsWithoutFirstVariables", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", " ", ",", "3"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696758951489704*^9, 3.6967589518138742`*^9}, 
   3.6968285369273663`*^9, {3.697566694850284*^9, 3.697566695097917*^9}, {
   3.698577504700392*^9, 3.698577516990684*^9}, {3.698579286512802*^9, 
   3.698579286654958*^9}, {3.698579346615346*^9, 3.698579347495015*^9}, 
   3.699251252325438*^9, {3.6992512894046497`*^9, 
   3.6992512895734777`*^9}},ExpressionUUID->"a19fbad9-9aa5-4585-8a13-\
1969e35be166"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Full", " ", "simplify"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MeanDynamicsWithoutFirstVariables", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", " ", ",", "3", ",", "True"}], 
    "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.699251272090774*^9, 
  3.699251298528042*^9}},ExpressionUUID->"28e7b5e1-910f-489d-8ec7-\
bb62a0f23b8a"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Jacobians", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
  3.6992521026445217`*^9}},ExpressionUUID->"8d79524b-d133-4787-ae06-\
66695923ddfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "JacobianOfMeanDynamics"}]], "Input",
 CellChangeTimes->{
  3.696758905175666*^9, {3.696828538153616*^9, 3.696828540403294*^9}, {
   3.6975668181633167`*^9, 3.697566818432249*^9}, {3.699085976234358*^9, 
   3.699085976910755*^9}, {3.699251310420479*^9, 3.6992513191818113`*^9}, {
   3.699251563687896*^9, 3.699251565418888*^9}, 
   3.699252107302805*^9},ExpressionUUID->"664becc5-5ae8-4175-ade0-\
e15cea13866f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JacobianOfMeanDynamics", "[", 
   RowBox[{"MeanDynamics", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.696758905175666*^9, {3.696828538153616*^9, 3.696828540403294*^9}, {
   3.6975668181633167`*^9, 3.697566818432249*^9}, {3.699085976234358*^9, 
   3.699085976910755*^9}, {3.699251310420479*^9, 3.6992513191818113`*^9}, {
   3.699251563687896*^9, 3.699251565418888*^9}, {3.699252107302805*^9, 
   3.6992521280919867`*^9}},ExpressionUUID->"7554b34a-218f-49bb-b5ae-\
73f3002d2d91"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ProjectedJacobian"}]], "Input",
 CellChangeTimes->{
  3.696763330784102*^9, 3.696828541359873*^9, {3.697566835656211*^9, 
   3.697566836173965*^9}, {3.699251855363674*^9, 3.699251875555171*^9}, {
   3.699252136294084*^9, 
   3.699252146282957*^9}},ExpressionUUID->"51b49342-ab63-45bb-af9a-\
b0c133b0c3d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProjectedJacobian", "[", 
   RowBox[{"MeanDynamics", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.696763330784102*^9, 3.696828541359873*^9, {3.697566835656211*^9, 
   3.697566836173965*^9}, {3.699251855363674*^9, 3.699251875555171*^9}, {
   3.699252136294084*^9, 
   3.699252146282957*^9}},ExpressionUUID->"c44ff677-587c-4c3a-adb0-\
d8d4f89d9c1f"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "PostProjectedJacobian"}]], "Input",
 CellChangeTimes->{
  3.696763330784102*^9, 3.696828541359873*^9, {3.697566835656211*^9, 
   3.697566836173965*^9}, {3.699251855363674*^9, 3.699251875555171*^9}, {
   3.699252136294084*^9, 3.699252146282957*^9}, {3.7015021867664747`*^9, 
   3.701502187429934*^9}},ExpressionUUID->"51b49342-ab63-45bb-af9a-\
b0c133b0c3d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PostProjectedJacobian", "[", 
   RowBox[{"MeanDynamics", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3"}], "]"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.696763330784102*^9, 3.696828541359873*^9, {3.697566835656211*^9, 
   3.697566836173965*^9}, {3.699251855363674*^9, 3.699251875555171*^9}, {
   3.699252136294084*^9, 3.699252146282957*^9}, 
   3.701502191514985*^9},ExpressionUUID->"c44ff677-587c-4c3a-adb0-\
d8d4f89d9c1f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exact rest points", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
  3.6992521026445217`*^9}, {3.699252184748106*^9, 
  3.699252189020989*^9}},ExpressionUUID->"28909755-57a8-452d-a854-\
0314ae2e2769"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "ExactRestPoints"}]], "Input",
 CellChangeTimes->{
  3.696826966008967*^9},ExpressionUUID->"b221a4bb-90d9-4e47-97e3-\
3fa5ccb60afc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3"}], "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Don", "'"}], "t", " ", "use", " ", "FullSimplify", " ", "and", 
    " ", 
    RowBox[{"don", "'"}], "t", " ", "omit", " ", "last", " ", "variables", 
    " ", 
    RowBox[{"(", 
     RowBox[{"default", " ", "setting"}], ")"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.696763434886462*^9, 3.6967634349733143`*^9}, {
   3.696827305884056*^9, 3.696827335020677*^9}, {3.699252345306491*^9, 
   3.69925236106568*^9}, 3.699252422411091*^9, {3.7028986326751966`*^9, 
   3.702898662003931*^9}},
 ExpressionUUID -> "775d24ad-61ec-4547-8f6c-c80fb8b32d15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{
   "\"\<all\>\"", ",", "\"\<min\>\"", ",", "3", ",", "False", ",", "False", 
    ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696763494474782*^9, 3.6967635097449217`*^9}, {
  3.69682719531887*^9, 3.696827201427375*^9}, {3.699252379436769*^9, 
  3.699252400788824*^9}, {3.699252456510703*^9, 
  3.69925246079608*^9}},ExpressionUUID->"e6428bd9-7d98-43ab-9c1a-\
f2254dc2c68b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Use", " ", "FullSimplify", " ", "and", " ", 
    RowBox[{"don", "'"}], "t", " ", "omit", " ", "last", " ", "variables"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3", ",", "True"}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.6968270043942137`*^9, 3.696827012021031*^9}, {
  3.6968270779811287`*^9, 3.6968270820967007`*^9}, {3.696827363349539*^9, 
  3.696827373443224*^9}, {3.699252433390669*^9, 
  3.6992524496145906`*^9}},ExpressionUUID->"b4294e82-8b0c-4902-84a6-\
24d5294bbfe3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Use", " ", "FullSimplify", " ", "and", " ", "omit", " ", "last", " ", 
    "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{
   "\"\<all\>\"", ",", "\"\<min\>\"", ",", "3", ",", "True", ",", "True"}], 
   "]"}], " "}]], "Input",
 CellChangeTimes->{{3.696827107140806*^9, 3.696827109502543*^9}, {
  3.69682740041921*^9, 3.696827404763636*^9}, {3.699252470999774*^9, 
  3.699252483408498*^9}},ExpressionUUID->"9a9e1e69-9c80-4d3c-ab41-\
dff61819d232"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Don", "'"}], "t", " ", "use", " ", "FullSimplify", " ", "and", 
    " ", "omit", " ", "last", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{
   "\"\<all\>\"", ",", "\"\<min\>\"", ",", "3", ",", "False", ",", "True"}], 
   "]"}], " "}]], "Input",
 CellChangeTimes->{{3.696827124421051*^9, 3.6968271264449453`*^9}, {
  3.696828251257802*^9, 3.6968282586141233`*^9}, {3.699252533582182*^9, 
  3.699252543550913*^9}},ExpressionUUID->"8afcdd4b-17d7-4c6e-940f-\
83dd6715bb16"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Approximate rest points", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
  3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
  3.6992526135049143`*^9, 
  3.699252615121192*^9}},ExpressionUUID->"9ce207e4-8487-4183-873a-\
4baed98d6b52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "FloatingPointApproximateRestPoint"}]], "Input",
 CellChangeTimes->{{3.699252836307085*^9, 
  3.699252841244793*^9}},ExpressionUUID->"50a9c823-a7eb-45c0-8902-\
7d33d8857c40"],

Cell[BoxData[{
 RowBox[{"FloatingPointApproximateRestPoint", "[", 
  RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "10"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PlotOutcomes", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6967637160838327`*^9, 3.696763723174424*^9}, {
   3.696763787065752*^9, 3.69676380369665*^9}, {3.696763870809512*^9, 
   3.696763874983334*^9}, {3.696764006117873*^9, 3.696764034822093*^9}, 
   3.699252635203582*^9, {3.6992529004195766`*^9, 3.6992529043327837`*^9}, {
   3.7028986836485558`*^9, 3.702898685899592*^9}, {3.702899071193039*^9, 
   3.702899228277614*^9}, {3.702899262591457*^9, 3.702899344222657*^9}, {
   3.702899716005344*^9, 3.7028997336989594`*^9}, {3.7028997852723513`*^9, 
   3.7028998740457582`*^9}, {3.7028999062110033`*^9, 3.70290005577975*^9}, {
   3.702900092850239*^9, 3.702900403183672*^9}, {3.702900515022032*^9, 
   3.702900579709094*^9}, {3.702900622337081*^9, 3.702900979706992*^9}, {
   3.70290121394713*^9, 3.702901261578773*^9}, {3.702901339644635*^9, 
   3.702901341657295*^9}, {3.702901406617373*^9, 3.702901428778882*^9}},
 ExpressionUUID -> "42161e99-2fa4-4e39-93e2-43cc4547f126"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RationalApproximateRestPoint"}]], "Input",
 CellChangeTimes->{{3.699252957624881*^9, 
  3.699252960740858*^9}},ExpressionUUID->"5466cefc-abe3-4f21-acf3-\
9f91c6533b82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RationalApproximateRestPoint", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "10"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6967640589850483`*^9, 3.6967640921847467`*^9}, 
   3.699252638128577*^9, {3.69925322574279*^9, 3.6992532717646313`*^9}},
 ExpressionUUID -> "0eb97416-91c3-484c-847e-c2ca1b741753"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigenvalues", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
  3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
  3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
  3.699252659097137*^9}},ExpressionUUID->"f8ed45a1-5df6-415c-a521-\
df54c6dd4851"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "EigenvaluesAtRationalApproximateRestPoint"}]], "Input",
 CellChangeTimes->{
  3.696764130752492*^9, {3.697565077110173*^9, 3.6975650861879053`*^9}, 
   3.6992536200285873`*^9, 3.699253737182864*^9, 3.69925377698466*^9, {
   3.69925386340763*^9, 3.699253884466263*^9}, {3.6994523476293097`*^9, 
   3.699452352150518*^9}, {3.69945591555464*^9, 3.6994559202556267`*^9}, {
   3.69945682656583*^9, 3.699456826628004*^9}, 3.699586069021676*^9, {
   3.699587330517559*^9, 3.699587330778451*^9}, 3.699588208578471*^9, {
   3.699590206504345*^9, 
   3.699590215946868*^9}},ExpressionUUID->"54f0c67f-bbe7-43dd-9c79-\
b24f29cd2312"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "6"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.696764130752492*^9, {3.697565077110173*^9, 3.6975650861879053`*^9}, 
   3.6992536200285873`*^9, 3.699253737182864*^9, 3.69925377698466*^9, {
   3.69925386340763*^9, 3.699253884466263*^9}, {3.6994523476293097`*^9, 
   3.699452352150518*^9}, {3.69945591555464*^9, 3.6994559202556267`*^9}, {
   3.69945682656583*^9, 3.699456826628004*^9}, 3.699586069021676*^9, {
   3.699587330517559*^9, 3.699587330778451*^9}, 3.699588208578471*^9, {
   3.699590206504345*^9, 3.699590215946868*^9}, {3.6995904245059347`*^9, 
   3.699590424575776*^9}, {3.699611790302236*^9, 
   3.699611827925509*^9}},ExpressionUUID->"2d3918f0-efb0-4e76-8098-\
40f0a512befc"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "NEigenvaluesAtRationalApproximateRestPoint"}]], "Input",
 CellChangeTimes->{{3.699586096731038*^9, 3.6995861222264433`*^9}, {
  3.699590250392519*^9, 
  3.6995902570878057`*^9}},ExpressionUUID->"e48664c1-5a5a-407f-bcb3-\
892438ac50b8"],

Cell[BoxData[
 RowBox[{"NEigenvaluesAtRationalApproximateRestPoint", "[", 
  RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "12"}], "]"}]], "Input",
 CellChangeTimes->{{3.699586096731038*^9, 3.6995861222264433`*^9}, {
   3.699590250392519*^9, 3.699590252559622*^9}, {3.6995902974575987`*^9, 
   3.699590366476562*^9}, 3.6997035569705153`*^9, {3.701161228122764*^9, 
   3.701161228244066*^9}, {3.701161261644826*^9, 3.701161262983204*^9}, {
   3.701161743577592*^9, 
   3.701161743712481*^9}},ExpressionUUID->"ef137e65-4b1b-4ec1-b22e-\
2c65a3f45fe6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Local stability of interior rest point (perturbation theorem)\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 
   3.7001444666746273`*^9},ExpressionUUID->"35d4ae3b-0cee-4b91-9b90-\
89a9190c9fa3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "LocalStabilityOfInteriorRestPoint"}]], "Input",
 CellChangeTimes->{{3.700206801297105*^9, 
  3.700206825639812*^9}},ExpressionUUID->"02849dfa-bf73-4582-96c7-\
6032d5fb1146"],

Cell[BoxData[
 RowBox[{"LocalStabilityOfInteriorRestPoint", "[", 
  RowBox[{"\"\<two\>\"", ",", "\"\<stick\>\"", ",", "6"}], "]"}]], "Input",
 CellChangeTimes->{{3.700206801297105*^9, 3.700206856082016*^9}, {
  3.700206915911201*^9, 
  3.7002069933196983`*^9}},ExpressionUUID->"25e44fa7-d662-47e8-8588-\
06e727571d49"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Global stability of interior rest point (exact Lyapunov function)\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 
   3.700144480546052*^9},ExpressionUUID->"e58618c9-c208-45cc-af3e-\
4fb1400091ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "GlobalStabilityOfInteriorRestPoint"}]], "Input",
 CellChangeTimes->{
  3.700207539356524*^9, {3.7002075754343157`*^9, 
   3.700207578561905*^9}},ExpressionUUID->"6e4f5391-f4be-417c-be55-\
92e870e0aa9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GlobalStabilityOfInteriorRestPoint", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "3"}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{
  3.700207539356524*^9, {3.7002075754343157`*^9, 
   3.7002076053661633`*^9}},ExpressionUUID->"28e2ecc3-900d-4921-a145-\
21b82b6d0067"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Creation of points in the simplices", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144480546052*^9, {3.701499467583372*^9, 
   3.70149949854115*^9}},ExpressionUUID->"e58618c9-c208-45cc-af3e-\
4fb1400091ef"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MeshPoints"}]], "Input",
 CellChangeTimes->{
  3.700209885784938*^9, {3.700210252750572*^9, 3.700210254525914*^9}, {
   3.700217296158725*^9, 3.700217296566341*^9}, {3.700218010411179*^9, 
   3.70021802822936*^9}},ExpressionUUID->"1badf326-8465-4c0a-af66-\
39b3ce50a171"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"MeshPoints", "[", 
    RowBox[{"20", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<We have created \>\"", ",", 
    RowBox[{"Length", "[", "points", "]"}], ",", " ", "\"\< points\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"points", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "30"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.700218023195176*^9, 3.700218072731091*^9}, {
   3.700218189973974*^9, 3.700218215501642*^9}, 3.7011548955202503`*^9, {
   3.701499129069511*^9, 3.70149913298069*^9}, {3.701499626793486*^9, 
   3.701499651689027*^9}},ExpressionUUID->"3e4030d6-731a-4b81-939d-\
06f00294a1d7"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RandomPoints"}]], "Input",ExpressionUUID->"f54b9c44-f2df-4c49-9355-bc12d7574658"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"points", "=", 
   RowBox[{"RandomPoints", "[", 
    RowBox[{"20", ",", 
     RowBox[{"10", "^", "6"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<We have created \>\"", ",", 
    RowBox[{"Length", "[", "points", "]"}], ",", " ", "\"\< points\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"points", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "30"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.700218170195838*^9, 3.700218184091564*^9}, {
  3.700218268384533*^9, 3.7002182684812593`*^9}, {3.700218304614791*^9, 
  3.700218305789566*^9}, {3.701499357117332*^9, 3.7014993572063427`*^9}, {
  3.701499589060611*^9, 3.701499606024826*^9}, {3.701499660441597*^9, 
  3.701499670240818*^9}},ExpressionUUID->"7b67ea5a-2b1b-4432-8b5d-\
1eeddfef136e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Numerical global stability of interior rest point (numerical evaluation of an \
approximate Lyapunov function)\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 
   3.700144501718858*^9},ExpressionUUID->"6bd999bd-8142-47d1-9f29-\
dc9536222bf0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", 
  "NumericalGlobalStabilityOfInteriorRestPointLyapunov"}]], "Input",
 CellChangeTimes->{{3.700210262550235*^9, 3.700210265784132*^9}, {
   3.7002152581203413`*^9, 3.7002153059122467`*^9}, 3.700215344656228*^9, {
   3.700215405607229*^9, 3.70021541744563*^9}, {3.700215468072336*^9, 
   3.70021547067591*^9}, {3.700215586779104*^9, 3.7002155908069077`*^9}, {
   3.7002158521641617`*^9, 3.7002158522585497`*^9}, {3.7002159546987963`*^9, 
   3.70021596716007*^9}, {3.70021603200462*^9, 3.7002160322252502`*^9}, {
   3.700216327034216*^9, 3.700216333841016*^9}, {3.700217170319777*^9, 
   3.7002172173153*^9}, {3.700217269967248*^9, 3.70021733312628*^9}, {
   3.700218008542409*^9, 3.7002180160104647`*^9}, {3.700218114360363*^9, 
   3.700218123540133*^9}},ExpressionUUID->"d8ffb0a0-1e8b-4671-bb24-\
48d047021597"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Numerically", " ", "check", " ", "the", " ", "global", " ", "stability", 
    " ", "of", " ", "the", " ", "interior", " ", "rest", " ", "point", " ", 
    "evaluating", " ", "the", " ", "tentative", " ", "Lyapunov", " ", 
    "function", " ", "on", " ", "a", " ", "grid", " ", "with", " ", "mesh", 
    " ", 
    RowBox[{"1", "/", "4"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<stick\>\"", ",", "20", ",", 
    RowBox[{"MeshPoints", "[", 
     RowBox[{"20", ",", "4"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700210262550235*^9, 3.700210265784132*^9}, {
   3.7002152581203413`*^9, 3.7002153059122467`*^9}, 3.700215344656228*^9, {
   3.700215405607229*^9, 3.70021541744563*^9}, {3.700215468072336*^9, 
   3.70021547067591*^9}, {3.700215586779104*^9, 3.7002155908069077`*^9}, {
   3.7002158521641617`*^9, 3.7002158522585497`*^9}, {3.7002159546987963`*^9, 
   3.70021596716007*^9}, {3.70021603200462*^9, 3.7002160322252502`*^9}, {
   3.700216327034216*^9, 3.700216333841016*^9}, {3.700217170319777*^9, 
   3.7002172173153*^9}, {3.700217269967248*^9, 3.70021733312628*^9}, {
   3.700218008542409*^9, 3.7002180160104647`*^9}, {3.700218114360363*^9, 
   3.700218123540133*^9}, {3.7014990764734898`*^9, 3.701499088227951*^9}, {
   3.7014991489336967`*^9, 3.7014992521528273`*^9}, {3.7014992887617598`*^9, 
   3.701499294430757*^9}},ExpressionUUID->"42f0fdf7-54c5-4c35-852d-\
2b9d99ce4a30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Numerically", " ", "check", " ", "the", " ", "global", " ", "stability", 
    " ", "of", " ", "the", " ", "interior", " ", "rest", " ", "point", " ", 
    "evaluating", " ", "the", " ", "tentative", " ", "Lyapunov", " ", 
    "function", " ", "on", " ", 
    RowBox[{"10", "^", "6"}], " ", "random", " ", "points"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
   RowBox[{"\"\<all\>\"", ",", "\"\<stick\>\"", ",", "20", ",", 
    RowBox[{"RandomPoints", "[", 
     RowBox[{"20", ",", 
      RowBox[{"10", "^", "6"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700210262550235*^9, 3.700210265784132*^9}, {
   3.7002152581203413`*^9, 3.7002153059122467`*^9}, 3.700215344656228*^9, {
   3.700215405607229*^9, 3.70021541744563*^9}, {3.700215468072336*^9, 
   3.70021547067591*^9}, {3.700215586779104*^9, 3.7002155908069077`*^9}, {
   3.7002158521641617`*^9, 3.7002158522585497`*^9}, {3.7002159546987963`*^9, 
   3.70021596716007*^9}, {3.70021603200462*^9, 3.7002160322252502`*^9}, {
   3.700216327034216*^9, 3.700216333841016*^9}, {3.700217170319777*^9, 
   3.7002172173153*^9}, {3.700217269967248*^9, 3.70021733312628*^9}, {
   3.700218008542409*^9, 3.7002180160104647`*^9}, {3.700218114360363*^9, 
   3.700218123540133*^9}, {3.7014990764734898`*^9, 3.701499088227951*^9}, {
   3.7014991489336967`*^9, 3.7014992521528273`*^9}, {3.7014992887617598`*^9, 
   3.701499294430757*^9}, {3.701499829026339*^9, 
   3.7014998550346403`*^9}},ExpressionUUID->"42f0fdf7-54c5-4c35-852d-\
2b9d99ce4a30"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical global stability of interior rest point (NDSolve)", \
"Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
  3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
  3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
  3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
  3.699252659097137*^9}, {3.700144501718858*^9, 
  3.7001445260864267`*^9}},ExpressionUUID->"4014ac41-5062-4e61-8a80-\
84c6efef47e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "NumericalGlobalStabilityOfInteriorRestPointNDSolve"}]], "Input",\

 CellChangeTimes->{
  3.700209885784938*^9, {3.700210252750572*^9, 3.700210254525914*^9}, {
   3.700216743047917*^9, 3.700216744300583*^9}, {3.700217550594792*^9, 
   3.700217555372739*^9}, {3.7002182837410297`*^9, 
   3.700218284059741*^9}},ExpressionUUID->"44e7ee4c-64cd-4e82-9a4d-\
7b0f830708db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Numerically", " ", "check", " ", "the", " ", "global", " ", "stability", 
    " ", "of", " ", "the", " ", "interior", " ", "rest", " ", "point", " ", 
    "using", " ", "NDSolve", " ", "starting", " ", "on", " ", "1000", " ", 
    "random", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NumericalGlobalStabilityOfInteriorRestPointNDSolve", "[", 
   RowBox[{"\"\<adj\>\"", ",", "\"\<stick\>\"", ",", "10", ",", 
    RowBox[{"RandomPoints", "[", 
     RowBox[{"10", ",", "1000"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700210262550235*^9, 3.700210265784132*^9}, {
   3.7002152581203413`*^9, 3.7002153059122467`*^9}, 3.700215344656228*^9, {
   3.700215405607229*^9, 3.70021541744563*^9}, {3.700215468072336*^9, 
   3.70021547067591*^9}, {3.700215586779104*^9, 3.7002155908069077`*^9}, {
   3.7002158521641617`*^9, 3.7002158522585497`*^9}, {3.7002159546987963`*^9, 
   3.70021596716007*^9}, {3.70021603200462*^9, 3.7002160322252502`*^9}, {
   3.700216327034216*^9, 3.700216333841016*^9}, 3.7002167481456203`*^9, {
   3.7002170561278143`*^9, 3.700217117852665*^9}, 3.700217591047305*^9, {
   3.700218290954096*^9, 3.700218298438528*^9}, {3.70029288851003*^9, 
   3.700292888576305*^9}, {3.700292981075736*^9, 3.700292981243575*^9}, {
   3.7015000976229353`*^9, 
   3.701500153837895*^9}},ExpressionUUID->"3a13e1b2-9a40-4464-9b37-\
050331d800b5"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerically solve mean dynamics", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144501718858*^9, 
   3.700144554976672*^9},ExpressionUUID->"72ad96c2-56ea-439b-b3e6-\
9734ed949d08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "NDSolveMeanDynamics"}]], "Input",
 CellChangeTimes->{
  3.700220237849874*^9},ExpressionUUID->"d2942d15-cc06-4916-b8e8-\
1923f9648ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NDSolveMeanDynamics", "[", 
    RowBox[{"\"\<adj\>\"", ",", "\"\<min\>\"", " ", ",", "20"}], "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"by", " ", "default"}], ",", " ", 
    RowBox[{"the", " ", "initial", " ", "point", " ", "is", " ", "random"}]}],
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.70022025367246*^9, 3.7002202631501083`*^9}, {
   3.700220315192699*^9, 3.700220330006914*^9}, 
   3.700221130438261*^9},ExpressionUUID->"ae4abd7a-081b-4224-ac3f-\
343865a276ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"initialPoint", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.99", ",", "0.01"}], "}"}], ",", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], "]"}], ",", 
     RowBox[{"PadRight", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.99", ",", "0.01"}], "}"}], ",", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Initial point created: \>\"", ",", " ", "initialPoint"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NDSolveMeanDynamics", "[", 
  RowBox[{
  "\"\<adj\>\"", ",", "\"\<min\>\"", " ", ",", "d", ",", "initialPoint"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.700220768016574*^9, 3.7002208007682543`*^9}, {
   3.700221070210244*^9, 3.7002210837532063`*^9}, {3.701091707809669*^9, 
   3.7010917414155903`*^9}, 3.7011727277320147`*^9, 
   3.7011731368751183`*^9},ExpressionUUID->"97245497-3f84-42a4-93e9-\
add113ecc8c6"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Instability of the backward induction state (i.e. the vertex rest point)\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144501718858*^9, {3.700144564359458*^9, 
   3.700144576935203*^9}, 3.7001447301085443`*^9, {3.700144844182732*^9, 
   3.700144858030829*^9}, 
   3.7010870677849503`*^9},ExpressionUUID->"5e009aeb-48ed-4bbf-b1a7-\
15644be7efd3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "InstabilityOfVertexRestPoint"}]], "Input",
 CellChangeTimes->{3.7002858033390417`*^9, 
  3.700303910260881*^9},ExpressionUUID->"69c1e0dd-ceee-4e19-85fd-\
339f033f19cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InstabilityOfVertexRestPoint", "[", 
   RowBox[{"\"\<adj\>\"", ",", "\"\<min\>\"", ",", "10"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7003035108154163`*^9, 3.7003035490741053`*^9}, 
   3.7015236956327333`*^9},ExpressionUUID->"7f8b20e1-1347-4d33-b3aa-\
008232ed2a5b"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"InstabilityOfVertexRestPoint", "[", 
    RowBox[{"\"\<all\>\"", ",", "\"\<min\>\"", ",", "d", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "3", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.700285806474608*^9, 3.700303506720708*^9, {3.700303980983807*^9, 
   3.7003039867373657`*^9}, {3.701523755485496*^9, 
   3.7015237571804037`*^9}},ExpressionUUID->"ae1e37d0-24b6-4d8a-a846-\
cd81a2308afa"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Larger number of trials (only test-all, min-if-tie) ", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144501718858*^9, 3.700144554976672*^9, {
   3.7002930860067577`*^9, 
   3.700293099133706*^9}},ExpressionUUID->"72ad96c2-56ea-439b-b3e6-\
9734ed949d08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{3.700220237849874*^9, 3.700293115245428*^9, 
  3.701264678164495*^9},ExpressionUUID->"d2942d15-cc06-4916-b8e8-\
1923f9648ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
   RowBox[{"4", ",", "20"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.70022025367246*^9, 3.7002202631501083`*^9}, {
   3.700220315192699*^9, 3.700220330006914*^9}, 3.700221130438261*^9, {
   3.700293117045051*^9, 3.70029313026215*^9}, {3.700293162303844*^9, 
   3.700293209080339*^9}, {3.700293463131274*^9, 3.70029346322003*^9}, 
   3.701264682597108*^9},ExpressionUUID->"ae4abd7a-081b-4224-ac3f-\
343865a276ba"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MeanDynamicsTestAllMinIfTieManyTrials", "[", 
       RowBox[{"d", ",", "1", ",", "0"}], "]"}], "==", 
      RowBox[{"MeanDynamics", "[", 
       RowBox[{
       "\"\<all\>\"", ",", "\"\<min\>\"", ",", "d", ",", "False", ",", 
        "False", ",", "0"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"y", "[", "j", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]",
    ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "2", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.700397614587245*^9, 3.700397627995607*^9}, 
   3.701264685387374*^9},ExpressionUUID->"30b217e4-406f-4bb2-ad47-\
924a730fe453"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{{3.700397618271366*^9, 3.700397644533214*^9}, 
   3.701264845194633*^9},ExpressionUUID->"63f0fd15-71ee-4ccc-93cc-\
be12bea65457"],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPointTestAllMinIfTieManyTrials", "[", 
  RowBox[{"4", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.700220768016574*^9, 3.7002208007682543`*^9}, {
   3.700221070210244*^9, 3.7002210837532063`*^9}, {3.700293295451186*^9, 
   3.700293317396587*^9}, {3.7002936475871363`*^9, 3.700293653077141*^9}, {
   3.700395696431035*^9, 3.700395771769454*^9}, {3.7003976212277946`*^9, 
   3.7003976231008987`*^9}, {3.700397655938086*^9, 3.700397668468985*^9}, {
   3.700397736296372*^9, 3.700397736428658*^9}, 
   3.7012648495147467`*^9},ExpressionUUID->"97245497-3f84-42a4-93e9-\
add113ecc8c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", "1", "]"}], ",", 
     RowBox[{"x", "[", "2", "]"}], ",", 
     RowBox[{"x", "[", "3", "]"}], ",", 
     RowBox[{"y", "[", "1", "]"}], ",", 
     RowBox[{"y", "[", "2", "]"}], ",", 
     RowBox[{"y", "[", "3", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"vars", "/.", 
       RowBox[{
       "FloatingPointApproximateRestPointTestAllMinIfTieManyTrials", "[", 
        RowBox[{"4", ",", "trials", ",", "0"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"trials", ",", "1", ",", "30"}], "}"}]}], "]"}], 
    "\[Transpose]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.700414314890171*^9, 3.700414502671083*^9}, {
   3.700414547160038*^9, 3.7004146443822803`*^9}, {3.700414719567834*^9, 
   3.7004147209616547`*^9}, 3.700414814091193*^9, {3.7010919321364717`*^9, 
   3.7010919343391123`*^9}, 3.701092287642046*^9, 
   3.7012648546897793`*^9},ExpressionUUID->"b8993fc3-efa1-4601-af08-\
db4cf09eb02a"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "NDSolveMeanDynamicsTestAllMinIfTieManyTrials"}]], "Input",
 CellChangeTimes->{{3.701088823010655*^9, 3.70108883150559*^9}, 
   3.701264688233261*^9},ExpressionUUID->"50f522b4-255f-4c1a-bde7-\
65e33474e049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NDSolveMeanDynamicsTestAllMinIfTieManyTrials", "[", 
   RowBox[{"4", ",", "10"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.701088820615197*^9, 3.701088850561327*^9}, {
   3.701089636466764*^9, 3.7010896723754063`*^9}, 3.7010897450167217`*^9, {
   3.701089775581428*^9, 3.701089778000194*^9}, 3.701089899668239*^9, {
   3.701089993165557*^9, 3.701089993243134*^9}, {3.701091793413227*^9, 
   3.701091793918563*^9}, {3.701091825395553*^9, 3.701091844778777*^9}, 
   3.701091885954566*^9, 
   3.701264692182096*^9},ExpressionUUID->"f918f814-c64f-4a9f-a0fd-\
e653c402f88c"],

Cell[BoxData[
 RowBox[{"NDSolveMeanDynamicsTestAllMinIfTieManyTrials", "[", 
  RowBox[{"4", ",", "10", ",", 
   RowBox[{"{", 
    RowBox[{
    "0.99", ",", "0.01", ",", "0", ",", "0.99", ",", "0.01", ",", "0"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701089628802464*^9, 3.701089630885854*^9}, {
   3.7010900184557753`*^9, 3.701090040212*^9}, {3.701090070802128*^9, 
   3.701090100308694*^9}, {3.7011723078877993`*^9, 3.701172327609497*^9}, 
   3.7011726692313967`*^9, {3.701172952768268*^9, 3.701172959764368*^9}, 
   3.701264694803239*^9},ExpressionUUID->"be71c8f6-e5eb-4f8e-b591-\
8df7ae645b26"],

Cell[BoxData[
 RowBox[{"NDSolveMeanDynamicsTestAllMinIfTieManyTrials", "[", 
  RowBox[{"4", ",", "35", ",", 
   RowBox[{"{", 
    RowBox[{
    "0.99", ",", "0.01", ",", "0", ",", "0.99", ",", "0.01", ",", "0"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.701089628802464*^9, 3.701089630885854*^9}, {
   3.7010900184557753`*^9, 3.701090040212*^9}, {3.701090070802128*^9, 
   3.701090100308694*^9}, 3.701172291249942*^9, {3.7011723415497437`*^9, 
   3.701172367986992*^9}, 3.701172538426152*^9, 3.701172962035943*^9, 
   3.701264697110132*^9},ExpressionUUID->"bfc382bf-6ec3-4c15-99ee-\
cb9ebf9789d4"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Introduction of backward induction agents, with the other agents using \
test-all, min-if-tie\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144501718858*^9, 3.700144554976672*^9, {
   3.7002930860067577`*^9, 3.700293099133706*^9}, 3.701095726051642*^9, {
   3.701149231856269*^9, 
   3.701149239449317*^9}},ExpressionUUID->"72ad96c2-56ea-439b-b3e6-\
9734ed949d08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestAllMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{
  3.700220237849874*^9, 3.700293115245428*^9, 3.701095744544942*^9, 
   3.701171245930552*^9, {3.701172804236044*^9, 
   3.701172805130662*^9}},ExpressionUUID->"d2942d15-cc06-4916-b8e8-\
1923f9648ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanDynamicsTestAllMinIfTieWithBIAgents", "[", 
   RowBox[{"4", ",", "0.2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.70022025367246*^9, 3.7002202631501083`*^9}, {
   3.700220315192699*^9, 3.700220330006914*^9}, 3.700221130438261*^9, {
   3.700293117045051*^9, 3.70029313026215*^9}, {3.700293162303844*^9, 
   3.700293209080339*^9}, {3.700293463131274*^9, 3.70029346322003*^9}, 
   3.701095770644264*^9, {3.701095879082066*^9, 3.7010959008718452`*^9}, {
   3.701095936941671*^9, 3.701095940853799*^9}, {3.701096081364208*^9, 
   3.701096084075688*^9}, {3.701096124027149*^9, 3.701096145229765*^9}, {
   3.701156101974242*^9, 3.7011561120307407`*^9}, 
   3.7011712491819077`*^9},ExpressionUUID->"ae4abd7a-081b-4224-ac3f-\
343865a276ba"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MeanDynamicsTestAllMinIfTieWithBIAgents", "[", 
       RowBox[{"d", ",", "0", ",", "0"}], "]"}], "==", 
      RowBox[{"MeanDynamics", "[", 
       RowBox[{
       "\"\<all\>\"", ",", "\"\<min\>\"", ",", "d", ",", "False", ",", 
        "False", ",", "0"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"y", "[", "j", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]",
    ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "2", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.700397614587245*^9, 3.700397627995607*^9}, {
   3.701095916072111*^9, 3.70109592919916*^9}, {3.701095997655593*^9, 
   3.701096047659676*^9}, {3.7010961009294147`*^9, 3.701096136736059*^9}, {
   3.701154256323084*^9, 3.701154259742908*^9}, {3.701154501817527*^9, 
   3.701154501872609*^9}, 
   3.701171250610876*^9},ExpressionUUID->"30b217e4-406f-4bb2-ad47-\
924a730fe453"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{{3.700397618271366*^9, 3.700397644533214*^9}, 
   3.701095991863695*^9, 
   3.7011712523655443`*^9},ExpressionUUID->"63f0fd15-71ee-4ccc-93cc-\
be12bea65457"],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents", "[", 
  
  RowBox[{"4", ",", "0.2"}], "]"}]], "Input",
 CellChangeTimes->{{3.700220768016574*^9, 3.7002208007682543`*^9}, {
   3.700221070210244*^9, 3.7002210837532063`*^9}, {3.700293295451186*^9, 
   3.700293317396587*^9}, {3.7002936475871363`*^9, 3.700293653077141*^9}, {
   3.700395696431035*^9, 3.700395771769454*^9}, {3.7003976212277946`*^9, 
   3.7003976231008987`*^9}, {3.700397655938086*^9, 3.700397668468985*^9}, {
   3.700397736296372*^9, 3.700397736428658*^9}, {3.701096188891738*^9, 
   3.7010962337998123`*^9}, {3.701096339696067*^9, 3.701096394065462*^9}, {
   3.7011047774027452`*^9, 3.701104777582353*^9}, {3.7011048597518463`*^9, 
   3.7011048599756317`*^9}, {3.701105234327215*^9, 3.7011052471958857`*^9}, 
   3.701107754662274*^9, {3.70110779532047*^9, 3.7011078313319483`*^9}, {
   3.701156185244693*^9, 3.701156193389629*^9}, 
   3.701171253434421*^9},ExpressionUUID->"97245497-3f84-42a4-93e9-\
add113ecc8c6"],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents", "[", 
  
  RowBox[{"4", ",", "0.3", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.700414314890171*^9, 3.700414502671083*^9}, {
   3.700414547160038*^9, 3.7004146443822803`*^9}, {3.700414719567834*^9, 
   3.7004147209616547`*^9}, 3.700414814091193*^9, {3.7010919321364717`*^9, 
   3.7010919343391123`*^9}, 3.701092287642046*^9, {3.7011052974509687`*^9, 
   3.7011053170577517`*^9}, {3.701105456007504*^9, 3.701105475962441*^9}, {
   3.7011055150114927`*^9, 3.701105538376307*^9}, 3.701156052610114*^9, {
   3.7011561285458107`*^9, 3.7011561609219217`*^9}, {3.701156328906815*^9, 
   3.7011563376691*^9}, 
   3.701171254424407*^9},ExpressionUUID->"aab83e86-509f-4720-9781-\
7542271f533a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Code", " ", "for", " ", "producing", " ", "a", " ", "graph", " ", "of", 
    " ", "the", " ", "interior", " ", "rest", " ", "points", " ", "as", " ", 
    "a", " ", "function", " ", "of", " ", "the", " ", "fraction", " ", 
    StyleBox["b",
     FontSlant->"Italic"], " ", "of", " ", "BI", " ", 
    RowBox[{"agents", ".", " ", "Variables"}], " ", 
    RowBox[{"x", "[", 
     StyleBox["i",
      FontSlant->"Italic"], "]"}], " ", "and", " ", 
    RowBox[{"y", "[", 
     StyleBox["i",
      FontSlant->"Italic"], "]"}], " ", "shown", " ", "in", " ", "the", " ", 
    "figure", " ", "refer", " ", "to", " ", "the", " ", "population", " ", 
    "of", " ", "BEP", " ", "agents", " ", "only", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"and", " ", "are", " ", "appropriately", " ", "normalized"}], 
      ")"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mesh", "=", 
     RowBox[{"2.", "^", 
      RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listOfValuesForb", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"1", "-", "mesh"}], ",", "mesh"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listOfFixedPoints", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "FloatingPointApproximateRestPointTestAllMinIfTieWithBIAgents", "[", 
         RowBox[{"d", ",", "#", ",", "0"}], "]"}], "&"}], ",", 
       "listOfValuesForb"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s1", "=", 
     RowBox[{"IntegerPart", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
    RowBox[{"xVars", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"x", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"s2", "=", 
     RowBox[{"IntegerPart", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
    RowBox[{"yVars", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"y", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Row", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"Rest", "[", 
           RowBox[{"FoldList", "[", 
            RowBox[{"Plus", ",", "0", ",", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Normalize", "[", 
                  RowBox[{"#", ",", "Total"}], "]"}], "&"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"#1", "/.", "listOfFixedPoints"}]}], "]"}], 
              "\[Transpose]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Filling", "\[Rule]", 
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"i", "+", "1"}], "\[Rule]", 
                RowBox[{"{", "i", "}"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"Rule", "[", 
              RowBox[{"1", ",", "Axis"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"DataRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "[", "listOfValuesForb", "]"}], ",", 
             RowBox[{"Last", "[", "listOfValuesForb", "]"}]}], "}"}]}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Population \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"First", "[", "#2", "]"}], "]"}], "<>", 
            "\"\<: BEP(\!\(\*SuperscriptBox[\(\[Tau]\), \(all\)]\), 1, \
\!\(\*SuperscriptBox[\(\[Beta]\), \(min\)]\)) agents\>\""}]}], ",", 
          RowBox[{"Frame", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
            "}"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "#1"}], "]"}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\)\>\"", ",", "None"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"xVars", ",", "yVars"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ",", "\"\<                \>\"", ",", " ", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameMargins", "\[Rule]", "15"}], ",", 
     RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7011511163876047`*^9, 3.701151119806636*^9}, {
   3.701151172175173*^9, 3.701151180342725*^9}, {3.701151220235669*^9, 
   3.701151306881922*^9}, {3.701151474167762*^9, 3.701151505451825*^9}, {
   3.7011516141377907`*^9, 3.701151721844191*^9}, {3.701151989793323*^9, 
   3.701152097902665*^9}, {3.701152219313375*^9, 3.7011522231282253`*^9}, 
   3.701152455042617*^9, {3.7011525469641857`*^9, 3.701152559848625*^9}, {
   3.7011527139122458`*^9, 3.701152714327547*^9}, {3.70115274972057*^9, 
   3.7011527498094683`*^9}, {3.7011527938435717`*^9, 3.701152820008657*^9}, {
   3.7011528507448606`*^9, 3.701152911424486*^9}, {3.7011529815136137`*^9, 
   3.7011529937647867`*^9}, {3.7011530307085667`*^9, 3.701153071475872*^9}, {
   3.701153174830515*^9, 3.701153175740573*^9}, 3.701153375167433*^9, {
   3.701164250070302*^9, 3.7011642772705936`*^9}, 3.7011712563264513`*^9, {
   3.7015290871791067`*^9, 3.7015292085895443`*^9}, {3.701529282481148*^9, 
   3.701529396398446*^9}, {3.701529448756793*^9, 3.701529511093799*^9}, {
   3.701529558579644*^9, 3.70152959347646*^9}, {3.701533956784236*^9, 
   3.7015340491686687`*^9}, {3.701534515968083*^9, 3.701534675842023*^9}, {
   3.7015347163082447`*^9, 3.701534808050349*^9}, {3.701534838381071*^9, 
   3.7015348710060463`*^9}, 3.701535202477738*^9, {3.7015352358463573`*^9, 
   3.701535235968872*^9}, 
   3.701535755676351*^9},ExpressionUUID->"07f7b923-84fd-44e2-8aa3-\
11a6fb8e359c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Introduction of backward induction agents, with the other agents using \
test-two, min-if-tie\
\>", "Subsection",
 InitializationGroup->False,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}, {
   3.699252066728178*^9, 3.699252068647614*^9}, {3.699252101453247*^9, 
   3.6992521026445217`*^9}, {3.699252184748106*^9, 3.699252189020989*^9}, {
   3.6992526135049143`*^9, 3.699252615121192*^9}, {3.699252657421712*^9, 
   3.699252659097137*^9}, 3.700144501718858*^9, 3.700144554976672*^9, {
   3.7002930860067577`*^9, 3.700293099133706*^9}, 3.701095726051642*^9, 
   3.7011492299559097`*^9},ExpressionUUID->"72ad96c2-56ea-439b-b3e6-\
9734ed949d08"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MeanDynamicsTestTwoMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{
  3.700220237849874*^9, 3.700293115245428*^9, 3.701095744544942*^9, {
   3.701149692415975*^9, 3.701149692886141*^9}, 
   3.701171258080605*^9},ExpressionUUID->"d2942d15-cc06-4916-b8e8-\
1923f9648ebc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanDynamicsTestTwoMinIfTieWithBIAgents", "[", 
   RowBox[{"4", ",", "0.2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.70022025367246*^9, 3.7002202631501083`*^9}, {
   3.700220315192699*^9, 3.700220330006914*^9}, 3.700221130438261*^9, {
   3.700293117045051*^9, 3.70029313026215*^9}, {3.700293162303844*^9, 
   3.700293209080339*^9}, {3.700293463131274*^9, 3.70029346322003*^9}, 
   3.701095770644264*^9, {3.701095879082066*^9, 3.7010959008718452`*^9}, {
   3.701095936941671*^9, 3.701095940853799*^9}, {3.701096081364208*^9, 
   3.701096084075688*^9}, {3.701096124027149*^9, 3.701096145229765*^9}, {
   3.701149741981818*^9, 3.701149742340835*^9}, 
   3.7011712612531843`*^9},ExpressionUUID->"ae4abd7a-081b-4224-ac3f-\
343865a276ba"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MeanDynamicsTestTwoMinIfTieWithBIAgents", "[", 
       RowBox[{"d", ",", "0", ",", "0"}], "]"}], "==", 
      RowBox[{"MeanDynamics", "[", 
       RowBox[{
       "\"\<two\>\"", ",", "\"\<min\>\"", ",", "d", ",", "False", ",", 
        "False", ",", "0"}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"y", "[", "j", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"IntegerPart", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], "}"}]}], 
          "]"}], "\[Equal]", "1"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]",
    ",", 
   RowBox[{"{", 
    RowBox[{"d", ",", "2", ",", "20"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.700397614587245*^9, 3.700397627995607*^9}, {
   3.701095916072111*^9, 3.70109592919916*^9}, {3.701095997655593*^9, 
   3.701096047659676*^9}, {3.7010961009294147`*^9, 3.701096136736059*^9}, {
   3.701149755560603*^9, 3.701149781670361*^9}, 
   3.701171262468671*^9},ExpressionUUID->"30b217e4-406f-4bb2-ad47-\
924a730fe453"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", 
  "FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents"}]], "Input",
 CellChangeTimes->{{3.700397618271366*^9, 3.700397644533214*^9}, 
   3.701095991863695*^9, {3.7011497900754023`*^9, 3.701149790433867*^9}, 
   3.701171263953206*^9},ExpressionUUID->"63f0fd15-71ee-4ccc-93cc-\
be12bea65457"],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents", "[", 
  
  RowBox[{"4", ",", "0.2"}], "]"}]], "Input",
 CellChangeTimes->{{3.700220768016574*^9, 3.7002208007682543`*^9}, {
   3.700221070210244*^9, 3.7002210837532063`*^9}, {3.700293295451186*^9, 
   3.700293317396587*^9}, {3.7002936475871363`*^9, 3.700293653077141*^9}, {
   3.700395696431035*^9, 3.700395771769454*^9}, {3.7003976212277946`*^9, 
   3.7003976231008987`*^9}, {3.700397655938086*^9, 3.700397668468985*^9}, {
   3.700397736296372*^9, 3.700397736428658*^9}, {3.701096188891738*^9, 
   3.7010962337998123`*^9}, {3.701096339696067*^9, 3.701096394065462*^9}, {
   3.7011047774027452`*^9, 3.701104777582353*^9}, {3.7011048597518463`*^9, 
   3.7011048599756317`*^9}, {3.701105234327215*^9, 3.7011052471958857`*^9}, 
   3.701107754662274*^9, {3.70110779532047*^9, 3.7011078313319483`*^9}, {
   3.701149825355534*^9, 3.70114982571301*^9}, 
   3.701171264943285*^9},ExpressionUUID->"97245497-3f84-42a4-93e9-\
add113ecc8c6"],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents", "[", 
  
  RowBox[{"20", ",", "0.5", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.700414314890171*^9, 3.700414502671083*^9}, {
   3.700414547160038*^9, 3.7004146443822803`*^9}, {3.700414719567834*^9, 
   3.7004147209616547`*^9}, 3.700414814091193*^9, {3.7010919321364717`*^9, 
   3.7010919343391123`*^9}, 3.701092287642046*^9, {3.7011052974509687`*^9, 
   3.7011053170577517`*^9}, {3.701105456007504*^9, 3.701105475962441*^9}, {
   3.7011055150114927`*^9, 3.701105538376307*^9}, {3.701149833645032*^9, 
   3.7011498339927807`*^9}, 
   3.7011712657644444`*^9},ExpressionUUID->"3eb76ec4-71e7-46b3-abaa-\
757510d5f101"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mesh", "=", 
    RowBox[{"2.", "^", 
     RowBox[{"-", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Code", " ", "for", " ", "producing", " ", "a", " ", "graph", " ", "of", 
    " ", "the", " ", "interior", " ", "rest", " ", "points", " ", "as", " ", 
    "a", " ", "function", " ", "of", " ", "the", " ", "fraction", " ", 
    StyleBox["b",
     FontSlant->"Italic"], " ", "of", " ", "BI", " ", 
    RowBox[{"agents", ".", " ", "Variables"}], " ", 
    RowBox[{"x", "[", 
     StyleBox["i",
      FontSlant->"Italic"], "]"}], " ", "and", " ", 
    RowBox[{"y", "[", 
     StyleBox["i",
      FontSlant->"Italic"], "]"}], " ", "shown", " ", "in", " ", "the", " ", 
    "figure", " ", "refer", " ", "to", " ", "the", " ", "population", " ", 
    "of", " ", "BEP", " ", "agents", " ", "only", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"and", " ", "are", " ", "appropriately", " ", "normalized"}], 
      ")"}], "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfValuesForb", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", 
     RowBox[{"1", "-", "mesh"}], ",", "mesh"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listOfFixedPoints", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
      "FloatingPointApproximateRestPointTestTwoMinIfTieWithBIAgents", "[", 
       RowBox[{"d", ",", "#", ",", "0"}], "]"}], "&"}], ",", 
     "listOfValuesForb"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
  RowBox[{"xVars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s2", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
  RowBox[{"yVars", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Rest", "[", 
         RowBox[{"FoldList", "[", 
          RowBox[{"Plus", ",", "0", ",", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Normalize", "[", 
                RowBox[{"#", ",", "Total"}], "]"}], "&"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"#1", "/.", "listOfFixedPoints"}]}], "]"}], 
            "\[Transpose]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "+", "1"}], "\[Rule]", 
              RowBox[{"{", "i", "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Rule", "[", 
            RowBox[{"1", ",", "Axis"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"DataRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"First", "[", "listOfValuesForb", "]"}], ",", 
           RowBox[{"Last", "[", "listOfValuesForb", "]"}]}], "}"}]}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", 
         RowBox[{"\"\<Population \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", "#2", "]"}], "]"}], "<>", 
          "\"\<: BEP(\!\(\*SuperscriptBox[\(\[Tau]\), \(two\)]\), 1, \
\!\(\*SuperscriptBox[\(\[Beta]\), \(min\)]\)) agents\>\""}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Map", "[", 
          RowBox[{"ToString", ",", "#1"}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"b\",
FontSlant->\"Italic\"]\)\>\"", ",", "None"}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], "&"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"xVars", ",", "yVars"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
   ",", "\"\<                \>\"", ",", " ", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameMargins", "\[Rule]", "15"}], ",", 
   RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.701153299456132*^9, 3.701153304741333*^9}, 
   3.701153370948903*^9, {3.701164297126854*^9, 3.701164297227799*^9}, 
   3.701171266980174*^9, {3.701534947890394*^9, 3.701535014692882*^9}, {
   3.701535196023078*^9, 3.701535197077162*^9}, {3.701535712735531*^9, 
   3.701535731284636*^9}},ExpressionUUID->"da2c251b-bb35-44cc-a9e2-\
4c4d52091e50"]
}, Closed]]
}, Closed]]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1280, 687},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Input"]]}, Visible -> False, FrontEndVersion -> 
  "10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, 2015)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 495, 7, 92, "Title"],
Cell[1078, 31, 849, 24, 51, "Subtitle",
 InitializationGroup->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[1964, 60, 444, 7, 64, "Section"],
Cell[2411, 69, 2485, 55, 448, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[4933, 129, 364, 7, 50, "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[5322, 140, 220, 5, 44, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[5545, 147, 3346, 69, 215, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[8928, 221, 274, 6, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[9205, 229, 7624, 184, 368, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[16866, 418, 439, 8, 44, "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[17330, 430, 245, 4, 35, "Subsubsection"],
Cell[17578, 436, 23951, 520, 2019, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[41566, 961, 366, 7, 35, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[41957, 972, 280, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[42240, 980, 7569, 201, 450, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[49846, 1186, 332, 7, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[50181, 1195, 11845, 307, 455, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[62063, 1507, 284, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[62350, 1515, 8341, 225, 508, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[70740, 1746, 417, 8, 29, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[71182, 1758, 280, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[71465, 1766, 8066, 201, 301, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[79568, 1972, 282, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[79853, 1980, 8716, 218, 348, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[88606, 2203, 284, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[88893, 2211, 8608, 219, 348, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[97550, 2436, 419, 8, 29, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[97994, 2448, 282, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[98279, 2456, 10851, 266, 379, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[109167, 2727, 334, 7, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[109504, 2736, 13483, 322, 567, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[123024, 3063, 284, 6, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[123311, 3071, 11525, 288, 379, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[134897, 3366, 312, 7, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[135212, 3375, 16005, 380, 1675, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[151254, 3760, 398, 8, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[151655, 3770, 22027, 472, 1678, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[173719, 4247, 525, 11, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[174247, 4260, 32243, 660, 2411, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[206527, 4925, 541, 10, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[207071, 4937, 18459, 367, 1122, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[225567, 5309, 724, 14, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[226294, 5325, 37236, 759, 2952, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[263567, 6089, 754, 14, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[264324, 6105, 29866, 585, 2233, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[294227, 6695, 857, 14, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[295087, 6711, 15217, 324, 334, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[310341, 7040, 897, 16, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[311241, 7058, 32633, 640, 2736, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[343911, 7703, 890, 15, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[344804, 7720, 37448, 744, 2916, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[382289, 8469, 1010, 16, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[383302, 8487, 29148, 572, 1244, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[412487, 9064, 561, 10, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[413051, 9076, 21746, 469, 1643, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[434834, 9550, 556, 9, 36, "Subsection"],
Cell[435393, 9561, 60743, 1481, 4953, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[496173, 11047, 799, 14, 36, "Subsection"],
Cell[496975, 11063, 31020, 697, 1714, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[528032, 11765, 801, 14, 36, "Subsection"],
Cell[528836, 11781, 32603, 736, 1674, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[561488, 12523, 422, 6, 50, "Section"],
Cell[561913, 12531, 141, 2, 32, "Input"],
Cell[562057, 12535, 186, 4, 32, "Input"],
Cell[562246, 12541, 131, 1, 32, "Input"],
Cell[562380, 12544, 228, 5, 32, "Input"],
Cell[562611, 12551, 208, 5, 32, "Input"],
Cell[562822, 12558, 208, 5, 32, "Input"],
Cell[563033, 12565, 176, 3, 32, "Input"],
Cell[563212, 12570, 126, 1, 32, "Input"],
Cell[563341, 12573, 193, 4, 32, "Input"],
Cell[563537, 12579, 204, 4, 32, "Input"],
Cell[563744, 12585, 110, 1, 32, "Input"],
Cell[563857, 12588, 204, 4, 32, "Input"],
Cell[564064, 12594, 231, 4, 32, "Input"],
Cell[564298, 12600, 184, 4, 32, "Input"],
Cell[564485, 12606, 131, 1, 32, "Input"],
Cell[564619, 12609, 155, 4, 32, "Input"],
Cell[564777, 12615, 164, 4, 32, "Input"],
Cell[564944, 12621, 236, 4, 32, "Input"],
Cell[565183, 12627, 142, 2, 32, "Input"],
Cell[565328, 12631, 201, 5, 32, "Input"],
Cell[565532, 12638, 199, 5, 32, "Input"],
Cell[565734, 12645, 119, 1, 32, "Input"],
Cell[565856, 12648, 188, 4, 32, "Input"],
Cell[566047, 12654, 261, 5, 32, "Input"],
Cell[566311, 12661, 173, 4, 32, "Input"],
Cell[566487, 12667, 156, 4, 32, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[566680, 12676, 308, 5, 50, "Section"],
Cell[CellGroupData[{
Cell[567013, 12685, 265, 5, 44, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[567303, 12694, 214, 4, 28, "Input",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[567542, 12702, 570, 11, 28, "Input"],
Cell[568115, 12715, 721, 14, 46, "Input"],
Cell[568839, 12731, 680, 16, 46, "Input"],
Cell[569522, 12749, 591, 11, 28, "Input"],
Cell[570116, 12762, 419, 10, 46, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[570596, 12779, 285, 5, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[570906, 12788, 439, 8, 28, "Input"],
Cell[571348, 12798, 591, 12, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[571976, 12815, 334, 7, 22, "Input"],
Cell[572313, 12824, 460, 11, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[572810, 12840, 386, 7, 22, "Input"],
Cell[573199, 12849, 486, 11, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[573734, 12866, 342, 6, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[574101, 12876, 160, 4, 28, "Input"],
Cell[574264, 12882, 770, 18, 46, "Input"],
Cell[575037, 12902, 675, 16, 46, "Input"],
Cell[575715, 12920, 631, 13, 46, "Input"],
Cell[576349, 12935, 559, 13, 46, "Input"],
Cell[576911, 12950, 601, 14, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[577561, 12970, 399, 7, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[577985, 12981, 202, 4, 28, "Input"],
Cell[578190, 12987, 1151, 17, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[579378, 13009, 197, 4, 22, "Input"],
Cell[579578, 13015, 359, 7, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[579986, 13028, 433, 7, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[580444, 13039, 650, 11, 28, "Input"],
Cell[581097, 13052, 833, 15, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[581967, 13072, 264, 5, 28, "Input"],
Cell[582234, 13079, 550, 9, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[582833, 13094, 523, 10, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[583381, 13108, 202, 4, 28, "Input"],
Cell[583586, 13114, 318, 6, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[583953, 13126, 525, 10, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[584503, 13140, 231, 5, 28, "Input"],
Cell[584737, 13147, 318, 8, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[585104, 13161, 532, 8, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[585661, 13173, 300, 6, 28, "Input"],
Cell[585964, 13181, 779, 18, 63, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[586780, 13204, 110, 1, 28, "Input"],
Cell[586893, 13207, 881, 20, 63, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[587823, 13233, 570, 11, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[588418, 13248, 839, 13, 28, "Input"],
Cell[589260, 13263, 1561, 26, 46, "Input"],
Cell[590824, 13291, 1623, 28, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[592496, 13325, 534, 9, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[593055, 13338, 395, 8, 28, "Input"],
Cell[593453, 13348, 1433, 24, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[594935, 13378, 505, 8, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[595465, 13390, 164, 4, 28, "Input"],
Cell[595632, 13396, 533, 13, 28, "Input"],
Cell[596168, 13411, 1323, 36, 80, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[597540, 13453, 680, 12, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[598245, 13469, 197, 4, 28, "Input"],
Cell[598445, 13475, 312, 7, 28, "Input"],
Cell[598760, 13484, 494, 12, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[599303, 13502, 578, 9, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[599906, 13515, 226, 4, 32, "Input"],
Cell[600135, 13521, 499, 9, 28, "Input"],
Cell[600637, 13532, 1585, 42, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[602259, 13579, 253, 5, 26, "Input"],
Cell[602515, 13586, 638, 10, 32, "Input"],
Cell[603156, 13598, 1241, 31, 75, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[604434, 13634, 235, 4, 26, "Input"],
Cell[604672, 13640, 609, 11, 28, "Input"],
Cell[605284, 13653, 612, 12, 28, "Input"],
Cell[605899, 13667, 608, 12, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[606556, 13685, 699, 13, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[607280, 13702, 304, 6, 28, "Input"],
Cell[607587, 13710, 776, 13, 28, "Input"],
Cell[608366, 13725, 1834, 46, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[610237, 13776, 283, 6, 22, "Input"],
Cell[610523, 13784, 1017, 16, 28, "Input"],
Cell[611543, 13802, 778, 13, 28, "Input"],
Cell[612324, 13817, 6750, 156, 347, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[619123, 13979, 673, 12, 36, "Subsection",
 InitializationGroup->False],
Cell[CellGroupData[{
Cell[619821, 13995, 304, 6, 28, "Input"],
Cell[620128, 14003, 774, 13, 28, "Input"],
Cell[620905, 14018, 1784, 45, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[622726, 14068, 329, 6, 22, "Input"],
Cell[623058, 14076, 1016, 16, 28, "Input"],
Cell[624077, 14094, 709, 12, 28, "Input"],
Cell[624789, 14108, 5443, 140, 347, "Input"]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

