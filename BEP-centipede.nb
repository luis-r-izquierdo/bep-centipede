(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    345616,       7664]
NotebookOptionsPosition[    337174,       7395]
NotebookOutlinePosition[    337551,       7412]
CellTagsIndexPosition[    337508,       7409]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Best-experienced-payoff Dynamics", "Title",
 CellChangeTimes->{{3.692963139229731*^9, 3.6929631740013227`*^9}, {
  3.692963833305882*^9, 3.692963836048258*^9}}],

Cell[CellGroupData[{

Cell["Source code", "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963104322612*^9, 3.6929631227469807`*^9}, 
   3.6929631827426558`*^9, 3.69296347114834*^9, {3.693031989625875*^9, 
   3.693031991231361*^9}}],

Cell[CellGroupData[{

Cell["General options", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929637613180933`*^9, 3.692963781949512*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Symbols", " ", "x"}], ",", " ", "y", ",", " ", 
     RowBox[{
     "z", " ", "and", " ", "t", " ", "must", " ", "not", " ", "be", " ", 
      "used", " ", "in", " ", "this", " ", "notebook"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"Root", ",", 
      RowBox[{"ExactRootIsolation", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"precision", "=", "6"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMove", "::", "invalidValueOf_testSetRule"}], "=", 
     "\"\<the variable testSetRule in ExpectedMove[\!\(\*
StyleBox[\"testSetRule\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\), tieBreakingRule, n] cannot take the \
value `1`. It can only be \\\"all\\\", \\\"two\\\" or \\\"adj\\\"\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMove", "::", "invalidValueOf_tieBreakingRule"}], "=", 
     "\"\<the variable tieBreakingRule in ExpectedMove[testSetRule, \!\(\*
StyleBox[\"tieBreakingRule\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\), n] cannot take the value `1`. It \
can only be \\\"min\\\", \\\"stick\\\" or \\\"unif\\\"\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMove", "::", "invalidValueOf_n"}], "=", 
     "\"\<the variable n (number of nodes in the game) in \
ExpectedMove[testSetRule, tieBreakingRule, \!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\",
FontVariations->{\"Underline\"->True}]\)] cannot take the value `1`. It must \
be an integer strictly greater than 1\>\""}], ";"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.692963095601802*^9}, 3.692963471148655*^9, {3.692965028060574*^9, 
   3.692965029507132*^9}, {3.692966522983467*^9, 3.6929666165570383`*^9}, {
   3.692966724564423*^9, 3.692966765740283*^9}, {3.693030030531804*^9, 
   3.6930300315556517`*^9}, {3.693030092575877*^9, 3.69303010318467*^9}, {
   3.693030148307716*^9, 3.69303019914688*^9}, {3.693030620688936*^9, 
   3.693030622881857*^9}, {3.693031015984412*^9, 3.6930310349845963`*^9}, {
   3.693031133311364*^9, 3.693031272406781*^9}, 3.6930319805566177`*^9, {
   3.69303305306196*^9, 3.693033057673807*^9}, {3.693035868154105*^9, 
   3.693035871572858*^9}, {3.693078145413859*^9, 3.6930781675558777`*^9}, {
   3.69354989608856*^9, 3.693549898484931*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Expected moves", "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963227845255*^9, 3.69296325552354*^9}, 
   3.692963296342883*^9, 3.6929634614063253`*^9, 3.692963707587676*^9}],

Cell[CellGroupData[{

Cell["General functions", "Subsubsection",
 CellChangeTimes->{{3.692965354024008*^9, 3.692965381764658*^9}, {
   3.6930320109304237`*^9, 3.693032015002742*^9}, 3.6967507905891447`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMove", "[", 
      RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"IntegerQ", "[", "n", "]"}], "]"}], " ", "||", 
           RowBox[{"n", "<", "2"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"ExpectedMove", "::", "invalidValueOf_n"}], ",", "n"}], 
             "]"}], ";", 
            "\"\<Error parameterizing the length of the game (number of nodes \
must be at least 2)\>\"", ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "testSetRule", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<all\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"ExpectedMoveAllMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"ExpectedMoveAllStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"ExpectedMoveAllUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "ExpectedMove", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<two\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"ExpectedMoveTwoMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"ExpectedMoveTwoStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"ExpectedMoveTwoUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "ExpectedMove", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\"\<adj\>\"", ",", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "tieBreakingRule", ",", "\[IndentingNewLine]", "\"\<min\>\"", ",", 
            
            RowBox[{"ExpectedMoveAdjacentMin", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<stick\>\"", ",", 
            RowBox[{"ExpectedMoveAdjacentStick", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<unif\>\"", ",", 
            RowBox[{"ExpectedMoveAdjacentUnif", "[", 
             RowBox[{"n", ",", "x", ",", "y"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{
                "ExpectedMove", "::", "invalidValueOf_tieBreakingRule"}], ",",
                 "tieBreakingRule"}], "]"}], ";", 
              "\"\<Error parameterizing the tie-breaking rule\>\"", ";", 
              RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "_", ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"ExpectedMove", "::", "invalidValueOf_testSetRule"}], 
              ",", "testSetRule"}], "]"}], ";", 
            "\"\<Error parameterizing the test-set rule\>\"", ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMoveWithoutFirstVariables", "[", 
      RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
         RowBox[{"s2", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
         "reducedEM"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reducedEM", "=", 
         RowBox[{"ExpectedMove", "[", 
          RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"reducedEM", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"reducedEM", ",", 
            RowBox[{"{", 
             RowBox[{"s1", "+", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"reducedEM", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "1", "]"}], "\[Rule]", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "1", "]"}], "\[Rule]", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpectedMoveWithoutLastVariables", "[", 
      RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
         RowBox[{"s2", "=", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
         "reducedEM"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reducedEM", "=", 
         RowBox[{"ExpectedMove", "[", 
          RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"reducedEM", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"reducedEM", ",", 
            RowBox[{"{", "s1", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"reducedEM", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "s1", "]"}], "\[Rule]", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"s1", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"y", "[", "s2", "]"}], "\[Rule]", 
            RowBox[{"1", " ", "-", " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"s2", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692965446235427*^9, 3.6929654697463293`*^9}, {
   3.6929657073233213`*^9, 3.692965744640543*^9}, {3.692965816730579*^9, 
   3.692965819847828*^9}, {3.692965859703281*^9, 3.6929659019656057`*^9}, {
   3.692966131948928*^9, 3.692966227208665*^9}, {3.692966260010957*^9, 
   3.6929662891655703`*^9}, {3.692966648235888*^9, 3.692966710166909*^9}, {
   3.692966784231855*^9, 3.692966823821845*^9}, {3.692966858602195*^9, 
   3.692966917506918*^9}, {3.692966953934803*^9, 3.692966975881844*^9}, 
   3.692967072814118*^9, 3.692967123450399*^9, {3.692967739845028*^9, 
   3.6929677537398653`*^9}, {3.692971310715054*^9, 3.692971318625497*^9}, {
   3.692971786307362*^9, 3.692971812328455*^9}, {3.692972457878489*^9, 
   3.692972466361067*^9}, {3.692972499167418*^9, 3.6929725194390182`*^9}, {
   3.692973314001739*^9, 3.692973335251636*^9}, {3.692973419426969*^9, 
   3.692973467238038*^9}, {3.692973930518475*^9, 3.692973962411765*^9}, 
   3.692974006322344*^9, {3.692974134721342*^9, 3.692974160336493*^9}, {
   3.6929743392580013`*^9, 3.692974339876562*^9}, {3.692974429104535*^9, 
   3.692974526740728*^9}, {3.692974578154134*^9, 3.692974582046*^9}, {
   3.692975543684683*^9, 3.692975591374995*^9}, {3.693029679654345*^9, 
   3.693029704649976*^9}, {3.693030041865196*^9, 3.693030045811145*^9}, {
   3.693030211694378*^9, 3.6930302207164392`*^9}, {3.6930303435772667`*^9, 
   3.693030374559471*^9}, {3.693031287888219*^9, 3.693031453287703*^9}, {
   3.693031497073848*^9, 3.6930315500730886`*^9}, {3.693032077736012*^9, 
   3.693032106873304*^9}, {3.693032138453549*^9, 3.6930321749361277`*^9}, {
   3.693032306349473*^9, 3.69303233673464*^9}, {3.693032388836957*^9, 
   3.693032521866275*^9}, {3.6967348264651318`*^9, 3.6967348391953516`*^9}, {
   3.696735057378541*^9, 3.6967350924218655`*^9}, {3.696747113886941*^9, 
   3.6967471418470206`*^9}, {3.696747422603009*^9, 3.696747442203549*^9}, {
   3.696750771100972*^9, 3.696750782600333*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test all ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}}],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692972843352756*^9, 3.692972845004739*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllMin", "[", 
     RowBox[{"n_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "k", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"m", "=", "1"}], "i"], 
             RowBox[{"y", "[", "m", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "2"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"y", "[", "k", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"l", "=", "1"}], 
               RowBox[{"k", "-", "1"}]], 
              RowBox[{"y", "[", "l", "]"}]}], ")"}], 
            RowBox[{"i", "-", "k"}]], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"m", "=", "1"}], "k"], 
              RowBox[{"y", "[", "m", "]"}]}], ")"}], 
            RowBox[{"s1", "-", "i"}]]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllMin", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"k", "=", "2"}], "s1"], 
             RowBox[{"x", "[", "k", "]"}]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "+", 
              RowBox[{"x", "[", "2", "]"}]}], ")"}], 
            RowBox[{"s2", "-", "1"}]]}], "+", 
          SuperscriptBox[
           RowBox[{"x", "[", "1", "]"}], "s2"]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", 
                RowBox[{"j", "+", "1"}]}], "s1"], 
              RowBox[{"x", "[", "k", "]"}]}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"m", "=", "1"}], 
                RowBox[{"j", "+", "1"}]], 
               RowBox[{"x", "[", "m", "]"}]}], ")"}], 
             RowBox[{"s2", "-", "j"}]]}], "+", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], "j"], 
            RowBox[{
             RowBox[{"x", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"x", "[", "l", "]"}]}], ")"}], 
              RowBox[{"j", "-", "k", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"x", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s2", "-", "j"}]]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAllMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllMin", "[", 
         RowBox[{"n", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllMin", "[", 
         RowBox[{"n", ",", "x"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, {
   3.692964629408436*^9, 3.69296463194263*^9}, 3.692964675053371*^9, {
   3.692964845947241*^9, 3.6929648533747807`*^9}, {3.692964940240322*^9, 
   3.692964940646299*^9}, {3.692964984011602*^9, 3.692964991546287*^9}, {
   3.692965561836548*^9, 3.692965562275013*^9}, {3.692965665231518*^9, 
   3.692965669581805*^9}, 3.692965701466701*^9, {3.692971184864274*^9, 
   3.692971262576693*^9}, {3.692971335290848*^9, 3.69297134302752*^9}, {
   3.692971558602255*^9, 3.692971567803259*^9}, {3.692971837110524*^9, 
   3.6929718392129307`*^9}, 3.69297254650884*^9, {3.694021794782971*^9, 
   3.694021824245927*^9}, 3.694021878595821*^9, {3.6967346089235735`*^9, 
   3.6967346155224314`*^9}, {3.6967370382288437`*^9, 
   3.6967370492592506`*^9}, {3.6967387544704456`*^9, 3.6967387593027916`*^9}},
 
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963935759516*^9}, 
   3.696726640514408*^9, 3.6967346610715017`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllStick", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"payoffsX", "=", 
         RowBox[{"PayoffsX", "[", "n", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "k", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"m", "=", "1"}], "i"], 
             RowBox[{"y", "[", "m", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"x", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"i", "-", "k"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "i"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"q", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"x", "[", "q", "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"i", "-", "k", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "i", "-", "1"}]]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], 
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"k", "=", "2"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{
             RowBox[{"y", "[", "k", "]"}], 
             RowBox[{"(", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"l", "=", "1"}], 
                RowBox[{"k", "-", "1"}]], 
               RowBox[{"y", "[", "l", "]"}]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"m", "=", "1"}], "k"], 
                RowBox[{"y", "[", "m", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "k", "-", "1"}]]}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllStick", "[", 
     RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"payoffsY", "=", 
         RowBox[{"PayoffsY", "[", "n", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"k", "=", "2"}], "s1"], 
             RowBox[{"x", "[", "k", "]"}]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "+", 
              RowBox[{"x", "[", "2", "]"}]}], ")"}], 
            RowBox[{"s2", "-", "1"}]]}], "+", 
          RowBox[{
           RowBox[{"y", "[", "1", "]"}], 
           SuperscriptBox[
            RowBox[{"x", "[", "1", "]"}], "s2"]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", 
                RowBox[{"j", "+", "1"}]}], "s1"], 
              RowBox[{"x", "[", "k", "]"}]}], ")"}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"m", "=", "1"}], 
                RowBox[{"j", "+", "1"}]], 
               RowBox[{"x", "[", "m", "]"}]}], ")"}], 
             RowBox[{"s2", "-", "j"}]]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", "1"}], 
               RowBox[{"j", "-", "1"}]], 
              RowBox[{"y", "[", "q", "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", "2"}], "j"], 
              RowBox[{
               RowBox[{"x", "[", "k", "]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                RowBox[{"j", "-", "k", "+", "1"}]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"m", "=", "1"}], "k"], 
                  RowBox[{"x", "[", "m", "]"}]}], ")"}], 
                RowBox[{"s2", "-", "j"}]]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"q", "=", 
                RowBox[{"j", "+", "1"}]}], "s2"], 
              RowBox[{"y", "[", "q", "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", "2"}], "j"], 
              RowBox[{
               RowBox[{"x", "[", "k", "]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                RowBox[{"j", "-", "k", "+", "2"}]], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"m", "=", "1"}], "k"], 
                  RowBox[{"x", "[", "m", "]"}]}], ")"}], 
                RowBox[{"s2", "-", "j", "-", "1"}]]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"y", "[", "j", "]"}], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"x", "[", "1", "]"}], "s2"], "+", 
              RowBox[{
               UnderoverscriptBox["\[Sum]", 
                RowBox[{"k", "=", "2"}], "j"], 
               RowBox[{
                RowBox[{"x", "[", "k", "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"m", "=", "1"}], "k"], 
                   RowBox[{"x", "[", "m", "]"}]}], ")"}], 
                 RowBox[{"s2", "-", "k"}]]}]}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAllStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllStick", "[", 
         RowBox[{"n", ",", "x", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllStick", "[", 
         RowBox[{"n", ",", "x", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.6929713841475563`*^9, 3.692971421406011*^9}, {
   3.692971514378076*^9, 3.692971526280409*^9}, {3.69297164035741*^9, 
   3.692971730470628*^9}, {3.69297176429277*^9, 3.692971775574144*^9}, {
   3.692971815298686*^9, 3.692971842475584*^9}, {3.692973975693057*^9, 
   3.6929740028806667`*^9}, 3.6929741364527693`*^9, {3.6967268045415587`*^9, 
   3.696726814829624*^9}, {3.6967268810218554`*^9, 3.696726881599987*^9}, {
   3.6967269227491875`*^9, 3.696726927733597*^9}, {3.6967269667516394`*^9, 
   3.696726991564391*^9}, {3.6967270349283447`*^9, 3.696727199656329*^9}, {
   3.6967273411615257`*^9, 3.696727342552168*^9}, {3.696727378249139*^9, 
   3.6967273803741555`*^9}, {3.696727451485079*^9, 3.69672745518824*^9}, {
   3.6967274993924794`*^9, 3.6967275046269083`*^9}, {3.6967275507870007`*^9, 
   3.69672758005373*^9}, {3.696727643727441*^9, 3.696727720627182*^9}, {
   3.696727807177915*^9, 3.6967279100158405`*^9}, {3.6967279725149117`*^9, 
   3.6967279848275332`*^9}, 3.6967346472900934`*^9, {3.69673469761836*^9, 
   3.696734712493534*^9}, 3.69673706532421*^9, 3.6967371283080955`*^9, {
   3.696738745072296*^9, 3.696738750503661*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963953308807*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FirstMoversInflowAllUnif", "[", 
     RowBox[{"n_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "i"}], "s2"], 
            RowBox[{"y", "[", "j", "]"}]}], ")"}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", "1"}], "i"], 
             RowBox[{"y", "[", "j", "]"}]}], ")"}], 
           RowBox[{"s1", "-", "i"}]]}], "+", 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"k", "=", "2"}], 
           RowBox[{"i", "-", "1"}]], 
          RowBox[{
           RowBox[{"y", "[", "k", "]"}], 
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", "1"}], 
              RowBox[{"k", "-", "1"}]], 
             RowBox[{"y", "[", "j", "]"}]}], ")"}], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"j", "=", "0"}], 
             RowBox[{"s1", "-", "k", "-", "1"}]], 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{"s1", "-", "k", "-", "1"}], ",", "j"}], "]"}], "*", 
               SuperscriptBox[
                RowBox[{"y", "[", "k", "]"}], "j"]}], 
              RowBox[{"j", "+", "1"}]], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"l", "=", "1"}], 
                 RowBox[{"k", "-", "1"}]], 
                RowBox[{"y", "[", "l", "]"}]}], ")"}], 
              RowBox[{"s1", "-", "k", "-", "1", "-", "j"}]]}]}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SecondMoversInflowAllUnif", "[", 
     RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "X"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "s2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"x", "[", "1", "]"}], "s2"], "s2"]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"X", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"k", "=", "2"}], "i"], 
              RowBox[{
               RowBox[{"x", "[", "k", "]"}], 
               RowBox[{"(", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"j", "=", "1"}], 
                  RowBox[{"k", "-", "1"}]], 
                 RowBox[{"x", "[", "j", "]"}]}], ")"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"j", "=", "0"}], 
                 RowBox[{"s2", "-", "k"}]], 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"Binomial", "[", 
                    RowBox[{
                    RowBox[{"s2", "-", "k"}], ",", "j"}], "]"}], "*", 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "j"]}], 
                  RowBox[{"j", "+", "1"}]], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{"x", "[", "l", "]"}]}], ")"}], 
                  RowBox[{"s2", "-", "k", "-", "j"}]]}]}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             UnderoverscriptBox["\[Sum]", 
              RowBox[{"j", "=", 
               RowBox[{"i", "+", "1"}]}], "s1"], 
             RowBox[{"x", "[", "j", "]"}]}], ")"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"j", "=", "1"}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"x", "[", "j", "]"}]}], ")"}], 
            RowBox[{"s2", "-", "i"}]]}], "+", 
          RowBox[{"X", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAllUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"FirstMoversInflowAllUnif", "[", 
         RowBox[{"n", ",", "y"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SecondMoversInflowAllUnif", "[", 
         RowBox[{"n", ",", "x"}], "]"}], "-", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692971948476985*^9, 3.692971994858296*^9}, {
   3.692972049751625*^9, 3.692972084501997*^9}, {3.692975341789895*^9, 
   3.692975351060164*^9}, {3.696738734788206*^9, 3.6967387406044707`*^9}},
 Background->GrayLevel[0.85]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test two ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}, {3.6929640285511713`*^9, 3.692964028829377*^9}}],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, 3.696728854542264*^9, 3.6967348736800723`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveTwoMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "1"}]}], "s2"], 
                 RowBox[{"y", "[", "k", "]"}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "h"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "i"}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "i"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"i", "-", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "1"}], 
                  RowBox[{"i", "-", "1"}]], 
                 SuperscriptBox[
                  RowBox[{"y", "[", "k", "]"}], "2"]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "2"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s1"], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"h", "+", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"i", "+", "1"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"i", "+", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "i"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "1"}], "i"], 
                 SuperscriptBox[
                  RowBox[{"x", "[", "k", "]"}], "2"]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.69296405838935*^9, {3.692972891863494*^9, 3.692972904003366*^9}, 
   3.692973221638762*^9, {3.692973271587261*^9, 3.692973283784287*^9}, {
   3.692973385832027*^9, 3.692973386799302*^9}, 3.692973950598632*^9, {
   3.692974202411601*^9, 3.692974227891403*^9}, {3.696728867339264*^9, 
   3.6967289098350396`*^9}, {3.696729426803939*^9, 3.6967294506947994`*^9}, {
   3.696729511307807*^9, 3.696729533651781*^9}, 3.696734881336393*^9, 
   3.6967372027632675`*^9, 3.6967387124882517`*^9, {3.6967399376292796`*^9, 
   3.6967399414314756`*^9}, {3.6967552737651577`*^9, 3.696755274813747*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963935759516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveTwoStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                  RowBox[{"y", "[", "k", "]"}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "h"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], "+", 
                 RowBox[{"x", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], 
                 RowBox[{"h", "-", "1"}]], 
                SuperscriptBox[
                 RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "i"}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"i", "-", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], "+", 
                 RowBox[{"x", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], 
                 RowBox[{"i", "-", "1"}]], 
                SuperscriptBox[
                 RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                  RowBox[{"x", "[", "k", "]"}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"h", "+", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], "+", 
                 RowBox[{"y", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], "h"], 
                SuperscriptBox[
                 RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "i"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], "+", 
                 RowBox[{"y", "[", "h", "]"}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], 
               RowBox[{
                UnderoverscriptBox["\[Sum]", 
                 RowBox[{"k", "=", "1"}], "i"], 
                SuperscriptBox[
                 RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.692972946664332*^9, {3.6929730338289413`*^9, 
   3.692973068073237*^9}, {3.692973392368725*^9, 3.692973394416008*^9}, {
   3.692973516356391*^9, 3.692973539972237*^9}, {3.6929742458149443`*^9, 
   3.692974273882441*^9}, {3.692975384994193*^9, 3.692975393947578*^9}, {
   3.6929754284748173`*^9, 3.692975436866858*^9}, 3.6967349166032114`*^9, 
   3.6967372087991643`*^9, 3.69673871894256*^9, {3.696739954059035*^9, 
   3.6967399769744077`*^9}, {3.696755249013632*^9, 3.696755250411758*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963953308807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveTwoUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "1"}]}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s2"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "h"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], " ", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"h", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], " ", ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s1", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "i"}], "s2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "i"], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"i", "-", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"y", "[", "k", "]"}], 
                   RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"i", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], "+", 
                RowBox[{"x", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", "1"}], 
             RowBox[{"i", "-", "1"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"h", "+", "2"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], "s1"], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], 
                  RowBox[{"h", "+", "1"}]], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "h"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "+", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"s2", "-", "1"}]], 
           RowBox[{
            UnderoverscriptBox["\[Sum]", 
             RowBox[{"h", "=", 
              RowBox[{"i", "+", "1"}]}], "s2"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", 
                   RowBox[{"i", "+", "1"}]}], "s1"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"i", "+", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 UnderoverscriptBox["\[Sum]", 
                  RowBox[{"k", "=", "2"}], "i"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"l", "=", "1"}], 
                   RowBox[{"k", "-", "1"}]], 
                  RowBox[{
                   RowBox[{"x", "[", "k", "]"}], 
                   RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "i"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y", "[", "i", "]"}], "+", 
                RowBox[{"y", "[", "h", "]"}]}], ")"}]}], ")"}]}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.6929731384319267`*^9, 3.692974154620908*^9, 
   3.692974234012753*^9, {3.6967469924465456`*^9, 3.696746995824072*^9}},
 Background->GrayLevel[0.85]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test adjacent ", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963343213125*^9, 3.692963354722578*^9}, {
  3.6929634215352087`*^9, 3.692963453979772*^9}, {3.69296361380372*^9, 
  3.692963646665205*^9}, {3.69296404607685*^9, 3.692964047731427*^9}}],

Cell[CellGroupData[{

Cell["Min if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, 3.6967330540306826`*^9, 3.6967349662811375`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAdjacentMin", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                   RowBox[{"y", "[", "k", "]"}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "h"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                   RowBox[{"x", "[", "k", "]"}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"h", "+", "1"}]], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "i"], 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "i"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "i", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                   RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692964068038495*^9, 3.6929736410221148`*^9, {3.692973745228753*^9, 
   3.6929737474675217`*^9}, {3.6929738312379436`*^9, 
   3.6929738401589622`*^9}, {3.692974298532917*^9, 3.692974319863122*^9}, {
   3.6967330850853195`*^9, 3.696733091201589*^9}, {3.6967331619780006`*^9, 
   3.696733203944004*^9}, {3.6967332392418995`*^9, 3.6967332710532064`*^9}, 
   3.6967349691092567`*^9, 3.6967372274244604`*^9, 3.696738843638236*^9, {
   3.6967400968501387`*^9, 3.6967401164541073`*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Stick if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963935759516*^9}, 
   3.6967302532243776`*^9, 3.6967349830309315`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAdjacentStick", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                    RowBox[{"y", "[", "k", "]"}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "h"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"x", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"h", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "i"}], "s2"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"i", "-", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"x", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], 
                   RowBox[{"i", "-", "1"}]], 
                  SuperscriptBox[
                   RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                    RowBox[{"x", "[", "k", "]"}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], 
                    RowBox[{"h", "+", "1"}]], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"y", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "h"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                   RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "2"}], "i"], 
                    RowBox[{
                    UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                    RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "i", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                    "]"}], 
                    RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                  "]"}], 
                 RowBox[{"y", "[", "i", "]"}], 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "1"}], "i"], 
                  SuperscriptBox[
                   RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}]}], ",", 
             "0"}], "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, {3.692973711838814*^9, 3.69297372635133*^9}, 
   3.692974332136294*^9, {3.692974411967889*^9, 3.692974412967828*^9}, {
   3.6967303459208484`*^9, 3.6967304083518314`*^9}, 3.6967307293512664`*^9, {
   3.696730908487402*^9, 3.696730929860999*^9}, {3.696731141362879*^9, 
   3.696731188773086*^9}, {3.69673122698164*^9, 3.696731227903525*^9}, {
   3.6967312779412575`*^9, 3.696731282331931*^9}, {3.6967314284480247`*^9, 
   3.696731480089882*^9}, {3.6967315163837056`*^9, 3.696731546883236*^9}, {
   3.696731583559874*^9, 3.696731637316484*^9}, 3.6967316726053376`*^9, 
   3.696731757516554*^9, {3.6967318254882236`*^9, 3.6967318621523094`*^9}, {
   3.6967318974016914`*^9, 3.696731912604965*^9}, {3.6967321569031725`*^9, 
   3.696732173011325*^9}, {3.6967322082796135`*^9, 3.696732212293905*^9}, {
   3.696732242855357*^9, 3.696732244949133*^9}, {3.69673242056215*^9, 
   3.6967324624871855`*^9}, {3.6967324935031195`*^9, 
   3.6967325253984137`*^9}, {3.696732606668733*^9, 3.6967326900922427`*^9}, 
   3.6967349872965755`*^9, 3.6967372336539416`*^9, 3.6967388513001175`*^9, {
   3.696740125506257*^9, 3.696740142376296*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Uniform if tie", "Text",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.692963621679696*^9, 3.692963650291464*^9}, 
   3.692963795604203*^9, {3.692963934121407*^9, 3.692963953308807*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExpectedMoveAdjacentUnif", "[", 
    RowBox[{"n_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "1"}]}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "s2"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "h"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"h", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "i"}], "s2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "i"], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"i", "-", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"y", "[", "k", "]"}], 
                    RowBox[{"y", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], 
                    RowBox[{"i", "-", "1"}]], 
                   SuperscriptBox[
                    RowBox[{"y", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s1"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"x", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "-", 
          RowBox[{"x", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"i", "-", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"h", "+", "2"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], "s1"], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], 
                   RowBox[{"h", "+", "1"}]], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "h"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "s2"}], ",", 
             RowBox[{
              UnderoverscriptBox["\[Sum]", 
               RowBox[{"h", "=", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"i", "+", "1"}]], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", 
                    RowBox[{"i", "+", "1"}]}], "s1"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"i", "+", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  UnderoverscriptBox["\[Sum]", 
                   RowBox[{"k", "=", "2"}], "i"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"l", "=", "1"}], 
                    RowBox[{"k", "-", "1"}]], 
                   RowBox[{
                    RowBox[{"x", "[", "k", "]"}], 
                    RowBox[{"x", "[", "l", "]"}]}]}]}], "+", 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{
                   UnderoverscriptBox["\[Sum]", 
                    RowBox[{"k", "=", "1"}], "i"], 
                   SuperscriptBox[
                    RowBox[{"x", "[", "k", "]"}], "2"]}]}]}], ")"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "||", 
                    RowBox[{"i", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "i", "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"h", "\[Equal]", "1"}], "||", 
                    RowBox[{"h", "\[Equal]", "s2"}]}], ",", "2", ",", "1"}], 
                   "]"}], 
                  RowBox[{"y", "[", "h", "]"}]}]}], ")"}]}]}], ",", "0"}], 
            "]"}]}], "-", 
          RowBox[{"y", "[", "i", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.6929630874974546`*^9}, {3.692963191215775*^9, 3.692963217125394*^9}, 
   3.692963447174942*^9, {3.6929635650700083`*^9, 3.6929635658683968`*^9}, 
   3.692963942883462*^9, 3.6929743258585653`*^9, {3.696747051467498*^9, 
   3.6967470536969023`*^9}, {3.6967473237742357`*^9, 
   3.6967473245897617`*^9}, {3.696747366748872*^9, 3.696747368779768*^9}},
 Background->GrayLevel[0.85]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Jacobians", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JacobianOfExpectedMove", "[", "EM_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{
          RowBox[{"Length", "[", "EM", "]"}], "-", "2"}]}], ",", "s1", ",", 
        "s2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{"EM", ",", 
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"x", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"y", "[", "j", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}], "]"}], "}"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ProjectedJacobian", "[", "EM_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Length", "[", "EM", "]"}], "-", "2"}]}], ",", "s1", ",", 
       "s2", ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
      RowBox[{"s2", "=", 
       RowBox[{"IntegerPart", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]1", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s1"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalPhi]2", "=", 
       RowBox[{
        RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
        RowBox[{
         FractionBox["1", "s2"], 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}], ".", 
       RowBox[{"JacobianOfExpectedMove", "[", "EM", "]"}], ".", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exact rest points (Gr\[ODoubleDot]bner bases)", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExactRestPoints", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"verbosity_:", "5"}], ",", 
      RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
        ",", "vars", ",", "basis", ",", "sol"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EM", "=", 
        RowBox[{"ExpectedMove", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "5"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Expected Move: \\n\>\"", ",", " ", 
           RowBox[{"MatrixForm", "@", "EM"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"tieBreakingRule", "==", "\"\<stick\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "We", " ", "have", " ", "to", " ", "remove", " ", "the", " ", 
           "vertex"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<\!\(\*
StyleBox[\"IMPORTANT\",
FontVariations->{\"Underline\"->True}]\): To get a polynomial system with a \
finite solution set we have to impose the additional restriction x[1]\
\[NotEqual]1.\\nThis is done by adding the polynomial \
(x[1]-1)*z\[Equal]1.\\nThus, even though x[1]=y[1]=1 is indeed a rest point, \
it will not appear below.\>\"", "]"}], ";", "  ", "\[IndentingNewLine]", 
          RowBox[{"vars", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "z", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"basis", "=", 
           RowBox[{"GroebnerBasis", "[", 
            RowBox[{
             RowBox[{"Join", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"EM", "\[Equal]", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], ",", 
               
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"x", "[", "1", "]"}], "-", "1"}], ")"}], "*", 
                  "z"}], "\[Equal]", "1"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"y", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             "vars"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"vars", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"y", "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"basis", "=", 
           RowBox[{"GroebnerBasis", "[", 
            RowBox[{
             RowBox[{"Join", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"EM", "\[Equal]", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"Length", "[", "EM", "]"}]}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}], ",", 
                 RowBox[{
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{"y", "[", "j", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", 
                  "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             "vars"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Gr\[ODoubleDot]bner basis: \\n\>\"", ",", " ", 
           RowBox[{"MatrixForm", "@", "basis"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Variables in Gr\[ODoubleDot]bner basis: \\n\>\"", ",", 
            RowBox[{"Map", "[", 
             RowBox[{"Variables", ",", "basis"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", "\"\<Max degrees in Gr\[ODoubleDot]bner basis:\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"MatrixForm", "@", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Exponent", "[", 
                  RowBox[{"#", ",", "vars"}], "]"}], "&"}], ",", "basis"}], 
               "]"}], ",", "vars"}], "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"{", 
         RowBox[{"ToRules", "[", "\[IndentingNewLine]", 
          RowBox[{"Reduce", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"basis", "\[Equal]", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"Length", "[", "basis", "]"}]}], "]"}]}], "}"}], 
              ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"0", "\[LessEqual]", 
                 RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"0", "\[LessEqual]", 
                 RowBox[{"y", "[", "j", "]"}], "\[LessEqual]", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "s2"}], "}"}]}], "]"}]}], "]"}], ",", 
            "Reals", ",", 
            RowBox[{"Backsubstitution", "\[Rule]", "True"}]}], "]"}], 
          "\[IndentingNewLine]", "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Numerical approximation to exact solution computed using the \
Gr\[ODoubleDot]bner basis: \\n\>\"", ",", " ", 
            RowBox[{"(", 
             RowBox[{"sol", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                    ")"}], ":>", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                    ")"}], ":>", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                  RowBox[{"(", 
                   RowBox[{"z", "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
               "}"}]}], ")"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "sol"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NExactRestPoints", "[", 
   RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
    RowBox[{"verbosity_:", "3"}], ",", 
    RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sol", "=", 
      RowBox[{"ExactRestPoints", "[", 
       RowBox[{
       "testSetRule", ",", "tieBreakingRule", ",", "n", ",", "verbosity", ",",
         "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Exact solution of Gr\[ODoubleDot]bner basis in the simplex: \\n\
\>\"", ",", " ", "sol"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"sol", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}], ")"}],
            ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "->", 
             RowBox[{"N", "[", 
              RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}], ")"}],
            ":>", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "->", 
             RowBox[{"N", "[", 
              RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
           RowBox[{"(", 
            RowBox[{"z", "->", 
             RowBox[{"N", "[", 
              RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
        "}"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, 
   3.693134475591817*^9, 3.693134523348681*^9, 3.693134598623486*^9, {
   3.69315957327136*^9, 3.693159598401268*^9}, {3.693933994694413*^9, 
   3.6939339979696627`*^9}, {3.693934112492138*^9, 3.693934114915821*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Approximate rest points (floating-point and rational approximations)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693122858808473*^9, 3.693122871430587*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClipTo01", "[", "v_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"v", "<", "0"}], ",", "0", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"v", ">", "1"}], ",", "1", ",", "v"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetAttributes", "[", 
    RowBox[{"ClipTo01", ",", "Listable"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ProjectOnSimplex", "[", "v_", "]"}], ":=", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"ClipTo01", "[", "v", "]"}], ",", "Total"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FloatingPointApproximateRestPoint", "::", "usage"}], "=", 
   "\"\<FloatingPointApproximateRestPoint[testSetRule_,tieBreakingRule_ \
,n_,step_:2.^-4]\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FloatingPointApproximateRestPoint", "[", 
     RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
      RowBox[{"step_:", 
       RowBox[{"2.", "^", 
        RowBox[{"-", "4"}]}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
        ",", "\[CapitalPhi]1", ",", "\[CapitalPhi]2", ",", "P", ",", "vars", 
        ",", "CompiledNextIteration", ",", "Compiledfpoint"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EM", "=", 
        RowBox[{"ExpectedMove", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]1", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s1"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]2", "=", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
         RowBox[{
          FractionBox["1", "s2"], 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[CapitalPhi]1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[CapitalPhi]2"}], "}"}]}], "}"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"x", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"y", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"CompiledNextIteration", "=", 
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", "vars", "]"}], ",", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"x", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"ProjectOnSimplex", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"y", "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], "]"}]}], "]"}], 
            "+", 
            RowBox[{"step", "*", 
             RowBox[{"P", ".", "EM"}]}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Compiledfpoint", "=", 
        RowBox[{"Clip", "[", 
         RowBox[{
          RowBox[{"FixedPoint", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"CompiledNextIteration", "@@", "#"}], ")"}], "&"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s1"}], ",", "s1"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"1.", "/", "s2"}], ",", "s2"}], "]"}]}], "]"}], ",", 
            RowBox[{"10", "^", "4"}], ",", 
            RowBox[{"SameTest", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"#1", "-", "#2"}], "]"}], "<", 
                RowBox[{"10", "^", 
                 RowBox[{"-", "20"}]}]}], "&"}], ")"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Thread", "[", 
        RowBox[{"vars", "\[Rule]", "Compiledfpoint"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RationalApproximateRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"step_:", "1"}], ",", 
     RowBox[{"minIterations_:", "1"}], ",", 
     RowBox[{"maxIterations_:", "200"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", "EM", 
       ",", "fixedPoint", ",", "iterations", ",", 
       RowBox[{"oldFixedPointStr", "=", "\"\<old\>\""}], ",", 
       RowBox[{"newFixedPointStr", "=", "\"\<new\>\""}], ",", "vars", ",", 
       RowBox[{"scientificDigits", "=", "3"}], ",", 
       RowBox[{"decimalPlaces", "=", "6"}], ",", "headings", ",", "Nice"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EM", "=", 
       RowBox[{"ExpectedMove", "[", 
        RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fixedPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Nice", "[", "a_", "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"a", "<", 
          RowBox[{"10", "^", 
           RowBox[{"-", "4"}]}]}], ",", 
         RowBox[{"ScientificForm", "[", 
          RowBox[{
           RowBox[{"N", "[", "a", "]"}], ",", "scientificDigits"}], "]"}], 
         ",", 
         RowBox[{"NumberForm", "[", 
          RowBox[{
           RowBox[{"N", "[", "a", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"decimalPlaces", "+", "4"}], ",", "decimalPlaces"}], 
            "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"Nice", ",", "Listable"}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"headings", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<x[\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "Italic", ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"i", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<]\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<y[\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "Italic", ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"i", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}], ",", 
                   RowBox[{"Style", "[", 
                    RowBox[{"\"\<]\>\"", ",", "Bold", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Palatino\>\""}], 
                    ",", "14"}], "]"}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}], ",", 
            "None"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Floating-point approximation to rest point:\\n\\t\>\"", ",", 
           RowBox[{"TableForm", "[", 
            RowBox[{
             RowBox[{"Nice", "[", "fixedPoint", "]"}], ",", 
             RowBox[{"TableHeadings", "\[Rule]", "headings"}], ",", 
             RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
             RowBox[{"TableSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"3", ",", "Automatic"}], "}"}]}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"iterations", "=", "1"}], ",", 
        RowBox[{
         RowBox[{"iterations", "\[LessEqual]", "minIterations"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"iterations", "\[LessEqual]", "maxIterations"}], "&&", 
           RowBox[{"(", 
            RowBox[{"oldFixedPointStr", "\[NotEqual]", "newFixedPointStr"}], 
            ")"}]}], ")"}]}], ",", 
        RowBox[{"iterations", "++"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "The", " ", "following", " ", "three", " ", "lines", " ", "of", " ",
            "code", " ", "should", " ", "not", " ", "be", " ", "necessary", 
           " ", "in", " ", "principle"}], ",", " ", 
          RowBox[{
          "but", " ", "they", " ", "are", " ", "vital", " ", "to", " ", 
           "speed", " ", "up", " ", "the", " ", "execution"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fixedPoint", "=", 
          RowBox[{"N", "[", 
           RowBox[{"fixedPoint", ",", "16"}], "]"}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Here", " ", "we", " ", "are", " ", "taking", " ", "the", " ", 
            "16", " ", "most", " ", "significant", " ", "digits", " ", "of", 
            " ", "fixedPoint"}], ",", " ", 
           RowBox[{"which", " ", "is", " ", "a", " ", "rational", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "except", " ", "at", " ", "the", " ", "very", " ", "first", 
                " ", "iteration"}], ",", " ", 
               RowBox[{
               "where", " ", "it", " ", "is", " ", "a", " ", "machine", " ", 
                "number"}]}], ")"}], "."}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "fixedPoint", " ", "now", " ", "is", " ", "NOT", " ", "an", " ", 
              "IEEE", " ", "754", " ", "floating"}], "-", 
             RowBox[{"point", " ", "number", " ", 
              RowBox[{"(", 
               RowBox[{
               "except", " ", "at", " ", "the", " ", "very", " ", "first", 
                " ", "iteration"}], ")"}]}]}], ";", " ", 
            RowBox[{
            "it", " ", "is", " ", "a", " ", "number", " ", "with", " ", "16", 
             " ", "digits", " ", "of", " ", "precision"}]}], ",", " ", 
           RowBox[{
           "and", " ", "will", " ", "be", " ", "rationalized", " ", "at", " ",
             "the", " ", "next", " ", "line", " ", "of", " ", "code"}]}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"Rationalize", "[", 
           RowBox[{"fixedPoint", ",", "0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{
              RowBox[{"fixedPoint", "[", 
               RowBox[{"[", 
                RowBox[{";;", "s1"}], "]"}], "]"}], ",", "Total"}], "]"}], 
            ",", 
            RowBox[{"Normalize", "[", 
             RowBox[{
              RowBox[{"fixedPoint", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}], ",", 
              "Total"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"oldFixedPointStr", "=", 
          RowBox[{"ToString", "[", 
           RowBox[{"Nice", "[", "fixedPoint", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fixedPoint", "=", 
          RowBox[{"fixedPoint", " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{"EM", "/.", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{"vars", "\[Rule]", "fixedPoint"}], "]"}], ")"}]}], 
            ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newFixedPointStr", "=", 
          RowBox[{"ToString", "[", 
           RowBox[{"Nice", "[", "fixedPoint", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<\\n\>\"", ",", "iterations", " ", ",", 
              "\"\< iterations with rational arithmetic conducted:\\n\\t\>\"",
               ",", 
              RowBox[{"TableForm", "[", 
               RowBox[{
                RowBox[{"Nice", "[", "fixedPoint", "]"}], ",", 
                RowBox[{"TableHeadings", "\[Rule]", "headings"}], ",", 
                RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
                RowBox[{"TableSpacing", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "Automatic"}], "}"}]}]}], "]"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "When", " ", "we", " ", "go", " ", "out", " ", "of", " ", "the", " ", 
         "loop", " ", "For", " ", "above", " ", "because", " ", 
         RowBox[{"(", 
          RowBox[{
          "oldFixedPointStr", " ", "\[Equal]", " ", "newFixedPointStr"}], 
          ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "know", " ", "that", " ", "we", " ", "have", " ", "found",
           " ", "a", " ", "rational", " ", "point", " ", "x", " ", "such", 
          " ", "that", " ", 
          RowBox[{"Nice", "[", "x", "]"}]}], " ", "==", " ", 
         RowBox[{"Nice", "[", 
          RowBox[{"x", " ", "+", " ", 
           RowBox[{"(", 
            RowBox[{"EM", "/.", 
             RowBox[{"(", 
              RowBox[{"Thread", "[", 
               RowBox[{"vars", "\[Rule]", "x"}], "]"}], ")"}]}], ")"}]}], 
          "]"}]}], ",", " ", 
        RowBox[{
        "with", " ", "all", " ", "the", " ", "operations", " ", "conducted", 
         " ", "using", " ", 
         RowBox[{"(", "exact", ")"}], " ", "rational", " ", "arithmetic"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"vars", "\[Rule]", "fixedPoint"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.6930782387289886`*^9, 3.693078300364564*^9}, 
   3.693078716564457*^9, {3.693079235598392*^9, 3.693079247072733*^9}, {
   3.6930794380101223`*^9, 3.693079467990863*^9}, {3.693136319502043*^9, 
   3.6931363234150133`*^9}, {3.6931364139910517`*^9, 3.693136422482757*^9}, {
   3.6931364760342283`*^9, 3.6931364895659723`*^9}, {3.693137612361279*^9, 
   3.693137639350355*^9}, {3.693138063131918*^9, 3.693138078261816*^9}, {
   3.693138236617819*^9, 3.69313826843231*^9}, {3.693138335247323*^9, 
   3.6931383461365747`*^9}, {3.693138381338953*^9, 3.693138419050747*^9}, {
   3.693138541970661*^9, 3.6931385423167763`*^9}, {3.693138669589295*^9, 
   3.693138677665885*^9}, {3.693138875093635*^9, 3.693138985750143*^9}, {
   3.69314775298455*^9, 3.693147767314724*^9}, {3.6931478261887407`*^9, 
   3.693147826626112*^9}, {3.693147865128304*^9, 3.6931478769311333`*^9}, {
   3.6931492699806356`*^9, 3.693149292849177*^9}, {3.693149492415955*^9, 
   3.6931495075803022`*^9}, {3.693149547700653*^9, 3.69314956667762*^9}, 
   3.693149870172721*^9, {3.693150036166513*^9, 3.693150263738756*^9}, {
   3.6932069453918133`*^9, 3.6932069566155987`*^9}, {3.693206998202588*^9, 
   3.6932070158794947`*^9}, 3.693207198035336*^9, {3.6932072330008574`*^9, 
   3.6932072601728973`*^9}, {3.693207392339109*^9, 3.693207392541028*^9}, {
   3.693207575457324*^9, 3.693207619068685*^9}, {3.693207666072659*^9, 
   3.693207666274315*^9}, {3.693207727272704*^9, 3.693207731209276*^9}, {
   3.693207773554965*^9, 3.693207779589684*^9}, {3.6932078371624813`*^9, 
   3.6932078503901377`*^9}, {3.693207910610713*^9, 3.693207911060623*^9}, {
   3.693207985390582*^9, 3.693207985748513*^9}, {3.693208016707836*^9, 
   3.6932080255509253`*^9}, {3.6932080754216423`*^9, 3.693208080753087*^9}, {
   3.6932081684126987`*^9, 3.6932081687501087`*^9}, {3.693208297166788*^9, 
   3.693208338217551*^9}, {3.6932083994970827`*^9, 3.69320843799277*^9}, {
   3.693209085930689*^9, 3.693209102904922*^9}, {3.6932091393151503`*^9, 
   3.693209178427332*^9}, {3.693209212806425*^9, 3.693209247713369*^9}, {
   3.693209280339925*^9, 3.693209311592454*^9}, {3.693209371981536*^9, 
   3.693209430085087*^9}, {3.6932094713504066`*^9, 3.693209496618821*^9}, 
   3.6932119275955763`*^9, {3.693212031759049*^9, 3.693212071942574*^9}, {
   3.693212127831294*^9, 3.6932121407798357`*^9}, {3.693212174621189*^9, 
   3.693212197479657*^9}, {3.693212450264653*^9, 3.6932124594678097`*^9}, {
   3.693212498166594*^9, 3.693212510776452*^9}, 3.693212599965467*^9, 
   3.693212694409498*^9, {3.69321276407168*^9, 3.693212764573299*^9}, {
   3.6932671980200167`*^9, 3.693267204373417*^9}, {3.6932672654402847`*^9, 
   3.6932672715362597`*^9}, {3.693267390415722*^9, 3.693267395050537*^9}, {
   3.693267464026039*^9, 3.693267625509468*^9}, {3.69338734971747*^9, 
   3.693387412547888*^9}, {3.693387599520523*^9, 3.693387600389485*^9}, {
   3.693387631435237*^9, 3.693387634666725*^9}, {3.696763975699391*^9, 
   3.696763988261155*^9}, {3.696764240551014*^9, 3.696764241181069*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigenvalues at approximate rest points", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "projectedJacobian", ",", "fixedPointRules", ",", "eigenvalues", ",", 
       RowBox[{"scientificDigits", "=", "3"}], ",", 
       RowBox[{"decimalPlaces", "=", "4"}], ",", "niceEigenvalues", ",", 
       "Nice"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"projectedJacobian", "=", 
       RowBox[{"ProjectedJacobian", "[", 
        RowBox[{"ExpectedMove", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixedPointRules", "=", 
       RowBox[{"RationalApproximateRestPoint", "[", 
        RowBox[{
        "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
         "verbosity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eigenvalues", "=", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{"projectedJacobian", "/.", "fixedPointRules"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Nice", "[", "a_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "a", "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "2"}]]}], ",", 
            RowBox[{"ScientificForm", "[", 
             RowBox[{"a", ",", "scientificDigits"}], "]"}], ",", 
            RowBox[{"NumberForm", "[", 
             RowBox[{"a", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"decimalPlaces", "+", "4"}], ",", "decimalPlaces"}], 
               "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"niceEigenvalues", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Nice", "[", 
                RowBox[{"Re", "[", "#", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"Nice", "[", 
                 RowBox[{"Im", "[", "#", "]"}], "]"}], "*", "I"}]}], ")"}], 
             "&"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{"eigenvalues", ",", "16"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Approximate eigenvalues:\\n\>\"", ",", 
           RowBox[{"TableForm", "[", 
            RowBox[{"niceEigenvalues", ",", 
             RowBox[{"TableHeadings", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{
                    RowBox[{"\"\<\[Lambda]\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], ",", "Bold", ",", 
                    "14"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"n", "+", "2"}]}], "}"}]}], "]"}], ",", "None"}], 
               "}"}]}], ",", 
             RowBox[{"TableDirections", "\[Rule]", "Row"}], ",", 
             RowBox[{"TableSpacing", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"3", ",", "Automatic"}], "}"}]}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "eigenvalues"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, 
   3.693119174720704*^9, 3.693119643490077*^9},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Local stability of interior rest point (perturbation theorem)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.693122910064415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LocalStabilityOfInteriorRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "5"}], ",", 
     RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorRestPoint", ",", "projectedJacobian", ",", "closeRational", 
       ",", "eigensystem", ",", "eigenvalues", ",", "eigenvectors", ",", 
       "tolerance", ",", "xVector", ",", "yVector"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"y", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorRestPoint", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"ExactRestPoints", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
           "verbosity"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "/.", "#"}], ")"}], "\[NotEqual]",
             "1"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "interiorRestPoint", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interiorRestPoint", "=", 
          RowBox[{"First", "[", "interiorRestPoint", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to interior exact solution: \\n\>\"",
              ",", " ", 
             RowBox[{"(", 
              RowBox[{"interiorRestPoint", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{"z", "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"projectedJacobian", "=", 
          RowBox[{"ProjectedJacobian", "[", 
           RowBox[{"ExpectedMove", "[", 
            RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
            "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"closeRational", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"xVector", ",", "yVector"}], "]"}], "\[Rule]", " ", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"xVector", "/.", "interiorRestPoint"}], ",", 
                    "10"}], "]"}], ",", "0"}], "]"}], ",", "Total"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Normalize", "[", 
               RowBox[{
                RowBox[{"Rationalize", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{
                    RowBox[{"yVector", "/.", "interiorRestPoint"}], ",", 
                    "10"}], "]"}], ",", "0"}], "]"}], ",", "Total"}], "]"}]}],
              "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Rational point close to interior exact solution: \\n\>\"", 
              ",", " ", "closeRational"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Numerical approximation to rational point close to interior \
exact solution: \\n\>\"", ",", " ", 
              RowBox[{"N", "[", "closeRational", "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"eigensystem", "=", 
          RowBox[{"Eigensystem", "[", 
           RowBox[{"projectedJacobian", "/.", "closeRational"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"eigenvalues", "=", 
          RowBox[{"First", "[", "eigensystem", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigenvectors", "=", 
          RowBox[{"Last", "[", "eigensystem", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "6"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Eigenvalues at close rational point:\\n\>\"", ",", 
             "eigenvalues"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<N@ Eigenvalues at close rational point:\\n\>\"", ",", 
             RowBox[{"N", "@", "eigenvalues"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "6"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Eigenvectors at close rational point (in rows):\\n\>\"", ",", 
             RowBox[{"MatrixForm", "@", "eigenvectors"}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "5"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<N@ Eigenvectors at close rational point (in rows):\\n\>\"", 
             ",", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"N", "[", "eigenvectors", "]"}], "]"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "eigenvectors", "]"}], "\[NotEqual]", 
            RowBox[{"n", "+", "2"}]}], ",", 
           RowBox[{"Print", "[", "\"\<\!\(\*
StyleBox[\"WARNING\",
FontVariations->{\"Underline\"->True}]\)\!\(\*
StyleBox[\"!\",
FontVariations->{\"Underline\"->True}]\) Number of eigenvectors \[NotEqual] \
Number of dimensions\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", "\"\<Computing tolerance... \>\"", "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"$MaxExtraPrecision", "=", "50"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"tolerance", "=", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"eigenvectors", ",", "\[Infinity]"}], "]"}], ",", 
               "40"}], "]"}], "*", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"projectedJacobian", "/.", "closeRational"}], 
                    ")"}], "-", 
                   RowBox[{"(", 
                    RowBox[{"projectedJacobian", "/.", "interiorRestPoint"}], 
                    ")"}]}], "]"}], ",", "\[Infinity]"}], "]"}], ",", "40"}], 
              "]"}], "*", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"Inverse", "[", "eigenvectors", "]"}], ",", 
                 "\[Infinity]"}], "]"}], ",", "40"}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Tolerance computed with perturbation theorem: \>\"", ",", 
             "tolerance"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Precision of tolerance: \>\"", ",", 
              RowBox[{"Precision", "[", "tolerance", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Accuracy of tolerance: \>\"", ",", 
              RowBox[{"Accuracy", "[", "tolerance", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Real Digits of tolerance: \>\"", ",", 
              RowBox[{"RealDigits", "[", "tolerance", "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<The real part of the relevant eigenvalues at the interior \
rest point is no more than:\\n\>\"", ",", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{
                RowBox[{"eigenvalues", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", 
                   RowBox[{"-", "3"}]}], "]"}], "]"}], " ", ",", "6"}], "]"}],
               "+", " ", 
              RowBox[{"10", "*", "tolerance"}]}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "@", 
            RowBox[{"Reduce", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Or", "@@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "\[GreaterEqual]", "#2"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{
                    RowBox[{"eigenvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"-", "3"}]}], "]"}], "]"}], " ", "+", " ", 
                    RowBox[{"10", "*", 
                    RowBox[{"Rationalize", "[", 
                    RowBox[{"tolerance", ",", "0"}], "]"}]}]}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"eigenvalues", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"-", "3"}]}], "]"}], "]"}], "]"}]}], "]"}]}], 
                   "}"}]}], "]"}]}], "}"}], ",", "Reals"}], "]"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<Apart from the two zero eigenvalues, all eigenvalues have \
strictly negative real part\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{
            "Return", "[", 
             "\"\<The interior rest point is (locally) asymptotically \
stable\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<There seems to be at least one eigenvalue with positive \
real part\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "Return", "[", "\"\<Local stability analysis is inconclusive\>\"",
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Return", "[", "\"\<There is no interior rest point\>\"", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693123940611732*^9, 3.693123942309989*^9}, 
   3.693134579229377*^9, 3.69313461170756*^9, {3.696764552369035*^9, 
   3.696764561943048*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Global stability of interior rest point (exact Lyapunov function)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GlobalStabilityOfInteriorRestPoint", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"prec_:", "precision"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorRestPointRules", ",", "interiorRestPoint", ",", 
       "reducedInteriorRestPoint", ",", "otherPointsWhereDerivativeEquals0", 
       ",", "xVector", ",", "yVector"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"yVector", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"y", "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorRestPointRules", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"ExactRestPoints", "[", 
          RowBox[{
          "testSetRule", ",", "tieBreakingRule", " ", ",", "n", ",", 
           "verbosity"}], "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "[", "1", "]"}], "/.", "#"}], ")"}], "\[NotEqual]",
             "1"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "interiorRestPointRules", "]"}], ">", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interiorRestPointRules", "=", 
          RowBox[{"First", "[", "interiorRestPointRules", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Numerical approximation to interior exact solution: \\n\>\"",
              ",", " ", 
             RowBox[{"(", 
              RowBox[{"interiorRestPointRules", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", "num_"}],
                     ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}], 
                 ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"z", "\[Rule]", "num_"}], ")"}], ":>", 
                   RowBox[{"(", 
                    RowBox[{"z", "->", 
                    RowBox[{"N", "[", 
                    RowBox[{"num", ",", "prec"}], "]"}]}], ")"}]}], ")"}]}], 
                "}"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"testSetRule", "\[Equal]", "\"\<two\>\""}], "&&", 
            RowBox[{"tieBreakingRule", "\[Equal]", "\"\<min\>\""}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Distance", " ", "to", " ", "interior", " ", "rest", " ", 
             "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"interiorRestPoint", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{"xVector", ",", "yVector"}], "]"}], "/.", 
              "interiorRestPointRules"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Lyapunov function: euclidean distance to interior rest \
point, i.e. distance to:\\n\>\"", ",", " ", "interiorRestPointRules"}], "]"}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[Rule]", 
                   RowBox[{"N", "@", "interiorRestPoint"}]}], "]"}]}], "]"}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", 
                "\"\<Checking whether the derivative of the Lyapunov function \
is always different from zero (except at the rest points)...\>\"", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"otherPointsWhereDerivativeEquals0", "=", 
             RowBox[{"CylindricalDecomposition", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ExpectedMove", "[", 
                    RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}],
                     "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "-", 
                    "interiorRestPoint"}], ")"}]}], "\[Equal]", "0"}], "}"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"y", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "s2"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Total", "[", "xVector", "]"}], "\[Equal]", "1"}],
                    ",", 
                   RowBox[{
                    RowBox[{"Total", "[", "yVector", "]"}], "\[Equal]", 
                    "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[NotEqual]",
                    "interiorRestPoint"}], "}"}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{"xVector", ",", "yVector"}], "]"}], "\[NotEqual]", 
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"s1", "-", "1"}]}], "]"}], ",", 
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"s2", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Join", "[", 
                RowBox[{"xVector", ",", "yVector"}], "]"}]}], "]"}]}], ";"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Reduced", " ", "Distance", " ", "to", " ", "interior", " ", 
             "rest", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"reducedInteriorRestPoint", "=", 
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "/.", 
              "interiorRestPointRules"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<Lyapunov function: euclidean distance to interior rest \
point ignoring x[1] and y[1], i.e. distance to:\\n\>\"", ",", " ", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "\[Rule]",
                    "reducedInteriorRestPoint"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "\[Rule]", 
                   RowBox[{"N", "@", "reducedInteriorRestPoint"}]}], "]"}]}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{
               "Print", "[", 
                "\"\<Checking whether the derivative of the Lyapunov function \
is always different from zero (except at the rest points)...\>\"", "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"otherPointsWhereDerivativeEquals0", "=", 
             RowBox[{"CylindricalDecomposition", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ExpectedMoveWithoutFirstVariables", "[", 
                    RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}],
                     "]"}], ".", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], "-", 
                    "reducedInteriorRestPoint"}], ")"}]}], "\[Equal]", "0"}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"x", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"0", "\[LessEqual]", 
                    RowBox[{"y", "[", "i", "]"}], "\[LessEqual]", "1"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"x", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s1"}], "}"}]}], "]"}], 
                    "\[LessEqual]", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"y", "[", "i", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "s2"}], "}"}]}], "]"}], 
                    "\[LessEqual]", "1"}]}], "}"}], ","}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], 
                   "\[NotEqual]", "reducedInteriorRestPoint"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                    RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}], 
                   "\[NotEqual]", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", "n"}], "]"}]}], "}"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Rest", "[", "xVector", "]"}], ",", 
                 RowBox[{"Rest", "[", "yVector", "]"}]}], "]"}]}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"otherPointsWhereDerivativeEquals0", "===", "False"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              RowBox[{
              "Print", "[", 
               "\"\<The derivative of the Lyapunov function is always \
different from zero (except at the rest points)\>\"", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Return", "[", 
             "\"\<The interior point is almost globally asymptotically stable\
\>\"", "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{
                "\"\<There are other points where the derivative of the \
Lyapunov function equals 0:\\n\>\"", ",", 
                 "otherPointsWhereDerivativeEquals0"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", 
                RowBox[{"\"\<\\twith numerical approximation:\\n\\t\>\"", ",", 
                 RowBox[{"N", "@", "otherPointsWhereDerivativeEquals0"}]}], 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Return", "[", 
             "\"\<Global stability analysis is inconclusive\>\"", "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Return", "[", "\"\<There is no interior rest point\>\"", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Initial conditions (RandomPoints and MeshPoints)", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.6935481457963953`*^9, 3.693548153805209*^9}, 3.6935484636113663`*^9, {
   3.6967558852074213`*^9, 3.696755908028101*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomPoints", "::", "usage"}], "=", "\"\<RandomPoints[\!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\)] returns a list of \!\(\*
StyleBox[\"nPoints\",
FontSlant->\"Italic\"]\) random points for a centipede game of length \!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\)\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomPoints", "[", 
     RowBox[{"n_", ",", "nPoints_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
        RowBox[{"s2", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Total", "[", "#", "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"1", ",", "s1"}], "]"}], ",", "nPoints"}], "]"}]}], 
           "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "/", 
              RowBox[{"Total", "[", "#", "]"}]}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"RandomReal", "[", 
               RowBox[{"1", ",", "s2"}], "]"}], ",", "nPoints"}], "]"}]}], 
           "]"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SimplexMesh", "::", "usage"}], "=", "\"\<SimplexMesh[\!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)] returns a list of all the possible strategy \
distributions in a population of \!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\) agents who can choose one of \!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\) possible strategies. The number of possible \
distributions is Binomial[\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)+\!\(\*
StyleBox[\"nStrategies\",
FontSlant->\"Italic\"]\)-1,\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SimplexMesh", "[", 
     RowBox[{"nStrategies_", ",", "nAgents_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Permutations", "/@", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"nAgents", ",", 
          RowBox[{"{", "nStrategies", "}"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "nAgents"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
      "/", 
     RowBox[{"N", "@", "nAgents"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeshPoints", "::", "usage"}], "=", "\"\<MeshPoints[\!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\), \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\)] returns a list of all the possible states in a \
centipede game of length \!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)with \!\(\*
StyleBox[\"nAgentsPerPopulation\",
FontSlant->\"Italic\"]\) agents in each population. The number of possible \
distributions is Binomial[\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)+ \!\(\*
StyleBox[\"IntegerPart\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"[\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"(\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"n\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"+\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"3\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\")\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"/\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"2\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)- 1,\!\(\*
StyleBox[\"nAgents\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"]\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"*\",
FontSlant->\"Italic\"]\)\>\""}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MeshPoints", "[", 
    RowBox[{"n_", ",", "nAgentsPerPopulation_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Join", ",", 
         RowBox[{"SimplexMesh", "[", 
          RowBox[{"s1", ",", "nAgentsPerPopulation"}], "]"}], ",", 
         RowBox[{"SimplexMesh", "[", 
          RowBox[{"s2", ",", "nAgentsPerPopulation"}], "]"}], ",", "1"}], 
        "]"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693548160511352*^9, 3.693548453958748*^9}, 
   3.693574850326124*^9, {3.693574883164336*^9, 3.693574991615878*^9}, {
   3.693575023375538*^9, 3.693575063787862*^9}, {3.693575123220561*^9, 
   3.6935752039380827`*^9}, {3.693576077465584*^9, 3.693576295087234*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Numerical global stability of interior rest point (numerical evaluation of an \
approximate Lyapunov function)\
\>", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
    RowBox[{
    "testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", "points_", 
     ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"samplesPerPack_:", 
      RowBox[{"10", "^", "5"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorFPRestPoint", ",", "vars", ",", "packs", ",", "CompiledVdot", 
       ",", "valuesOfVdot", ",", "pos", ",", 
       RowBox[{"nonNegativeValuePoints", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"p", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorFPRestPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Numerical (floating-point) approximation to interior exact \
solution: \\n\>\"", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "\[Rule]", "interiorFPRestPoint"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"packs", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"points", ",", 
         RowBox[{"UpTo", "[", "samplesPerPack", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Distance", " ", "to", " ", "interior", " ", "rest", " ", "point"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Lyapunov function: euclidean distance to (floating-point \
approximation to) the interior rest point.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We now evaluate the derivative of the Lyapunov function at \
\>\"", ",", " ", 
           RowBox[{"Length", "[", "points", "]"}], ",", " ", 
           "\"\< points using (IEEE 754) floating-point arithmetic, in packs \
of up to \>\"", ",", "samplesPerPack", ",", "\"\< points.\>\""}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"CompiledVdot", "=", 
       RowBox[{"Compile", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"ExpectedMove", "[", 
            RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
            "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"vars", "-", "interiorFPRestPoint"}], ")"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"pack", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"valuesOfVdot", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"CompiledVdot", "@@", "#"}], ")"}], "&"}], ",", 
              "pack"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Pack \>\"", ",", " ", "p", ",", 
                "\"\<; Size of pack: \>\"", ",", " ", 
                RowBox[{"Length", "@", "pack"}]}], "]"}], ";", 
              RowBox[{"p", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tFirst \>\"", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"Length", "[", "pack", "]"}]}], "]"}], ",", 
                "\"\< points in pack:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"pack", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t... and their values of Vdot:\\t\>\"", ",", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"valuesOfVdot", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"valuesOfVdot", ",", 
              RowBox[{"_", "?", "NonNegative"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pos", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\tNonnegative values of vdot found at: \>\"", "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t\\tPoints: \>\"", ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                  RowBox[{"Extract", "[", 
                   RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t\\tValues: \>\"", ",", 
                RowBox[{"Extract", "[", 
                 RowBox[{"valuesOfVdot", ",", "pos"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nonNegativeValuePoints", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"nonNegativeValuePoints", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                   RowBox[{"Extract", "[", 
                    RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
                RowBox[{
                "Print", "[", 
                 "\"\<\\tAll values in the pack are negative\\n\>\"", "]"}]}],
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"valuesOfVdot", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", 
                RowBox[{"-", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "15"}]}]}]}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pos", "\[NotEqual]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<\\tValues of vdot greater than -\!\(\*SuperscriptBox[\(10\
\), \(-15\)]\) found at: \>\"", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t\\tPoints: \>\"", ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Thread", "[", 
                    RowBox[{"vars", "\[Rule]", "#"}], "]"}], "&"}], ",", 
                  RowBox[{"Extract", "[", 
                   RowBox[{"pack", ",", "pos"}], "]"}]}], "]"}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\t\\tValues: \>\"", ",", 
                RowBox[{"Extract", "[", 
                 RowBox[{"valuesOfVdot", ",", "pos"}], "]"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
                RowBox[{
                "Print", "[", 
                 "\"\<\\tAll values are below -\!\(\*SuperscriptBox[\(10\), \
\(-15\)]\)\\n\>\"", "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ",", "packs"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "nonNegativeValuePoints", "]"}], ">", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<Below you can see the points we have found where the \
derivative of the Lyapunov function is non-negative. If you can see other \
points beside the \\\"stop-immediately\\\" rest point, that means that the \
chosen function is not a Lyapunov function. Alternatively, if there are no \
points below, or if the only point below is the \\\"stop-immediately\\\" rest \
point, then this means that we have not found numerical evidence that \
contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation would suggest that \
the interior rest point might be almost globally asymptotically stable.\>\"", 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "nonNegativeValuePoints", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<The derivative of the Lyapunov function is negative in all \
evaluated points.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<We have evaluated \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", "points", "]"}], "]"}], ",", 
            "\"\< points and we have not found numerical evidence that \
contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation suggests that the \
interior rest point might be almost globally asymptotically stable\>\""}], 
           "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547839490122*^9, 3.693547842989127*^9}, 
   3.6935478812397327`*^9, {3.693548487373272*^9, 3.693548488599038*^9}, {
   3.6935485938789053`*^9, 3.693548796999235*^9}, {3.693548837095186*^9, 
   3.693548869978437*^9}, {3.69354893253012*^9, 3.6935489619596567`*^9}, {
   3.6935490188515472`*^9, 3.693549086972417*^9}, 3.693549188391201*^9, {
   3.693549351090857*^9, 3.693549351201787*^9}, {3.693549448967774*^9, 
   3.693549449967637*^9}, {3.693549487047615*^9, 3.6935494876095877`*^9}, {
   3.693549523982626*^9, 3.693549524937772*^9}, {3.693549651569436*^9, 
   3.6935496584090967`*^9}, {3.69355086174575*^9, 3.6935508653106728`*^9}, {
   3.693551158466208*^9, 3.693551160154084*^9}, {3.693551194410965*^9, 
   3.693551274354513*^9}, {3.693552474968545*^9, 3.693552476565979*^9}, {
   3.6935525121495037`*^9, 3.6935525154336863`*^9}, {3.693559435220812*^9, 
   3.6935595965915956`*^9}, {3.6935596310636797`*^9, 3.693559664114852*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Numerical global stability of interior rest point (NDSolve)", \
"Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}, {3.693547818767255*^9, 3.693547820801915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NumericalGlobalStabilityOfInteriorRestPointNDSolve", "[", 
    RowBox[{
    "testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", "points_", 
     ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"samplesPerPack_:", 
      RowBox[{"10", "^", "3"}]}], ",", 
     RowBox[{"time_:", "200"}], ",", 
     RowBox[{"tolerance_:", 
      RowBox[{"10.", "^", 
       RowBox[{"-", "4"}]}]}], ",", 
     RowBox[{"accuracyGoal_:", "6"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorFPRestPoint", ",", "vars", ",", "rulesToAddt", ",", 
       "varsWitht", ",", "packs", ",", "Dvars", ",", "projectedEM", ",", 
       RowBox[{"p", "=", "1"}], ",", "FinalPoint", ",", "finalPoints", ",", 
       RowBox[{"problematicPoints", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SetSharedVariable", "[", "problematicPoints", "]"}], ";", " ", 
      
      RowBox[{"(*", 
       RowBox[{"So", " ", "we", " ", "can", " ", "use", " ", "ParallelMap"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varsWitht", "=", 
       RowBox[{"vars", "/.", "rulesToAddt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorFPRestPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Numerical (floating-point) approximation to interior exact \
solution: \\n\>\"", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "\[Rule]", "interiorFPRestPoint"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"projectedEM", "=", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s1"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}], ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s2"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
          "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ExpectedMove", "[", 
           RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}], "]"}], "/.",
           "rulesToAddt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"packs", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{"points", ",", 
         RowBox[{"UpTo", "[", "samplesPerPack", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", "NDSolve", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          
          "\"\<We now solve the differential equation numerically (with \
NDSolve), starting at each of the \>\"", ",", " ", 
           RowBox[{"Length", "[", "points", "]"}], ",", " ", 
           "\"\< points provided, in packs of up to \>\"", ",", 
           "samplesPerPack", ",", "\"\< points.\>\""}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FinalPoint", "[", "initialPoint_", "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"finalTime", "=", "time"}], ",", "sol"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sol", "=", 
           RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"Dvars", "\[Equal]", "projectedEM"}], "]"}], ",", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"varsWitht", "/.", 
                   RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "==", 
                 "initialPoint"}], "]"}], ",", 
               RowBox[{"WhenEvent", "[", 
                RowBox[{
                 RowBox[{"Evaluate", "[", 
                  RowBox[{
                   RowBox[{"Norm", "[", 
                    RowBox[{"varsWitht", "-", "interiorFPRestPoint"}], "]"}], 
                   "<", "tolerance"}], "]"}], ",", " ", 
                 RowBox[{"\"\<StopIntegration\>\"", ";", 
                  RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", "vars", ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "time"}], "}"}], ",", 
             RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"verbosity", "\[GreaterEqual]", "10"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Evaluate", "@", 
                RowBox[{"MapThread", "[", 
                 RowBox[{"Tooltip", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", "sol"}], "]"}], 
                    ",", "vars"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
               RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], "]"}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"finalTime", "\[GreaterEqual]", "time"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Fixed point not reached:\\n\\t\>\"", ",", "initialPoint", 
               ",", "\"\<\\n\\t-> \>\"", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
                "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"problematicPoints", ",", 
               RowBox[{"initialPoint", "\[Rule]", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
                 "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"pack", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"finalPoints", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{"FinalPoint", ",", "pack"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "you", " ", "want", " ", "graphics"}], ",", 
             " ", 
             RowBox[{
             "you", " ", "need", " ", "to", " ", "replace", " ", 
              "ParallelMap", " ", "with", " ", "Map"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Pack \>\"", ",", " ", "p", ",", 
                "\"\<; Size of pack: \>\"", ",", " ", 
                RowBox[{"Length", "@", "pack"}]}], "]"}], ";", 
              RowBox[{"p", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tFirst \>\"", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"10", ",", 
                  RowBox[{"Length", "[", "pack", "]"}]}], "]"}], ",", 
                "\"\< initial points in pack:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"pack", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<\\t... and their corresponding final points:\\t\>\"", ",", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"finalPoints", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ";;", 
                    RowBox[{"Min", "[", 
                    RowBox[{"10", ",", 
                    RowBox[{"Length", "[", "pack", "]"}]}], "]"}]}], "]"}], 
                  "]"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"verbosity", "\[GreaterEqual]", "3"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<\\tProblematic points so far:\\t\>\"", ",", " ", 
                RowBox[{"MatrixForm", "[", "problematicPoints", "]"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", "packs"}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "problematicPoints", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<We have found initial points that did not lead to the \
proximities of the interior rest point. The following are the problematic \
initial conditions and their corresponding end points. If you can see other \
points beside the \\\"stop-immediately\\\" initial condition, you may want to \
try again with a greater value of time or a greater value of tolerance.\>\"", 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "problematicPoints", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
           RowBox[{
           "Print", "[", 
            "\"\<All initial points evaluated led to the proximities of the \
interior rest point.\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<We have evaluated \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", "points", "]"}], "]"}], ",", 
            "\"\< initial points and we have not found numerical evidence \
that contradicts the hypothesis that the interior point is almost globally \
asymptotically stable. In other words, this computation suggests that the \
interior rest point might be almost globally asymptotically stable\>\""}], 
           "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547870609191*^9, 3.693547876840765*^9}, {
   3.693549311547332*^9, 3.693549311635388*^9}, {3.693549416441812*^9, 
   3.693549431000176*^9}, {3.693549678314641*^9, 3.693549684555966*^9}, {
   3.693549725472664*^9, 3.6935497380601587`*^9}, {3.693549774658777*^9, 
   3.693549884615756*^9}, {3.693549935084861*^9, 3.693550159345563*^9}, {
   3.6935501900133963`*^9, 3.6935502047604303`*^9}, {3.693550826467147*^9, 
   3.6935508380755157`*^9}, {3.693550875056007*^9, 3.6935510718406467`*^9}, {
   3.693551306947064*^9, 3.693551314888282*^9}, {3.693551369351716*^9, 
   3.6935514829989223`*^9}, {3.6935515754880238`*^9, 3.693551587602271*^9}, {
   3.693551778113003*^9, 3.693551784648252*^9}, {3.693551896430581*^9, 
   3.693551896621065*^9}, {3.693552009392975*^9, 3.6935520106744537`*^9}, {
   3.693552076071445*^9, 3.693552082382131*^9}, {3.693552190677342*^9, 
   3.6935521924424133`*^9}, {3.693552374064519*^9, 3.693552385159031*^9}, {
   3.6935524365828447`*^9, 3.693552456012289*^9}, {3.693552495342204*^9, 
   3.69355250069598*^9}, {3.693552564608667*^9, 3.693552591214561*^9}, {
   3.693552637522148*^9, 3.69355265384328*^9}, {3.693552720658547*^9, 
   3.693552746308487*^9}, {3.6935527768421803`*^9, 3.693552797754736*^9}, {
   3.6935530058382397`*^9, 3.693553054966484*^9}, {3.693553091497259*^9, 
   3.693553091912405*^9}, {3.6935567557935743`*^9, 3.6935567709909763`*^9}, {
   3.6935593472127132`*^9, 3.6935594054084167`*^9}, 3.693568766414254*^9, {
   3.693569059636038*^9, 3.69356910626648*^9}, {3.693574565047756*^9, 
   3.693574568927229*^9}, {3.693934190497493*^9, 3.693934208719932*^9}, {
   3.69393437710388*^9, 3.693934399119731*^9}, {3.693935983654544*^9, 
   3.693935997152545*^9}},
 Background->GrayLevel[0.85]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve mean dynamics", "Subsection",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{
  3.69296369103893*^9, {3.6929637216735687`*^9, 3.692963735591319*^9}, 
   3.692964078100669*^9, {3.6929746259898977`*^9, 3.69297462997047*^9}, {
   3.693034961076106*^9, 3.693034985806531*^9}, {3.693048092395323*^9, 
   3.693048098029875*^9}, {3.693077380358386*^9, 3.6930773823300533`*^9}, {
   3.6930794923718157`*^9, 3.693079502571559*^9}, {3.6931181747720957`*^9, 
   3.6931181811497602`*^9}, {3.6931183630090923`*^9, 3.693118364695942*^9}, {
   3.693122904584697*^9, 3.6931229410689173`*^9}, 3.6931346290431128`*^9, {
   3.693134785562076*^9, 3.6931348020534277`*^9}, {3.693136120247036*^9, 
   3.693136137762746*^9}, {3.693547818767255*^9, 3.693547820801915*^9}, {
   3.693934271832981*^9, 3.6939342864229116`*^9}, {3.693935338063829*^9, 
   3.693935340399613*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NDSolveMeanDynamics", "[", 
    RowBox[{"testSetRule_", ",", "tieBreakingRule_", " ", ",", "n_", ",", 
     RowBox[{"ip_:", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"verbosity_:", "1"}], ",", 
     RowBox[{"time_:", "300"}], ",", 
     RowBox[{"tolerance_:", 
      RowBox[{"10.", "^", 
       RowBox[{"-", "4"}]}]}], ",", 
     RowBox[{"accuracyGoal_:", "6"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"s2", "=", 
        RowBox[{"IntegerPart", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", "2"}], ")"}], "/", "2"}], "]"}]}], ",", 
       "interiorFPRestPoint", ",", "vars", ",", "rulesToAddt", ",", 
       "varsWitht", ",", "Dvars", ",", "projectedEM", ",", "FinalPoint", ",", 
       "sol", ",", "finalTime", ",", "initialPoint"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ip", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"initialPoint", "=", 
         RowBox[{"First", "[", 
          RowBox[{"RandomPoints", "[", 
           RowBox[{"n", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"initialPoint", "=", "ip"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rulesToAddt", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"x", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
         RowBox[{
          RowBox[{"y", "[", "i_Integer", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"y", "[", "i", "]"}], "[", "t", "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"varsWitht", "=", 
       RowBox[{"vars", "/.", "rulesToAddt"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Dvars", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"y", "[", "i", "]"}], "'"}], "[", "t", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "s2"}], "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"interiorFPRestPoint", "=", 
       RowBox[{"vars", "/.", 
        RowBox[{"FloatingPointApproximateRestPoint", "[", 
         RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "n"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Numerical (floating-point) approximation to interior exact \
solution: \\n\>\"", ",", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"vars", "\[Rule]", "interiorFPRestPoint"}], "]"}]}], 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"projectedEM", "=", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s1", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s1"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s1"}], "}"}]}], "]"}]}]}], ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"IdentityMatrix", "[", "s2", "]"}], "-", 
              RowBox[{
               FractionBox["1", "s2"], 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"s2", ",", "s2"}], "}"}]}], "]"}]}]}]}], "}"}]}], 
          "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ExpectedMove", "[", 
           RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "n"}], "]"}], "/.",
           "rulesToAddt"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "NDSolve", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<We now solve the differential equation numerically (with \
NDSolve), starting at the initial point: \>\"", ",", " ", "initialPoint"}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"finalTime", "=", "time"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"NDSolveValue", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"Dvars", "\[Equal]", "projectedEM"}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"varsWitht", "/.", 
               RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "==", "initialPoint"}],
             "]"}], ",", 
           RowBox[{"WhenEvent", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"varsWitht", "-", "interiorFPRestPoint"}], "]"}], "<",
                "tolerance"}], "]"}], ",", " ", 
             RowBox[{"\"\<StopIntegration\>\"", ";", 
              RowBox[{"finalTime", "=", "t"}]}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "vars", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "time"}], "}"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "accuracyGoal"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "2"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "@", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Tooltip", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", "t", "]"}], "&"}], ",", "sol"}], "]"}], 
                ",", "vars"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", "vars"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"verbosity", "\[GreaterEqual]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "@", 
          RowBox[{"Row", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", "s1"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", "s1"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<First mover\>\""}], ",", 
                
                RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Plot", "[", 
               RowBox[{
                RowBox[{"Evaluate", "@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Tooltip", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", "t", "]"}], "&"}], ",", 
                    RowBox[{"sol", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "]"}], 
                    ",", 
                    RowBox[{"vars", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], "}"}]}],
                   "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "finalTime"}], "}"}], ",", 
                RowBox[{"PlotLegends", "\[Rule]", 
                 RowBox[{"vars", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"s1", "+", "1"}], ";;"}], "]"}], "]"}]}], ",", 
                RowBox[{"PlotLabel", "\[Rule]", "\"\<Second mover\>\""}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\"\<                \>\"", 
            ",", " ", 
            RowBox[{"Frame", "\[Rule]", "True"}], ",", 
            RowBox[{"FrameMargins", "\[Rule]", "15"}], ",", 
            RowBox[{"RoundingRadius", "\[Rule]", "15"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"finalTime", "\[GreaterEqual]", "time"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Fixed point not reached:\\n\\t\>\"", ",", "initialPoint", ",", 
           "\"\<\\n\\t-> \>\"", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], 
            "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"initialPoint", ",", "sol", ",", "finalTime", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", "finalTime", "]"}], "&"}], ",", "sol"}], "]"}]}],
        "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.6929629234064693`*^9, 3.69296294601011*^9}, {
   3.6929629764593973`*^9, 3.692963023195012*^9}, {3.692963069717833*^9, 
   3.69296308749763*^9}, {3.692963219741576*^9, 3.6929632223092957`*^9}, {
   3.692964682290263*^9, 3.692964683447137*^9}, 3.6929654379599857`*^9, 
   3.692965474270513*^9, {3.6930306479026747`*^9, 3.693030679323847*^9}, {
   3.693030798181374*^9, 3.693030879070979*^9}, {3.693030931788656*^9, 
   3.693030954603158*^9}, {3.693034999107688*^9, 3.693035077418137*^9}, {
   3.693035410896613*^9, 3.69303549234416*^9}, {3.693035541228005*^9, 
   3.6930356094477654`*^9}, {3.6930356624252367`*^9, 3.693035791113544*^9}, {
   3.693035839905964*^9, 3.693036109614914*^9}, {3.693036146246714*^9, 
   3.6930361463916597`*^9}, {3.693036194879775*^9, 3.6930361950595427`*^9}, 
   3.693036242693877*^9, 3.693036280662298*^9, {3.693036330084895*^9, 
   3.693036357623316*^9}, {3.693036408700644*^9, 3.693036434495562*^9}, {
   3.693043264799168*^9, 3.693043283381342*^9}, {3.69304341287125*^9, 
   3.6930436838174067`*^9}, {3.693043715050647*^9, 3.693043776744258*^9}, {
   3.693043822498876*^9, 3.693043849025916*^9}, {3.693043917125638*^9, 
   3.69304391757306*^9}, {3.693044030130754*^9, 3.693044030343109*^9}, {
   3.693044079437996*^9, 3.693044093286892*^9}, {3.693044256538232*^9, 
   3.6930442783762493`*^9}, {3.693044334030428*^9, 3.6930443481037273`*^9}, {
   3.693044383744624*^9, 3.693044463439193*^9}, {3.693044522975108*^9, 
   3.6930445253600473`*^9}, {3.693044596764471*^9, 3.693044612603849*^9}, {
   3.6930446590015917`*^9, 3.693044674332452*^9}, {3.693044814679574*^9, 
   3.69304482339705*^9}, {3.693044853998912*^9, 3.693044854143462*^9}, {
   3.6930481835330553`*^9, 3.693048480725987*^9}, {3.693048549151033*^9, 
   3.693048584080016*^9}, {3.6930486994860563`*^9, 3.6930487048623857`*^9}, 
   3.693048758030361*^9, {3.693048982809445*^9, 3.693049014471086*^9}, {
   3.693049058971043*^9, 3.6930490777241583`*^9}, {3.6930491080896*^9, 
   3.693049108267416*^9}, {3.6930491870988283`*^9, 3.6930492642066793`*^9}, {
   3.693049303110132*^9, 3.6930493125378933`*^9}, {3.693049424183223*^9, 
   3.693049495361576*^9}, {3.693049529575734*^9, 3.693049673012764*^9}, {
   3.693049708238514*^9, 3.6930497564094687`*^9}, {3.6930497893169823`*^9, 
   3.693049934903861*^9}, 3.6930499798706007`*^9, {3.693050009887102*^9, 
   3.69305007506955*^9}, 3.69305016346246*^9, {3.693050211567978*^9, 
   3.6930502125788603`*^9}, {3.6930503148544693`*^9, 3.693050342564679*^9}, {
   3.693050402663072*^9, 3.693050420346887*^9}, {3.693050452680172*^9, 
   3.693050499771912*^9}, {3.693050579907385*^9, 3.693050621837256*^9}, {
   3.693050691104643*^9, 3.693050827973007*^9}, {3.6930508618918343`*^9, 
   3.6930508633185062`*^9}, 3.6930510478727283`*^9, {3.693051082427108*^9, 
   3.693051085632002*^9}, {3.6930710340169477`*^9, 3.6930710389418297`*^9}, {
   3.693071166520637*^9, 3.693071177027629*^9}, {3.693071639896963*^9, 
   3.693071654065407*^9}, {3.693071689222386*^9, 3.6930717096625*^9}, {
   3.69307191679068*^9, 3.693071924000499*^9}, {3.6930721151974363`*^9, 
   3.693072139810733*^9}, {3.693072179041892*^9, 3.6930721792989473`*^9}, {
   3.693072216549736*^9, 3.693072259590742*^9}, {3.693072303220688*^9, 
   3.693072306718528*^9}, {3.693072611577721*^9, 3.693072632907782*^9}, {
   3.693072768921667*^9, 3.693072819059703*^9}, {3.693072958403688*^9, 
   3.693072966131928*^9}, {3.6930730020560293`*^9, 3.693073034251113*^9}, {
   3.693073074990279*^9, 3.693073098589579*^9}, {3.693073173356555*^9, 
   3.69307319022351*^9}, {3.693073591854301*^9, 3.693073599243868*^9}, {
   3.693074522080312*^9, 3.693074531433296*^9}, {3.693074563010098*^9, 
   3.693074565011388*^9}, {3.693074632377429*^9, 3.693074656496521*^9}, {
   3.6930747223915167`*^9, 3.693074729455771*^9}, {3.693074765848729*^9, 
   3.693074772237833*^9}, {3.6930748314266148`*^9, 3.693074835623746*^9}, {
   3.693075141173842*^9, 3.6930751920356293`*^9}, {3.693075274726447*^9, 
   3.6930752751645117`*^9}, {3.693075367752994*^9, 3.693075397013144*^9}, {
   3.693075431868629*^9, 3.693075451621839*^9}, {3.6930755163448133`*^9, 
   3.6930755258894*^9}, {3.693075631361353*^9, 3.693075632872354*^9}, {
   3.69307566764463*^9, 3.693075727103052*^9}, {3.693075762340706*^9, 
   3.6930758585040503`*^9}, {3.693076019304442*^9, 3.693076112385638*^9}, {
   3.693076146476161*^9, 3.693076210330202*^9}, {3.693076241133575*^9, 
   3.6930762590646963`*^9}, {3.693076307643962*^9, 3.693076318352318*^9}, {
   3.6930763741338263`*^9, 3.693076401538115*^9}, {3.6930764496657333`*^9, 
   3.693076453353778*^9}, {3.693076489638171*^9, 3.693076526727418*^9}, {
   3.6930765671956577`*^9, 3.693076636383827*^9}, {3.6930766693692513`*^9, 
   3.693076718002123*^9}, 3.693077051669463*^9, {3.693077087469307*^9, 
   3.6930770886823893`*^9}, {3.693077401808311*^9, 3.6930774193324137`*^9}, {
   3.693077461690168*^9, 3.693077490457897*^9}, {3.6930775384838057`*^9, 
   3.693077579218793*^9}, {3.693077694038085*^9, 3.69307770618845*^9}, {
   3.69307774228828*^9, 3.6930777949758987`*^9}, {3.6930778321017523`*^9, 
   3.693077864321579*^9}, {3.6930779203038282`*^9, 3.693078089852343*^9}, {
   3.69307831236777*^9, 3.693078409747609*^9}, 3.69307845669662*^9, {
   3.693078590999906*^9, 3.693078615379839*^9}, 3.693078729321035*^9, {
   3.693078845455121*^9, 3.6930788511232986`*^9}, {3.693078964433717*^9, 
   3.693079007523757*^9}, {3.693079165813501*^9, 3.6930792255070133`*^9}, 
   3.6930793794001627`*^9, {3.6930794800185337`*^9, 3.693079480545126*^9}, {
   3.693118208735978*^9, 3.6931182135957537`*^9}, {3.693118367283942*^9, 
   3.693118367778916*^9}, {3.693119180371903*^9, 3.693119207072216*^9}, {
   3.6931192868366423`*^9, 3.693119457887116*^9}, {3.693119497903677*^9, 
   3.6931195137195873`*^9}, {3.693119557160996*^9, 3.693119626828535*^9}, {
   3.693119687975849*^9, 3.693119806189426*^9}, {3.693119849626981*^9, 
   3.693119878842458*^9}, 3.693119933980702*^9, {3.6931199759426394`*^9, 
   3.6931200499919243`*^9}, {3.693120095228389*^9, 3.693120138495245*^9}, {
   3.693120181561833*^9, 3.693120246102249*^9}, {3.693120497387494*^9, 
   3.6931205895259733`*^9}, {3.693120632006068*^9, 3.693120725301723*^9}, {
   3.693120798621179*^9, 3.693120800239562*^9}, {3.693120845690885*^9, 
   3.6931211828019257`*^9}, {3.693121303808119*^9, 3.693121318173365*^9}, {
   3.693121423283926*^9, 3.693121432564311*^9}, {3.69312160964279*^9, 
   3.693121636045285*^9}, {3.693121723988852*^9, 3.69312176239581*^9}, {
   3.6931218008386917`*^9, 3.693121800927327*^9}, {3.693122233854539*^9, 
   3.693122238354645*^9}, {3.693122306531374*^9, 3.693122339930252*^9}, {
   3.693122435806773*^9, 3.6931225060854797`*^9}, {3.6931226468128557`*^9, 
   3.693122647420671*^9}, {3.693122995635252*^9, 3.6931229964887857`*^9}, {
   3.693123155523423*^9, 3.6931231833092127`*^9}, {3.693123226341736*^9, 
   3.6931237633641357`*^9}, {3.69312379900585*^9, 3.693123861814042*^9}, {
   3.693124042739109*^9, 3.693124187347698*^9}, {3.693124234667306*^9, 
   3.693124241214312*^9}, 3.6931242729625893`*^9, {3.693124313305284*^9, 
   3.6931243433310337`*^9}, {3.693124451220457*^9, 3.693124493814406*^9}, {
   3.693124606775578*^9, 3.693124628611472*^9}, {3.693124667166486*^9, 
   3.693124688756648*^9}, {3.693124726399164*^9, 3.693124726543972*^9}, {
   3.6931247664040937`*^9, 3.6931248204033813`*^9}, {3.693124923297785*^9, 
   3.693124927020896*^9}, {3.693125051010206*^9, 3.69312515297053*^9}, {
   3.693125186731436*^9, 3.693125210096781*^9}, {3.693125250812744*^9, 
   3.693125273322225*^9}, {3.693125308243352*^9, 3.6931253323750134`*^9}, {
   3.693125367902429*^9, 3.6931255235132637`*^9}, {3.693125562485807*^9, 
   3.693125565983643*^9}, {3.6931256116383133`*^9, 3.693125767360626*^9}, {
   3.6931258979792013`*^9, 3.6931259700647497`*^9}, {3.693131157930662*^9, 
   3.693131164933585*^9}, {3.69313158582266*^9, 3.693131642224411*^9}, {
   3.693131674301173*^9, 3.693131678081081*^9}, {3.693131763199751*^9, 
   3.693131792979025*^9}, {3.6931321874196033`*^9, 3.6931321903775597`*^9}, {
   3.693132743909666*^9, 3.6931327442578497`*^9}, {3.693133498162147*^9, 
   3.693133500816671*^9}, {3.693135348121587*^9, 3.6931353524176292`*^9}, {
   3.693136172853754*^9, 3.69313617988503*^9}, 3.693139189469515*^9, {
   3.693212873703341*^9, 3.69321288705133*^9}, {3.6932129469121733`*^9, 
   3.693212947621008*^9}, {3.693212977691599*^9, 3.6932129788953447`*^9}, {
   3.6932130117226677`*^9, 3.693213040922073*^9}, {3.693213075606496*^9, 
   3.693213090544557*^9}, {3.693213203045075*^9, 3.693213233452401*^9}, {
   3.693213266404847*^9, 3.6932132988588457`*^9}, {3.693213334937413*^9, 
   3.693213345703047*^9}, {3.69321338577612*^9, 3.6932136035944433`*^9}, {
   3.693213639043736*^9, 3.693213863510091*^9}, {3.693213921989643*^9, 
   3.693214265884457*^9}, {3.693214323687562*^9, 3.693214499364394*^9}, {
   3.693214539572698*^9, 3.6932149868544607`*^9}, {3.693215147987502*^9, 
   3.693215170407238*^9}, {3.693215244881469*^9, 3.693215413899234*^9}, {
   3.6932154754818363`*^9, 3.693215492919259*^9}, {3.693215656164893*^9, 
   3.693215723282441*^9}, {3.693215808879631*^9, 3.693215859585268*^9}, {
   3.693216116314464*^9, 3.693216128362776*^9}, {3.693216836969988*^9, 
   3.6932168899803543`*^9}, {3.693390077980316*^9, 3.6933900807144537`*^9}, {
   3.693390118370039*^9, 3.693390137369686*^9}, 3.693390225539995*^9, {
   3.693390274633972*^9, 3.693390291005924*^9}, {3.6935088356662083`*^9, 
   3.693508844811535*^9}, {3.693547870609191*^9, 3.693547876840765*^9}, {
   3.693549311547332*^9, 3.693549311635388*^9}, {3.693549416441812*^9, 
   3.693549431000176*^9}, {3.693549678314641*^9, 3.693549684555966*^9}, {
   3.693549725472664*^9, 3.6935497380601587`*^9}, {3.693549774658777*^9, 
   3.693549884615756*^9}, {3.693549935084861*^9, 3.693550159345563*^9}, {
   3.6935501900133963`*^9, 3.6935502047604303`*^9}, {3.693550826467147*^9, 
   3.6935508380755157`*^9}, {3.693550875056007*^9, 3.6935510718406467`*^9}, {
   3.693551306947064*^9, 3.693551314888282*^9}, {3.693551369351716*^9, 
   3.6935514829989223`*^9}, {3.6935515754880238`*^9, 3.693551587602271*^9}, {
   3.693551778113003*^9, 3.693551784648252*^9}, {3.693551896430581*^9, 
   3.693551896621065*^9}, {3.693552009392975*^9, 3.6935520106744537`*^9}, {
   3.693552076071445*^9, 3.693552082382131*^9}, {3.693552190677342*^9, 
   3.6935521924424133`*^9}, {3.693552374064519*^9, 3.693552385159031*^9}, {
   3.6935524365828447`*^9, 3.693552456012289*^9}, {3.693552495342204*^9, 
   3.69355250069598*^9}, {3.693552564608667*^9, 3.693552591214561*^9}, {
   3.693552637522148*^9, 3.69355265384328*^9}, {3.693552720658547*^9, 
   3.693552746308487*^9}, {3.6935527768421803`*^9, 3.693552797754736*^9}, {
   3.6935530058382397`*^9, 3.693553054966484*^9}, {3.693553091497259*^9, 
   3.693553091912405*^9}, {3.6935567557935743`*^9, 3.6935567709909763`*^9}, {
   3.6935593472127132`*^9, 3.6935594054084167`*^9}, 3.693568766414254*^9, {
   3.693569059636038*^9, 3.69356910626648*^9}, {3.693574565047756*^9, 
   3.693574568927229*^9}, {3.693934190497493*^9, 3.693934208719932*^9}, {
   3.6939342908364677`*^9, 3.6939343103788*^9}, {3.693934346762501*^9, 
   3.693934354591413*^9}, {3.693934413263646*^9, 3.693934482674617*^9}, {
   3.693934553686747*^9, 3.693934665694441*^9}, {3.693934698364242*^9, 
   3.69393481757242*^9}, {3.693935125344976*^9, 3.693935148732542*^9}, {
   3.693935357266725*^9, 3.693935358616227*^9}, {3.693935452544137*^9, 
   3.693935458922089*^9}, {3.693935592181519*^9, 3.693935622566729*^9}, {
   3.693935680100809*^9, 3.6939357981939*^9}, {3.69393591118036*^9, 
   3.693935955988894*^9}, {3.6940834949218493`*^9, 3.694083528959385*^9}, {
   3.694083602377006*^9, 3.694083605702134*^9}, {3.694083656314159*^9, 
   3.694083661615933*^9}, {3.69408378051335*^9, 3.6940837850648527`*^9}, {
   3.694083818141468*^9, 3.694083818517556*^9}, {3.694083848610623*^9, 
   3.6940838576498404`*^9}, {3.694083965776401*^9, 3.69408397155042*^9}, {
   3.6940841341457367`*^9, 3.694084153337166*^9}, {3.694084283541135*^9, 
   3.69408429047682*^9}, {3.694084340038885*^9, 3.694084414860186*^9}, {
   3.694084462975082*^9, 3.694084470836763*^9}, {3.694084525329296*^9, 
   3.694084571471583*^9}, {3.6940846548806953`*^9, 3.6940846550855722`*^9}, {
   3.69408475629461*^9, 3.6940848154757967`*^9}, {3.6940848692042837`*^9, 
   3.694084871586136*^9}, {3.694084936168445*^9, 3.6940849616622562`*^9}, {
   3.6940856533508263`*^9, 3.694085655014455*^9}},
 Background->GrayLevel[0.85]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples of usage", "Section",
 InitializationCell->True,
 CellChangeTimes->{{3.692974713726569*^9, 3.692974745779025*^9}, {
  3.692975725474792*^9, 3.6929757289605*^9}, {3.693048053256386*^9, 
  3.6930480564046507`*^9}, {3.6931347632003527`*^9, 3.693134766629697*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testSetRule", "=", "\"\<two\>\""}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Possible", " ", "values", " ", "are", " ", "\"\<all\>\""}], ",", 
    " ", 
    RowBox[{"\"\<two\>\"", " ", "or", " ", "\"\<adj\>\""}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tieBreakingRule", "=", "\"\<min\>\""}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Possible", " ", "values", " ", "are", " ", "\"\<min\>\""}], ",", 
    " ", 
    RowBox[{"\"\<stick\>\"", " ", "or", " ", "\"\<unif\>\""}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", "3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "d", " ", "is", " ", "the", " ", "number", " ", "of", " ", "nodes", " ", 
    "in", " ", "the", " ", "Centipede", " ", "game"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
  RowBox[{"s2", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"verbosity", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "higher", " ", "the", " ", "value", " ", "of", " ", 
     "verbosity"}], ",", " ", 
    RowBox[{
    "the", " ", "more", " ", "messages", " ", "are", " ", "printed", " ", 
     "along", " ", "the", " ", "execution", " ", "of", " ", "any", " ", 
     RowBox[{"function", ".", " ", "0"}], " ", "prints", " ", "no", " ", 
     RowBox[{"messages", ".", " ", "10"}], " ", "prints", " ", "all", " ", 
     "implemented", " ", "messages"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.696741044451886*^9, 3.6967410627063227`*^9}, {
  3.6967413056126876`*^9, 3.6967413058811264`*^9}, {3.696747211861043*^9, 
  3.696747291746255*^9}, {3.6967475351759357`*^9, 3.6967475355440474`*^9}, {
  3.6967477094046926`*^9, 3.696747713855754*^9}, {3.696757025064435*^9, 
  3.696757057055993*^9}, {3.69675774568432*^9, 3.696757808614917*^9}, {
  3.696758754579299*^9, 3.696758755282939*^9}, {3.6967756172360764`*^9, 
  3.696775618538396*^9}, {3.696775803821089*^9, 3.69677581317698*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"ExpectedMove", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "d"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696757833275291*^9, 3.69675783633934*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ExpectedMove", "[", 
     RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "d"}], "]"}], 
    ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", "1"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696758701579878*^9, 3.696758741808259*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ExpectedMoveWithoutLastVariables", "[", 
     RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", "1"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696758895726344*^9, 3.6967589006930447`*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "@", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"ExpectedMoveWithoutFirstVariables", "[", 
     RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"x", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "s1"}], "}"}]}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"y", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "s2"}], "}"}]}], "]"}], "\[Equal]", "1"}]}], 
      "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696758951489704*^9, 3.6967589518138742`*^9}}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"JacobianOfExpectedMove", "@", 
   RowBox[{"ExpectedMove", "[", 
    RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.696758905175666*^9}],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"ProjectedJacobian", "@", 
   RowBox[{"ExpectedMove", "[", 
    RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.696763330784102*^9}],

Cell[BoxData[
 RowBox[{"ExactRestPoints", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.696763434886462*^9, 3.6967634349733143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExactRestPoints", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d", ",", "0"}], "]"}],
   " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.696763494474782*^9, 3.6967635097449217`*^9}}],

Cell[BoxData[
 RowBox[{"FloatingPointApproximateRestPoint", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.6967637160838327`*^9, 3.696763723174424*^9}, {
  3.696763787065752*^9, 3.69676380369665*^9}, {3.696763870809512*^9, 
  3.696763874983334*^9}, {3.696764006117873*^9, 3.696764034822093*^9}}],

Cell[BoxData[
 RowBox[{"RationalApproximateRestPoint", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.6967640589850483`*^9, 3.6967640921847467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RationalApproximateRestPoint", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d", ",", "0"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.69676407758458*^9, 3.696764103214645*^9}}],

Cell[BoxData[
 RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{3.696764130752492*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EigenvaluesAtRationalApproximateRestPoint", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d", ",", "0"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.696764146522924*^9, 3.696764146952986*^9}, 
   3.696764369746152*^9}],

Cell[BoxData[
 RowBox[{"LocalStabilityOfInteriorRestPoint", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.696764411307456*^9, 3.696764417660284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalStabilityOfInteriorRestPoint", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d", ",", "0"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6967644368923264`*^9, 3.6967644370909452`*^9}, 
   3.696764467697729*^9}],

Cell[BoxData[
 RowBox[{"GlobalStabilityOfInteriorRestPoint", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d"}], "]"}]], "Input",
 CellChangeTimes->{{3.696764487792119*^9, 3.6967644896468697`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GlobalStabilityOfInteriorRestPoint", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", ",", "d", ",", "0"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", "above"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "with", " ", "verbosity"}], " ", "=", " ", "0"}]}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.696764507279735*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "6"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "d", " ", "is", " ", "the", " ", "number", " ", "of", " ", "nodes", " ", 
    "in", " ", "the", " ", "Centipede", " ", "game"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"s1", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
  RowBox[{"s2", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nAgentsPerPopulation", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"?", "MeshPoints"}], "\[IndentingNewLine]", 
 RowBox[{"MeshPoints", "[", 
  RowBox[{"d", ",", "nAgentsPerPopulation"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.692975047215006*^9, {3.692975088797179*^9, 3.692975199305222*^9}, {
   3.69297523717423*^9, 3.692975289114956*^9}, {3.6929754762844887`*^9, 
   3.692975504408434*^9}, {3.6929756243359413`*^9, 3.6929756351010227`*^9}, {
   3.6929757358008127`*^9, 3.692975736441908*^9}, 3.692975830166924*^9, {
   3.69302977035063*^9, 3.693029797428689*^9}, 3.693030332585636*^9, 
   3.693030630971014*^9, {3.693030883874892*^9, 3.693030903112176*^9}, {
   3.6930315625703173`*^9, 3.693031606490834*^9}, {3.693032203298127*^9, 
   3.69303221396139*^9}, 3.693032246260235*^9, {3.693032535672368*^9, 
   3.693032574191389*^9}, {3.693032647260107*^9, 3.693032652017477*^9}, {
   3.693032754900141*^9, 3.693032755068519*^9}, {3.693032824933354*^9, 
   3.693032935610723*^9}, {3.693032996399757*^9, 3.6930330391584167`*^9}, {
   3.6930332802360573`*^9, 3.693033387415485*^9}, {3.693033434681181*^9, 
   3.693033435082036*^9}, 3.6930334687564573`*^9, {3.693033559374235*^9, 
   3.6930335625582933`*^9}, {3.693034187411571*^9, 3.693034208651308*^9}, {
   3.69303429221867*^9, 3.693034305235421*^9}, {3.693034386718275*^9, 
   3.693034390857499*^9}, {3.693034547331245*^9, 3.69303456135014*^9}, {
   3.693034599661539*^9, 3.693034606106017*^9}, {3.693034747914288*^9, 
   3.693034764282517*^9}, 3.693034992875801*^9, {3.693036119527012*^9, 
   3.693036136333589*^9}, {3.693036172705587*^9, 3.693036172873208*^9}, {
   3.693036204252293*^9, 3.69303622223368*^9}, {3.693036307045583*^9, 
   3.693036315693585*^9}, {3.6930364470834637`*^9, 3.693036453079843*^9}, {
   3.6930441336539183`*^9, 3.693044135497573*^9}, 3.6930441772602158`*^9, {
   3.6930442324292717`*^9, 3.693044233147605*^9}, {3.693044538701795*^9, 
   3.693044539510304*^9}, 3.693044705033379*^9, {3.6930447605076857`*^9, 
   3.693044760765966*^9}, {3.693044862694368*^9, 3.693044885800033*^9}, {
   3.69304873127813*^9, 3.693048750616518*^9}, {3.6930491212525387`*^9, 
   3.693049141242057*^9}, {3.693050786515298*^9, 3.693050796539874*^9}, 
   3.6930508412803707`*^9, {3.693071726590598*^9, 3.693071726661685*^9}, {
   3.693071761675542*^9, 3.693071762001514*^9}, {3.693071814182863*^9, 
   3.693071835280301*^9}, {3.6930731035514317`*^9, 3.693073103625293*^9}, 
   3.6930732347113*^9, {3.693076010647333*^9, 3.693076010952344*^9}, 
   3.6930761279439983`*^9, {3.69307677735706*^9, 3.693076777603094*^9}, {
   3.693076865490449*^9, 3.693076865584379*^9}, {3.693076924650875*^9, 
   3.693076928770864*^9}, {3.693076975299086*^9, 3.693077005957919*^9}, {
   3.693077058574998*^9, 3.693077058721066*^9}, {3.693077131936964*^9, 
   3.693077132049139*^9}, {3.693077220892823*^9, 3.693077221037602*^9}, {
   3.693078465043336*^9, 3.6930784717039127`*^9}, {3.693078624030554*^9, 
   3.693078634807837*^9}, {3.693078820815043*^9, 3.693078824225215*^9}, 
   3.693078875357153*^9, {3.693121197277875*^9, 3.6931212185960007`*^9}, 
   3.693121777302891*^9, {3.693121879632308*^9, 3.693121888777618*^9}, {
   3.6931219630400467`*^9, 3.693121965628675*^9}, {3.693122189641588*^9, 
   3.6931221897755957`*^9}, {3.693122257185749*^9, 3.69312225726436*^9}, {
   3.693122347368815*^9, 3.6931223697998257`*^9}, {3.693122522342895*^9, 
   3.693122547034219*^9}, {3.6931238798823147`*^9, 3.69312389216055*^9}, 
   3.693124356891985*^9, {3.6931248598015013`*^9, 3.6931248946204147`*^9}, {
   3.6931249348274*^9, 3.693124934860643*^9}, {3.69313117423842*^9, 
   3.693131177397451*^9}, {3.693131816422531*^9, 3.693131816858635*^9}, 
   3.693132733096978*^9, 3.6931330459620867`*^9, {3.693133195622369*^9, 
   3.69313319636368*^9}, {3.693133250094447*^9, 3.693133250319254*^9}, {
   3.693133357702457*^9, 3.693133466287448*^9}, {3.693133516823515*^9, 
   3.693133530401572*^9}, {3.6931335677082043`*^9, 3.693133568617996*^9}, {
   3.693136379090764*^9, 3.693136381588275*^9}, {3.6931365489681396`*^9, 
   3.69313654970795*^9}, {3.6931365810743103`*^9, 3.69313658114939*^9}, {
   3.693137855780232*^9, 3.6931378641138783`*^9}, {3.6931381091077127`*^9, 
   3.693138113089807*^9}, {3.693139015425804*^9, 3.693139017957947*^9}, {
   3.693139138335556*^9, 3.693139138457718*^9}, 3.693207049623445*^9, {
   3.693207085493697*^9, 3.6932070855755043`*^9}, {3.693208365599497*^9, 
   3.693208365688053*^9}, {3.693209542562077*^9, 3.693209554641917*^9}, {
   3.693211685172374*^9, 3.693211687959984*^9}, {3.693211744447153*^9, 
   3.693211744557971*^9}, {3.693211780760618*^9, 3.693211780973938*^9}, {
   3.6932121473037577`*^9, 3.693212147438225*^9}, {3.6932126235347023`*^9, 
   3.693212623802395*^9}, {3.693215003290609*^9, 3.6932150363418016`*^9}, {
   3.693215178214817*^9, 3.693215178427559*^9}, {3.693215218116794*^9, 
   3.6932152182065477`*^9}, {3.693215435149598*^9, 3.6932154352383623`*^9}, {
   3.693215545163601*^9, 3.693215585277892*^9}, {3.693215632351159*^9, 
   3.693215632662388*^9}, {3.693216060606152*^9, 3.6932160686374083`*^9}, 
   3.693216186671022*^9, {3.693216661708159*^9, 3.69321666231351*^9}, 
   3.693216694737233*^9, {3.6932167935666513`*^9, 3.693216793723413*^9}, {
   3.6932172808104*^9, 3.6932172813151903`*^9}, {3.6932174011716413`*^9, 
   3.6932174019583883`*^9}, {3.693267775062633*^9, 3.693267785360216*^9}, {
   3.693268002736112*^9, 3.6932680043770943`*^9}, {3.693268075704467*^9, 
   3.6932680758829203`*^9}, {3.693268214361187*^9, 3.693268214472484*^9}, {
   3.693268255514256*^9, 3.693268255940497*^9}, 3.6933882995897703`*^9, {
   3.693389938122312*^9, 3.69338995857436*^9}, {3.6933903901778584`*^9, 
   3.693390390591707*^9}, 3.6935478523827457`*^9, 3.693547886346887*^9, {
   3.693549102349327*^9, 3.6935491024149323`*^9}, {3.693549137506915*^9, 
   3.693549155662177*^9}, {3.6935491946686077`*^9, 3.693549194778867*^9}, {
   3.69354931824924*^9, 3.693549318642499*^9}, {3.6935493853563843`*^9, 
   3.6935493862446527`*^9}, {3.6935495889389677`*^9, 
   3.6935496133960867`*^9}, {3.693551497151532*^9, 3.6935515695669947`*^9}, {
   3.693552097254628*^9, 3.693552098153618*^9}, {3.69355219726823*^9, 
   3.693552202723551*^9}, {3.693552240975149*^9, 3.693552265094672*^9}, {
   3.693552296505499*^9, 3.693552335395646*^9}, {3.693552641433353*^9, 
   3.6935526623583193`*^9}, 3.69355281572097*^9, {3.69355291580228*^9, 
   3.693552923169395*^9}, {3.693552960640161*^9, 3.6935529883114758`*^9}, {
   3.6935531255947943`*^9, 3.693553149836988*^9}, {3.693556709160446*^9, 
   3.6935567130848627`*^9}, 3.693556808859192*^9, {3.693568781788939*^9, 
   3.693568781878915*^9}, {3.693934010142221*^9, 3.693934011220396*^9}, 
   3.693934064118815*^9, {3.693934871528583*^9, 3.693934893813085*^9}, {
   3.6939352419742603`*^9, 3.693935270638769*^9}, {3.693935301903678*^9, 
   3.693935302207018*^9}, {3.693936006806075*^9, 3.693936040587558*^9}, {
   3.69402190027365*^9, 3.694021903434705*^9}, 3.6940219653105803`*^9, {
   3.694022019763103*^9, 3.694022096913772*^9}, 3.6940833708237886`*^9, {
   3.6940838938469143`*^9, 3.694083897645529*^9}, {3.694084071196023*^9, 
   3.6940840714396563`*^9}, {3.694084107278338*^9, 3.694084107818202*^9}, {
   3.694084439473892*^9, 3.69408443962158*^9}, {3.694084970860441*^9, 
   3.69408497103475*^9}, {3.694085554071391*^9, 3.6940855544044647`*^9}, {
   3.694085629816943*^9, 3.694085629910694*^9}, {3.6940856800970907`*^9, 
   3.694085689023015*^9}, {3.69408571930655*^9, 3.694085719414953*^9}, {
   3.694085769623125*^9, 3.6940857697098846`*^9}, 3.6967577630996323`*^9, 
   3.6967584710256643`*^9, {3.6967585165106373`*^9, 3.6967585532711782`*^9}, 
   3.6967587495717173`*^9, {3.696763401412712*^9, 3.6967634049628763`*^9}, {
   3.6967635757310247`*^9, 3.696763579641227*^9}, 3.696763659044979*^9, 
   3.696764045651988*^9, 3.6967641196535387`*^9, {3.696764401473859*^9, 
   3.696764402934815*^9}, {3.696764478306901*^9, 3.696764483343824*^9}, {
   3.696767750851919*^9, 3.696767776065978*^9}, {3.696767808122141*^9, 
   3.6967678129820642`*^9}, {3.696767874773571*^9, 3.696767885100268*^9}, {
   3.696767929510459*^9, 3.69676793033704*^9}, {3.696768033863799*^9, 
   3.696768034413004*^9}, {3.696775827305807*^9, 3.6967758350680428`*^9}, {
   3.6967758746826878`*^9, 3.696775883137228*^9}}],

Cell[BoxData[
 RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "d", ",", 
   RowBox[{"MeshPoints", "[", 
    RowBox[{"d", ",", "nAgentsPerPopulation"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.696767934583943*^9, 3.696767937654827*^9}, {
  3.696768023014482*^9, 3.696768030934937*^9}}],

Cell[BoxData[
 RowBox[{"?", "RandomPoints"}]], "Input",
 CellChangeTimes->{{3.696767985649269*^9, 3.696768006353484*^9}, {
  3.696775292378255*^9, 3.696775293538913*^9}}],

Cell[BoxData[
 RowBox[{"NumericalGlobalStabilityOfInteriorRestPointLyapunov", "[", 
  RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "d", ",", 
   RowBox[{"RandomPoints", "[", 
    RowBox[{"d", ",", 
     RowBox[{"10", "^", "6"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NDSolveMeanDynamics", "[", 
   RowBox[{"testSetRule", ",", "tieBreakingRule", " ", ",", "d"}], "]"}], ";",
   " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"by", " ", "default"}], ",", " ", 
    RowBox[{"the", " ", "initial", " ", "point", " ", "is", " ", "random"}]}],
    "*)"}]}]], "Input",
 CellChangeTimes->{
  3.692975047215006*^9, {3.692975088797179*^9, 3.692975199305222*^9}, {
   3.69297523717423*^9, 3.692975289114956*^9}, {3.6929754762844887`*^9, 
   3.692975504408434*^9}, {3.6929756243359413`*^9, 3.6929756351010227`*^9}, {
   3.6929757358008127`*^9, 3.692975736441908*^9}, 3.692975830166924*^9, {
   3.69302977035063*^9, 3.693029797428689*^9}, 3.693030332585636*^9, 
   3.693030630971014*^9, {3.693030883874892*^9, 3.693030903112176*^9}, {
   3.6930315625703173`*^9, 3.693031606490834*^9}, {3.693032203298127*^9, 
   3.69303221396139*^9}, 3.693032246260235*^9, {3.693032535672368*^9, 
   3.693032574191389*^9}, {3.693032647260107*^9, 3.693032652017477*^9}, {
   3.693032754900141*^9, 3.693032755068519*^9}, {3.693032824933354*^9, 
   3.693032935610723*^9}, {3.693032996399757*^9, 3.6930330391584167`*^9}, {
   3.6930332802360573`*^9, 3.693033387415485*^9}, {3.693033434681181*^9, 
   3.693033435082036*^9}, 3.6930334687564573`*^9, {3.693033559374235*^9, 
   3.6930335625582933`*^9}, {3.693034187411571*^9, 3.693034208651308*^9}, {
   3.69303429221867*^9, 3.693034305235421*^9}, {3.693034386718275*^9, 
   3.693034390857499*^9}, {3.693034547331245*^9, 3.69303456135014*^9}, {
   3.693034599661539*^9, 3.693034606106017*^9}, {3.693034747914288*^9, 
   3.693034764282517*^9}, 3.693034992875801*^9, {3.693036119527012*^9, 
   3.693036136333589*^9}, {3.693036172705587*^9, 3.693036172873208*^9}, {
   3.693036204252293*^9, 3.69303622223368*^9}, {3.693036307045583*^9, 
   3.693036315693585*^9}, {3.6930364470834637`*^9, 3.693036453079843*^9}, {
   3.6930441336539183`*^9, 3.693044135497573*^9}, 3.6930441772602158`*^9, {
   3.6930442324292717`*^9, 3.693044233147605*^9}, {3.693044538701795*^9, 
   3.693044539510304*^9}, 3.693044705033379*^9, {3.6930447605076857`*^9, 
   3.693044760765966*^9}, {3.693044862694368*^9, 3.693044885800033*^9}, {
   3.69304873127813*^9, 3.693048750616518*^9}, {3.6930491212525387`*^9, 
   3.693049141242057*^9}, {3.693050786515298*^9, 3.693050796539874*^9}, 
   3.6930508412803707`*^9, {3.693071726590598*^9, 3.693071726661685*^9}, {
   3.693071761675542*^9, 3.693071762001514*^9}, {3.693071814182863*^9, 
   3.693071835280301*^9}, {3.6930731035514317`*^9, 3.693073103625293*^9}, 
   3.6930732347113*^9, {3.693076010647333*^9, 3.693076010952344*^9}, 
   3.6930761279439983`*^9, {3.69307677735706*^9, 3.693076777603094*^9}, {
   3.693076865490449*^9, 3.693076865584379*^9}, {3.693076924650875*^9, 
   3.693076928770864*^9}, {3.693076975299086*^9, 3.693077005957919*^9}, {
   3.693077058574998*^9, 3.693077058721066*^9}, {3.693077131936964*^9, 
   3.693077132049139*^9}, {3.693077220892823*^9, 3.693077221037602*^9}, {
   3.693078465043336*^9, 3.6930784717039127`*^9}, {3.693078624030554*^9, 
   3.693078634807837*^9}, {3.693078820815043*^9, 3.693078824225215*^9}, 
   3.693078875357153*^9, {3.693121197277875*^9, 3.6931212185960007`*^9}, 
   3.693121777302891*^9, {3.693121879632308*^9, 3.693121888777618*^9}, {
   3.6931219630400467`*^9, 3.693121965628675*^9}, {3.693122189641588*^9, 
   3.6931221897755957`*^9}, {3.693122257185749*^9, 3.69312225726436*^9}, {
   3.693122347368815*^9, 3.6931223697998257`*^9}, {3.693122522342895*^9, 
   3.693122547034219*^9}, {3.6931238798823147`*^9, 3.69312389216055*^9}, 
   3.693124356891985*^9, {3.6931248598015013`*^9, 3.6931248946204147`*^9}, {
   3.6931249348274*^9, 3.693124934860643*^9}, {3.69313117423842*^9, 
   3.693131177397451*^9}, {3.693131816422531*^9, 3.693131816858635*^9}, 
   3.693132733096978*^9, 3.6931330459620867`*^9, {3.693133195622369*^9, 
   3.69313319636368*^9}, {3.693133250094447*^9, 3.693133250319254*^9}, {
   3.693133357702457*^9, 3.693133466287448*^9}, {3.693133516823515*^9, 
   3.693133530401572*^9}, {3.6931335677082043`*^9, 3.693133568617996*^9}, {
   3.693136379090764*^9, 3.693136381588275*^9}, {3.6931365489681396`*^9, 
   3.69313654970795*^9}, {3.6931365810743103`*^9, 3.69313658114939*^9}, {
   3.693137855780232*^9, 3.6931378641138783`*^9}, {3.6931381091077127`*^9, 
   3.693138113089807*^9}, {3.693139015425804*^9, 3.693139017957947*^9}, {
   3.693139138335556*^9, 3.693139138457718*^9}, 3.693207049623445*^9, {
   3.693207085493697*^9, 3.6932070855755043`*^9}, {3.693208365599497*^9, 
   3.693208365688053*^9}, {3.693209542562077*^9, 3.693209554641917*^9}, {
   3.693211685172374*^9, 3.693211687959984*^9}, {3.693211744447153*^9, 
   3.693211744557971*^9}, {3.693211780760618*^9, 3.693211780973938*^9}, {
   3.6932121473037577`*^9, 3.693212147438225*^9}, {3.6932126235347023`*^9, 
   3.693212623802395*^9}, {3.693215003290609*^9, 3.6932150363418016`*^9}, {
   3.693215178214817*^9, 3.693215178427559*^9}, {3.693215218116794*^9, 
   3.6932152182065477`*^9}, {3.693215435149598*^9, 3.6932154352383623`*^9}, {
   3.693215545163601*^9, 3.693215585277892*^9}, {3.693215632351159*^9, 
   3.693215632662388*^9}, {3.693216060606152*^9, 3.6932160686374083`*^9}, 
   3.693216186671022*^9, {3.693216661708159*^9, 3.69321666231351*^9}, 
   3.693216694737233*^9, {3.6932167935666513`*^9, 3.693216793723413*^9}, {
   3.6932172808104*^9, 3.6932172813151903`*^9}, {3.6932174011716413`*^9, 
   3.6932174019583883`*^9}, {3.693267775062633*^9, 3.693267785360216*^9}, {
   3.693268002736112*^9, 3.6932680043770943`*^9}, {3.693268075704467*^9, 
   3.6932680758829203`*^9}, {3.693268214361187*^9, 3.693268214472484*^9}, {
   3.693268255514256*^9, 3.693268255940497*^9}, 3.6933882995897703`*^9, {
   3.693389938122312*^9, 3.69338995857436*^9}, {3.6933903901778584`*^9, 
   3.693390390591707*^9}, 3.6935478523827457`*^9, 3.693547886346887*^9, {
   3.693549102349327*^9, 3.6935491024149323`*^9}, {3.693549137506915*^9, 
   3.693549155662177*^9}, {3.6935491946686077`*^9, 3.693549194778867*^9}, {
   3.69354931824924*^9, 3.693549318642499*^9}, {3.6935493853563843`*^9, 
   3.6935493862446527`*^9}, {3.6935495889389677`*^9, 
   3.6935496133960867`*^9}, {3.693551497151532*^9, 3.6935515695669947`*^9}, {
   3.693552097254628*^9, 3.693552098153618*^9}, {3.69355219726823*^9, 
   3.693552202723551*^9}, {3.693552240975149*^9, 3.693552265094672*^9}, {
   3.693552296505499*^9, 3.693552335395646*^9}, {3.693552641433353*^9, 
   3.6935526623583193`*^9}, 3.69355281572097*^9, {3.69355291580228*^9, 
   3.693552923169395*^9}, {3.693552960640161*^9, 3.6935529883114758`*^9}, {
   3.6935531255947943`*^9, 3.693553149836988*^9}, {3.693556709160446*^9, 
   3.6935567130848627`*^9}, 3.693556808859192*^9, {3.693568781788939*^9, 
   3.693568781878915*^9}, {3.693934010142221*^9, 3.693934011220396*^9}, 
   3.693934064118815*^9, {3.693934871528583*^9, 3.693934893813085*^9}, {
   3.6939352419742603`*^9, 3.693935270638769*^9}, {3.693935301903678*^9, 
   3.693935302207018*^9}, {3.693936006806075*^9, 3.693936040587558*^9}, {
   3.69402190027365*^9, 3.694021903434705*^9}, 3.6940219653105803`*^9, {
   3.694022019763103*^9, 3.694022096913772*^9}, 3.6940833708237886`*^9, {
   3.6940838938469143`*^9, 3.694083897645529*^9}, {3.694084071196023*^9, 
   3.6940840714396563`*^9}, {3.694084107278338*^9, 3.694084107818202*^9}, {
   3.694084439473892*^9, 3.69408443962158*^9}, {3.694084970860441*^9, 
   3.69408497103475*^9}, {3.694085554071391*^9, 3.6940855544044647`*^9}, {
   3.694085629816943*^9, 3.694085629910694*^9}, {3.6940856800970907`*^9, 
   3.694085689023015*^9}, {3.69408571930655*^9, 3.694085719414953*^9}, {
   3.694085769623125*^9, 3.6940857697098846`*^9}, 3.6967577630996323`*^9, 
   3.6967584710256643`*^9, {3.6967585165106373`*^9, 3.6967585532711782`*^9}, 
   3.6967587495717173`*^9, {3.696763401412712*^9, 3.6967634049628763`*^9}, {
   3.6967635757310247`*^9, 3.696763579641227*^9}, 3.696763659044979*^9, 
   3.696764045651988*^9, 3.6967641196535387`*^9, {3.696764401473859*^9, 
   3.696764402934815*^9}, {3.696764478306901*^9, 3.696764483343824*^9}, {
   3.696767750851919*^9, 3.696767776065978*^9}, {3.696767808122141*^9, 
   3.6967678129820642`*^9}, {3.696767874773571*^9, 3.696767885100268*^9}, {
   3.696775323894393*^9, 3.69677533013717*^9}, {3.696775549524192*^9, 
   3.696775563327709*^9}, {3.69677611690838*^9, 3.696776133474834*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testSetRule", "=", "\"\<adj\>\""}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Possible", " ", "values", " ", "are", " ", "\"\<all\>\""}], ",", 
    " ", 
    RowBox[{"\"\<two\>\"", " ", "or", " ", "\"\<adj\>\""}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tieBreakingRule", "=", "\"\<min\>\""}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Possible", " ", "values", " ", "are", " ", "\"\<min\>\""}], ",", 
    " ", 
    RowBox[{"\"\<stick\>\"", " ", "or", " ", "\"\<unif\>\""}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"d", "=", "20"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "d", " ", "is", " ", "the", " ", "number", " ", "of", " ", "nodes", " ", 
    "in", " ", "the", " ", "Centipede", " ", "game"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"s1", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "3"}], ")"}], "/", "2"}], "]"}]}], ";", 
  RowBox[{"s2", "=", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"d", "+", "2"}], ")"}], "/", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"initialPoint", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.99", ",", "0.01"}], "}"}], ",", "s1"}], "]"}], ",", 
    RowBox[{"PadRight", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.99", ",", "0.01"}], "}"}], ",", "s2"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.696775583601162*^9, 3.696775596127571*^9}, {
  3.696775927458178*^9, 3.696775936564303*^9}, {3.696775982368775*^9, 
  3.6967759872544603`*^9}, {3.696776082110052*^9, 3.696776085115898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NDSolveMeanDynamics", "[", 
   RowBox[{
   "testSetRule", ",", "tieBreakingRule", " ", ",", "d", ",", 
    "initialPoint"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.696775583601162*^9, 3.696775596127571*^9}, {
   3.696775927458178*^9, 3.696775936564303*^9}, 3.696776100011627*^9}]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1280, 703},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 166, 2, 92, "Title"],
Cell[CellGroupData[{
Cell[771, 28, 307, 6, 64, "Section",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[1103, 38, 160, 3, 44, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[1266, 43, 2903, 63, 343, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[4206, 111, 283, 5, 36, "Subsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[4514, 120, 184, 2, 35, "Subsubsection"],
Cell[4701, 124, 11452, 253, 994, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[16190, 382, 309, 6, 29, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[16524, 392, 219, 4, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[16746, 398, 7486, 200, 484, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[24269, 603, 271, 5, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[24543, 610, 12774, 329, 598, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[37354, 944, 223, 4, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[37580, 950, 8256, 223, 551, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45885, 1179, 357, 6, 35, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[46267, 1189, 219, 4, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[46489, 1195, 7981, 199, 303, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[54507, 1399, 221, 4, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[54731, 1405, 8631, 216, 355, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63399, 1626, 223, 4, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[63625, 1632, 8523, 217, 355, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72197, 1855, 359, 6, 35, "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[72581, 1865, 221, 4, 30, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[72805, 1871, 10768, 265, 411, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[83610, 2141, 273, 5, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[83886, 2148, 13400, 321, 575, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[97323, 2474, 223, 4, 27, "Text",
 InitializationCell->True,
 InitializationGroup->True],
Cell[97549, 2480, 11440, 286, 411, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109050, 2773, 251, 5, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[109304, 2780, 4170, 113, 332, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[113511, 2898, 337, 6, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[113851, 2906, 14918, 348, 1204, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[128806, 3259, 464, 9, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[129273, 3270, 26476, 555, 1655, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[155786, 3830, 480, 8, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[156269, 3840, 9547, 169, 374, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[165853, 4014, 663, 12, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[166519, 4028, 22355, 457, 1666, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[188911, 4490, 693, 12, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[189607, 4504, 25349, 497, 1624, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[214993, 5006, 796, 12, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[215792, 5020, 14161, 287, 406, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[229990, 5312, 840, 15, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[230833, 5329, 23648, 436, 1703, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[254518, 5770, 829, 13, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[255350, 5785, 26496, 508, 1824, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]],
Cell[CellGroupData[{
Cell[281883, 6298, 889, 14, 36, "Subsection",
 InitializationCell->True,
 InitializationGroup->True],
Cell[282775, 6314, 24604, 469, 1131, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 InitializationGroup->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[307440, 6790, 275, 4, 64, "Section",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[307740, 6798, 2357, 59, 114, "Input"],
Cell[310100, 6859, 229, 5, 28, "Input"]
}, Open  ]],
Cell[310344, 6867, 801, 23, 32, "Input"],
Cell[311148, 6892, 813, 22, 54, "Input"],
Cell[311964, 6916, 814, 22, 54, "Input"],
Cell[312781, 6940, 251, 6, 32, "Input"],
Cell[313035, 6948, 246, 6, 32, "Input"],
Cell[313284, 6956, 193, 3, 32, "Input"],
Cell[313480, 6961, 425, 11, 32, "Input"],
Cell[313908, 6974, 354, 5, 32, "Input"],
Cell[314265, 6981, 208, 3, 32, "Input"],
Cell[314476, 6986, 427, 10, 32, "Input"],
Cell[314906, 6998, 193, 3, 32, "Input"],
Cell[315102, 7003, 467, 11, 32, "Input"],
Cell[315572, 7016, 209, 3, 32, "Input"],
Cell[315784, 7021, 463, 11, 32, "Input"],
Cell[316250, 7034, 212, 3, 32, "Input"],
Cell[316465, 7039, 410, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[316900, 7053, 8926, 134, 117, "Input"],
Cell[325829, 7189, 373, 6, 32, "Input"],
Cell[326205, 7197, 170, 3, 32, "Input"],
Cell[326378, 7202, 268, 5, 32, "Input"],
Cell[326649, 7209, 8368, 119, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[335066, 7334, 1768, 49, 117, "Input"],
Cell[336837, 7385, 321, 7, 32, "Input"]
}, Open  ]]
}
]
*)

